<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>[Sharing] HITCON Education Defense 2021 - Cyris | Limit Break</title><meta name=Description content="HITCON 2021 Education Defense participation and blue team experience"><meta property="og:url" content="https://blog.cyris.tw/en/posts/2021/hitcon-education-defense-2021/"><meta property="og:site_name" content="Cyris | Limit Break"><meta property="og:title" content="[Sharing] HITCON Education Defense 2021"><meta property="og:description" content="HITCON 2021 Education Defense participation and blue team experience"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-01T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-01T00:00:00+00:00"><meta property="article:tag" content="HITCON Defense"><meta property="article:tag" content="AIS3"><meta property="og:image" content="https://blog.cyris.tw/img/cyris.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.cyris.tw/img/cyris.png"><meta name=twitter:title content="[Sharing] HITCON Education Defense 2021"><meta name=twitter:description content="HITCON 2021 Education Defense participation and blue team experience"><meta name=application-name content="Cyris | Limit Break"><meta name=apple-mobile-web-app-title content="Cyris | Limit Break"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/img/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://blog.cyris.tw/en/posts/2021/hitcon-education-defense-2021/><link rel=prev href=https://blog.cyris.tw/en/posts/2021/my-first-malware-study/><link rel=next href=https://blog.cyris.tw/en/posts/2021/hitcon2021-devcore-web-challenge/><link rel=stylesheet href=/css/main.min.css><link rel=stylesheet href=/css/style.min.css><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[Sharing] HITCON Education Defense 2021","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.cyris.tw/en/posts/2021/hitcon-education-defense-2021/"},"image":["https://blog.cyris.tw/img/cyris.png"],"genre":"posts","keywords":["HITCON Defense","AIS3"],"wordcount":2306,"url":"https://blog.cyris.tw/en/posts/2021/hitcon-education-defense-2021/","datePublished":"2021-11-01T00:00:00+00:00","dateModified":"2021-11-01T00:00:00+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Cyris","logo":"https://blog.cyris.tw/img/cyris.png"},"author":{"@type":"Person","name":"Cyris","url":"https://blog.cyris.tw"},"description":"HITCON 2021 Education Defense participation and blue team experience"}</script></head><body data-instant-intensity=viewport class="tw-flex tw-min-h-screen tw-flex-col"><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.className=e,document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),e==="light"?document.documentElement.classList.remove("tw-dark"):document.documentElement.classList.add("tw-dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#161b22"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><header class="desktop print:!tw-hidden" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/en/ title="Cyris | Limit Break"><img class="tw-inline tw-align-text-bottom tw-mr-1" src=/img/favicon.ico alt="Cyris | Limit Break" height=32 width=32>Cyris | Limit Break</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/en/posts/>Posts </a><a class=menu-item href=/en/tags/>Tags </a><a class=menu-item href=/en/categories/>Categories </a><a class=menu-item href=/en/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item language-switcher" title="Select Language"><a href=/en/posts/2021/hitcon-education-defense-2021/ class="lang-option active">EN</a><a href=/posts/2021/hitcon-education-defense-2021/ class=lang-option>ä¸­æ–‡</a></span><button class="menu-item theme-switch" aria-label="Switch Theme">
<svg class="icon" viewBox="0 0 512 512"><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705.0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg></button></div></div></div></header><header class="mobile print:!tw-hidden" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/en/ title="Cyris | Limit Break"><img class="tw-inline tw-align-text-bottom tw-mr-1" src=/img/favicon.ico alt="Cyris | Limit Break" height=32 width=32>Cyris | Limit Break</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/en/posts/ title>Posts</a><a class=menu-item href=/en/tags/ title>Tags</a><a class=menu-item href=/en/categories/ title>Categories</a><a class=menu-item href=/en/about/ title>About</a><button class="menu-item theme-switch tw-w-full" aria-label="Switch Theme">
<svg class="icon" viewBox="0 0 512 512"><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705.0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg></button><div class="menu-item language-switcher-mobile tw-w-full"><a href=/en/posts/2021/hitcon-education-defense-2021/ class="lang-option active">EN</a><a href=/posts/2021/hitcon-education-defense-2021/ class=lang-option>ä¸­æ–‡</a></div></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class="tw-mx-4 tw-flex-1"><div class="toc print:!tw-hidden" id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#training-workshop>Training Workshop</a></li><li><a href=#night-before-competition>Night Before Competition</a></li><li><a href=#competition-day>Competition Day</a><ul><li><ul><li><a href=#1-equipment-inventory>1. Equipment Inventory</a></li><li><a href=#2-basic-checksvulnerability-detectionscanning>2. Basic Checks/Vulnerability Detection/Scanning</a></li><li><a href=#3-backup-before-updates>3. Backup Before Updates</a></li><li><a href=#4-account-management>4. Account Management</a></li><li><a href=#5-windows-ad>5. Windows AD</a></li><li><a href=#6-proper-tool-usage>6. Proper Tool Usage</a></li><li><a href=#7-proper-log-usage>7. Proper Log Usage</a></li></ul></li></ul></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></div><dialog id=toc-dialog class="tw-max-w-full tw-w-full tw-max-h-full tw-h-full tw-ml-16"><div class="toc tw-mx-4 tw-max-w-full"><h2 class="tw-mx-0 tw-my-6 tw-uppercase tw-text-2xl">Contents</h2><div class=toc-content><nav id=TableOfContents><ul><li><a href=#training-workshop>Training Workshop</a></li><li><a href=#night-before-competition>Night Before Competition</a></li><li><a href=#competition-day>Competition Day</a><ul><li><ul><li><a href=#1-equipment-inventory>1. Equipment Inventory</a></li><li><a href=#2-basic-checksvulnerability-detectionscanning>2. Basic Checks/Vulnerability Detection/Scanning</a></li><li><a href=#3-backup-before-updates>3. Backup Before Updates</a></li><li><a href=#4-account-management>4. Account Management</a></li><li><a href=#5-windows-ad>5. Windows AD</a></li><li><a href=#6-proper-tool-usage>6. Proper Tool Usage</a></li><li><a href=#7-proper-log-usage>7. Proper Log Usage</a></li></ul></li></ul></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></div></dialog><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single print:!tw-w-full print:!tw-max-w-none print:!tw-m-0 print:!tw-p-0"><h1 class=single-title data-pagefind-meta=date:2021-11-01 data-pagefind-body>[Sharing] HITCON Education Defense 2021</h1><div class=post-meta><div class=post-meta-line><span class=post-author><svg class="icon" viewBox="0 0 496 512"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6.0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7.0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4.0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9s28-2.7 40.9-6.9c2.3-.7 4.7-1.1 7.1-1.1 42.9.0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><a href=https://blog.cyris.tw title=Author target=_blank rel="noopener noreferrer author" class=author>Cyris</a>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>included in <a href=/en/categories/cyber-security/><svg class="icon" viewBox="0 0 512 512"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>Cyber Security</a></span></div><div class=post-meta-line><svg class="icon" viewBox="0 0 448 512"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;<time datetime=2021-11-01>2021-11-01</time>&nbsp;<svg class="icon" viewBox="0 0 576 512"><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1.0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7.0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174 402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7-43.2-43.2c-4.1-4.1-10.8-4.1-14.8.0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg>&nbsp;<time datetime=2021-11-01>2021-11-01</time>&nbsp;<svg class="icon" viewBox="0 0 512 512"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;2306 words&nbsp;
<svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;11 minutes&nbsp;</div></div><div class=post-disclaimer><strong>Note:</strong> This article was translated from Chinese by AI. The original content may have nuances that differ from the translation.</div><div class="details toc print:!tw-block" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#training-workshop>Training Workshop</a></li><li><a href=#night-before-competition>Night Before Competition</a></li><li><a href=#competition-day>Competition Day</a><ul><li><ul><li><a href=#1-equipment-inventory>1. Equipment Inventory</a></li><li><a href=#2-basic-checksvulnerability-detectionscanning>2. Basic Checks/Vulnerability Detection/Scanning</a></li><li><a href=#3-backup-before-updates>3. Backup Before Updates</a></li><li><a href=#4-account-management>4. Account Management</a></li><li><a href=#5-windows-ad>5. Windows AD</a></li><li><a href=#6-proper-tool-usage>6. Proper Tool Usage</a></li><li><a href=#7-proper-log-usage>7. Proper Log Usage</a></li></ul></li></ul></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></div><div class=content id=content data-pagefind-body><p>Stop!
Please stop shutting down our machines LAAAAAAAAAAAAAAAA</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831862/blog-posts/2021-11/01-cover.webp alt=" "></p><br><div class="details admonition info open"><div class="details-summary admonition-title"><span class=icon><svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196.0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627.0 12 5.373 12 12v1e2h12c6.627.0 12 5.373 12 12v24z"/></svg></span>TL;DR<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class=details-content><div class=admonition-content>This post exists partly because we got beaten badly and needed a review, and also because there was almost no information available before the competition, so I thought I&rsquo;d write some notes.
If you&rsquo;re hoping to learn our blue team strategy from this post, sorry, there isn&rsquo;t one : (</div></div></div><p>The overall event schedule was quite tight - from receiving event news on 10/01, it was over in less than a month.
HITCON Defense is now in its third year, but this was the first Education (student) track. I&rsquo;m grateful to have participated during my remaining student years. I usually only do CTF practice and rarely get the chance to play the blue team role, so I had essentially zero defense experience - all my defense knowledge came from textbooks or lectures without practical application.</p><h2 id=training-workshop class=headerLink><a href=#training-workshop class=header-mark></a>Training Workshop</h2><p>The organizers held a pre-competition training workshop. Looking at the agenda felt like a series of product promotions, and indeed it was about learning to use security products. There weren&rsquo;t many students attending - mostly financial industry security personnel and corporate executives. Seeing all those job titles during registration was intimidating (scared.jpg). Before registering, I naively thought defense only required writing some iptable rules.</p><p>DAY 1 mainly covered <code>Palo Alto Network</code> 3220 firewall (abbreviated as PA) and Cortex XDR products. Honestly, I hadn&rsquo;t heard of them before - only learned post-competition that they&rsquo;re common in the industry, or in Taiwan maybe&mldr; ZYXEL? The whole day was lab-based. While I could follow the guide, mastering it quickly was truly difficult. Being used to CLI tools and suddenly having to use feature-packed products left me somewhat overwhelmed XDDD</p><p>DAY 2 afternoon covered <code>Citrix</code> WAF. Originally seeing OWASP on the agenda, I thought it would be the usual stuff, but the course was surprisingly solid. The instructor started from red team attack perspectives, shared interesting industry anecdotes, and even asked us (students) to look at the blue team victims from other companies and think carefully about whether to enter the security industry. The instructor also mentioned that previous years&rsquo; blue teams were devastated, eventually competing on &ldquo;who was less devastated.&rdquo; Though back then teams could exchange intelligence and help each other - this year, due to COVID, each team had to stay in small rooms without interaction, possibly making it worse QQ</p><p>What surprised me was that this training, despite the HITCON branding, had no familiar faces. Unsurprisingly, on competition day, all the experts were on the opposing red team / Infra. Also, the Education track didn&rsquo;t have a &ldquo;procurement department&rdquo; for buying additional security products with points, so of the three products introduced in training, only PA was available. But with less than three hours of hands-on time, I couldn&rsquo;t even find the option to save traffic as PCAP files XDDDD</p><h2 id=night-before-competition class=headerLink><a href=#night-before-competition class=header-mark></a>Night Before Competition</h2><div class="details admonition quote open"><div class="details-summary admonition-title"><span class=icon><svg class="icon" viewBox="0 0 512 512"><path d="M464 32H336c-26.5.0-48 21.5-48 48v128c0 26.5 21.5 48 48 48h80v64c0 35.3-28.7 64-64 64h-8c-13.3.0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h8c88.4.0 160-71.6 160-160V80c0-26.5-21.5-48-48-48zm-288 0H48C21.5 32 0 53.5.0 80v128c0 26.5 21.5 48 48 48h80v64c0 35.3-28.7 64-64 64h-8c-13.3.0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h8c88.4.0 160-71.6 160-160V80c0-26.5-21.5-48-48-48z"/></svg></span>Cyris - Some clueless blue team victim from the south<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class=details-content><div class=admonition-content>We blue team members don&rsquo;t even understand the services we&rsquo;re supposed to protect - asking the neighboring red team might be more informative (/ =Ï‰=)/
<del>Conclusion: Rather than cramming overnight, better to just sleep early</del></div></div></div><br><p>Thinking about it, blue team competition really is a <strong>&ldquo;team game&rdquo;</strong> - unlike regular CTF where everyone works independently on different challenges. With no information beforehand, we decided to hold a meeting to discuss tactics.</p><p>We created a shared doc listing system information to collect early, plus basics like changing passwords, checking external ports, scheduled tasks, and updating services. With web servers, we needed to consider defenses against IDOR, XSS, and worried about recent Apache CVEs. AD was an expected focus, so we discussed checking DC settings, how to use GPO, whether to disable SMB&mldr; yes, there was a service checker, so we couldn&rsquo;t just shut down services at will. We discussed possible check methods - like if we banned red team IPs, all services might fail checks, which would be troublesome XD</p><p>Looking back, our thinking was actually on the right track, but we couldn&rsquo;t find things / didn&rsquo;t know how to use tools / couldn&rsquo;t interpret results / made wrong judgments. In the chaos on-site, we couldn&rsquo;t get into the groove, which was a shame.</p><h2 id=competition-day class=headerLink><a href=#competition-day class=header-mark></a>Competition Day</h2><p>The event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks:</p><ul><li>[30 pts] WordPress</li><li>[25 pts] DNS</li><li>[15 pts] VPN Server (OpenVPN)</li><li>[15 pts] BugNet (IIS) (via VPN)</li><li>[10 pts] Nagios (Dashboard)</li><li>[05 pts] Windows 10 VDI (accessed via VPN)</li></ul><p>Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww
<img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831490/blog-posts/2021-11/01-story.webp alt=" "></p><br><p>Below shows each team&rsquo;s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2&rsquo;s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: <strong>we didn&rsquo;t know how to turn machines on</strong> (more on this later).</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831491/blog-posts/2021-11/01-service-board-all.webp alt=" "></p><p>Additionally, the organizers provided CTFd with Q&amp;A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference:</p><ul><li>[0] What&rsquo;s the public network segment? <code>AC</code></li><li>[0] Equipment inventory</li><li>[0] List open ports <code>AC</code></li><li>[60] WordPress user inventory <code>WA</code></li><li>[60] IIS Local Admin <code>AC</code></li><li>[60] What&rsquo;s VPN built on? <code>AC</code></li><li>[120] AD-Domain user inventory <code>AC</code></li><li>[120] Find Domain Admin <code>AC</code></li><li>[180] Former employee&rsquo;s unknown SSH Key <code>AC</code></li><li>[180] T1550.002 Pass the Hash</li><li>[180] IIS Module Backdoor</li><li>[180] Windows backdoor service</li><li>[240] .NET Machine Key</li><li>[240] IIS Webshell</li><li>[240] Find the C2 Domain used by attacker</li><li>[240] AD CS find backdoor certificate</li><li>[300] check_load backdoor</li><li>[300] C2 in blogspot</li><li>[300] NGINX backdoor</li></ul><p>Scoreboard ; w ;
<img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635832309/blog-posts/2021-11/01-ctfd-scoreboard.webp alt=" "></p><br><p>Anyway, we got completely wrecked, all services down by the end QwQ
Let me review what happened while reflecting : )</p><h4 id=1-equipment-inventory class=headerLink><a href=#1-equipment-inventory class=header-mark></a>1. Equipment Inventory</h4><p>The team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, <strong>we should have checked infra and service environment first</strong>, then confirmed with IT department before 11:00, because after that&mldr; XD</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831490/blog-posts/2021-11/01-it-byebye.webp alt=" "></p><p>The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn&rsquo;t touch those six machines (maybe only manage infra). But later seeing other teams&rsquo; services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831930/blog-posts/2021-11/01-vsphere.webp alt=" ">
<img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831927/blog-posts/2021-11/01-esxi.webp alt=" "></p><h4 id=2-basic-checksvulnerability-detectionscanning class=headerLink><a href=#2-basic-checksvulnerability-detectionscanning class=header-mark></a>2. Basic Checks/Vulnerability Detection/Scanning</h4><ul><li>System files like <code>.bashrc</code>, <code>.history</code>, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system&rsquo;s iptable was fake w</li><li>Directories that shouldn&rsquo;t exist - this incident apparently had backdoors in <code>/test/</code>.
(Actually I&rsquo;m not sure which system files are must-checks - there are too many QQ)</li><li>Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn&rsquo;t verify, the service stayed Down. <strong>The correct approach is to disable first, or use security tools to set protective policies</strong>.</li></ul><h4 id=3-backup-before-updates class=headerLink><a href=#3-backup-before-updates class=header-mark></a>3. Backup Before Updates</h4><p>While many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are &ldquo;valid.&rdquo; Backups also have different formats due to space constraints - check <a href=https://en.wikipedia.org/wiki/Backup target=_blank rel="noopener noreferrer">Wikipedia</a>.</p><p>Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patterns targeting specific files. Also, if hackers want destruction, besides deleting and encrypting, they might leave corrupted backups, making you think you have clean backups.</p><h4 id=4-account-management class=headerLink><a href=#4-account-management class=header-mark></a>4. Account Management</h4><p>Several challenges used former employees as scenarios - expect hackers to enter through former employee accounts, or the former employee IS the hacker. Besides removing accounts, we were diligent about password changes, but post-competition discussion mentioned cases where hackers were already in the system before passwords were changed, sigh. Also check certificate expiration - @stavhaygn found a former employee&rsquo;s SSH public key. Good thing we backed it up since CTFd actually had a question about it XD. I only now noticed each home directory has its own <code>.ssh/.authorized_key</code> - comprehensive checking probably needs a script.</p><h4 id=5-windows-ad class=headerLink><a href=#5-windows-ad class=header-mark></a>5. Windows AD</h4><p>Main focus, common enterprise network architecture, and where red team did most intrusions.
Most services to defend were under AD, but I&rsquo;m really unfamiliar with AD - only knew to check permissions and GPO settings from online resources. A teammate was trying to set firewall rules to block SMB, but hackers had scripts that auto-disabled firewalls, so nothing got enabled ==
(Still digesting materials on other details QQ will update with thoughts)</p><p>One red team attack was making services countdown to shutdown - DC going down meant AD was dead. Originally we complained shutdown was too harsh, not knowing we could boot from vSphere and ESXi. Other teams even ran infinite loop scripts with <code>shutdown -a</code> to cancel shutdown ww. Red team apparently went easy on us - heard enterprise track had database deletion, way scarier. Student track was relatively friendly (?).</p><p>After AD&rsquo;s first shutdown, we discussed for a long time before calling the red team hotline, trying to get any useful info - got nothing, just told us the screen was laggy which we already knew from being hacked QQ. Finally spent 1000 points to rollback AD, figuring even if the same tactics shut us down again, at least we should boot up and poke around.</p><p>Interestingly, there was a PC simulating office computer, also under AD. Heard many red teams infiltrated through the PC, even installing Anydesk, Steam, MapleStory, Genshin Impact etc. lol. Neighboring team&rsquo;s was used for Rick Roll. Post-competition, red team said through the PC they could even enter team infra and modify firewall settings - terrifying.</p><p>Post-competition chats with other blue teams revealed most learned AD and PA from internships - students rarely encounter them otherwise (sweat).</p><h4 id=6-proper-tool-usage class=headerLink><a href=#6-proper-tool-usage class=header-mark></a>6. Proper Tool Usage</h4><p>I used to think antivirus was just like Windows Defender&rsquo;s one-click toggle, firewall just blacklist/whitelist. Training was eye-opening www. Really had interfaces but still couldn&rsquo;t operate them. I touched PA mid-competition, originally trying to understand each preset rule. Later remembered training&rsquo;s first step was going to Network to &ldquo;Bring up&rdquo; interfaces, then&mldr; it went down (around 12:50). @stavhaygn noticed something wrong and I turned it off. Don&rsquo;t use unfamiliar software carelessly Orz. Post-competition learned infra had planted uncommited bombs - many teams triggered them XDDDD. The opposing team even made memes, hilarious.</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635843212/blog-posts/2021-11/01-pa-memes.webp alt=" "></p><p>Post-competition discussions mostly centered on PA - since AD was exposed to external network from the start, without bringing AD under PA, we were sitting ducks.</p><p>Other tools are hard to categorize as filling holes - we don&rsquo;t touch them normally. Besides being paid professional tools, I don&rsquo;t have online side projects large enough to need security tool protection. Just listing them for future reference : 3</p><ul><li>Palo Alto Network (PA-3220)</li><li>Cortex XDR</li><li>Citrix MPX-5900</li><li>vSphere</li><li>ESXi</li><li>PowerEdge R630</li><li>Juniper EX2300</li></ul><h4 id=7-proper-log-usage class=headerLink><a href=#7-proper-log-usage class=header-mark></a>7. Proper Log Usage</h4><p>Logs seem experience-dependent. Quickly filtering with keywords saves lots of time. Windows built-in Event Viewer is hard to use (post-competition heard code::blocks recommended). Teammates looking at logs got headaches from program execution speed - maybe hackers were generating event logs inside XD. Also some Windows services don&rsquo;t log by default, like <a href=https://docs.microsoft.com/zh-tw/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing target=_blank rel="noopener noreferrer">Event ID 4688</a> requiring manual enablement. Best to decide how to use logs based on purpose - blind searching wastes time&mldr;</p><p><br><br></p><p>Below is the ideal system architecture with proper PA deployment, discussed with red team help for clarifying details>&lt;</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1636186756/blog-posts/2021-11/01-system-arch.webp alt=" "></p><p>That&rsquo;s about it. Hard to produce useful notes when unfamiliar with all tools. Please point out any errors above. Attaching final results - we really lay flat by the end QQ</p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831491/blog-posts/2021-11/01-service-scoreboard.webp alt=" "></p><p><img class=tw-inline loading=lazy src=https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1635831490/blog-posts/2021-11/01-service-board-final.webp alt=" "></p><br><div class="details admonition quote open"><div class="details-summary admonition-title"><span class=icon><svg class="icon" viewBox="0 0 512 512"><path d="M464 32H336c-26.5.0-48 21.5-48 48v128c0 26.5 21.5 48 48 48h80v64c0 35.3-28.7 64-64 64h-8c-13.3.0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h8c88.4.0 160-71.6 160-160V80c0-26.5-21.5-48-48-48zm-288 0H48C21.5 32 0 53.5.0 80v128c0 26.5 21.5 48 48 48h80v64c0 35.3-28.7 64-64 64h-8c-13.3.0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h8c88.4.0 160-71.6 160-160V80c0-26.5-21.5-48-48-48z"/></svg></span>Cyris - Still clueless blue team victim post-competition<span class=details-icon><svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span></div><div class=details-content><div class=admonition-content>During post-competition discussion, nobody knew where attacks came from, but the difference between us and others&mldr; <code>we didn't know how to turn on machines</code>&mldr;</div></div></div><br><h2 id=final-thoughts class=headerLink><a href=#final-thoughts class=header-mark></a>Final Thoughts</h2><p>From an enterprise perspective, it&rsquo;s better to briefly go offline for patching than risk patching while operational. But actually we&mldr; went offline and never came back online QwQ. Originally dispersing after awards, but I didn&rsquo;t want to leave confused after such a beating, so I grabbed some red team members for help. The entire red team came to answer questions - some were experts I follow on FB. Really grateful everyone stayed to guide us and share fun stories www</p><p>Finally, thanks to teammates for coming north to be cannon fodder (<del>masochist confirmed</del>), and thanks to AIS3 organizers for the excellent environment and abundant snacks, though I had no appetite that day QQ. Only brought a drink back to Kaohsiung. Though we placed last among six teams, at least we felt the beating thoroughly (?</p><p>My school has the student-run <code>CDPA (Campus Dormitory Promotion Association)</code> and security courses like &ldquo;Network Security&rdquo; and &ldquo;Hacking Attack & Defense,&rdquo; but CDPA was returned to the school due to manpower shortage, and the courses aren&rsquo;t taught by departmental professors, so difficulty isn&rsquo;t very high. Recently seeing the three northern schools (NTU, NTUST, NCTU) jointly offering Program Security - friends describe extremely difficult assignments, plus the traditional EOF CTF final exam I could barely solve any problems two years ago&mldr; North-south resource gap in security is real. But I&rsquo;d rather not just talk about wanting to get stronger - this blue team competition really motivated me. Though I want to immediately write some side project, time is insufficient QQ</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-11-01</span></div><div class=post-info-license></div></div><div class="post-info-line print:!tw-hidden"><div class=post-info-md></div><div class=post-info-share></div></div></div><div class=post-info-more><section class=post-tags><svg class="icon" viewBox="0 0 640 512"><path d="M497.941 225.941 286.059 14.059A48 48 0 00252.118.0H48C21.49.0.0 21.49.0 48v204.118a48 48 0 0014.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882.0l204.118-204.118c18.745-18.745 18.745-49.137.0-67.882zM112 160c-26.51.0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882.0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397.0h48.721a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882z"/></svg>&nbsp;<a href=/en/tags/hitcon-defense/>HITCON Defense</a>,&nbsp;<a href=/en/tags/ais3/>AIS3</a></section><section class=print:!tw-hidden><span><button class="tw-text-fgColor-link-muted hover:tw-text-fgColor-link-muted-hover" onclick=window.history.back()>Back</button></span>&nbsp;|&nbsp;<span><a href=/en/>Home</a></span></section></div><div class="post-nav print:tw-hidden"><a href=/en/posts/2021/my-first-malware-study/ class=prev rel=prev title="[Malware Analysis] A Wild Malware Appeared!"><svg class="icon" viewBox="0 0 256 512"><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9.0l22.6 22.6c9.4 9.4 9.4 24.6.0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6.0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9.0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>[Malware Analysis] A Wild Malware Appeared!</a>
<a href=/en/posts/2021/hitcon2021-devcore-web-challenge/ class=next rel=next title="[DEVCORE @HITCON2021] Wargame Web Challenge">[DEVCORE @HITCON2021] Wargame Web Challenge<svg class="icon" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9.0l-22.6-22.6c-9.4-9.4-9.4-24.6.0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6.0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9.0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></a></div></div><div id=comments class="print:!tw-hidden tw-pt-32 tw-pb-8"><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.150.0">Hugo</a>&nbsp;|&nbsp;Theme - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreferrer" title="DoIt 0.4.2"><svg class="icon" viewBox="0 0 576 512"><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1.0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7.0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174 402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7-43.2-43.2c-4.1-4.1-10.8-4.1-14.8.0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg> DoIt</a></div><div class=footer-line><svg class="icon" viewBox="0 0 512 512"><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532.0-2e2-89.451-2e2-2e2.0-110.531 89.451-2e2 2e2-2e2 110.532.0 2e2 89.451 2e2 2e2.0 110.532-89.451 2e2-2e2 2e2zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43.0-140.484-61.425-140.484-141.567.0-79.152 60.275-139.401 139.762-139.401 55.531.0 88.738 26.62 97.593 34.779a11.965 11.965.0 011.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303.0-77.916 35.33-77.916 80.082.0 41.589 26.888 83.692 78.277 83.692 32.657.0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947.0 01-1.152 15.518z"/></svg>2019 - 2026<span class=author>&nbsp;<a href=https://blog.cyris.tw target=_blank rel="noopener noreferrer">Cyris Tseng</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer><div class="print:!tw-hidden tw-flex tw-flex-col tw-fixed tw-right-4 tw-bottom-4 tw-gap-2"><a href=#back-to-top id=back-to-top-button class="tw-transition-opacity tw-opacity-0 tw-block tw-bg-bgColor-secondary tw-rounded-full" style=padding:.6rem;line-height:1.3rem;font-size:1rem title="Back to Top"><svg class="icon" viewBox="0 0 448 512"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>
</a><button id=toc-drawer-button class="tw-block tw-bg-bgColor-secondary tw-rounded-full md:tw-hidden" style=padding:.6rem;line-height:1.3rem;font-size:1rem>
<svg class="icon" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
</button><a href=#comments id=view-comments class="tw-block tw-bg-bgColor-secondary tw-rounded-full" style=padding:.6rem;line-height:1.3rem;font-size:1rem title="View Comments">
<svg class="icon" viewBox="0 0 512 512"><path d="M256 32C114.6 32 0 125.1.0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3.0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4.0 256-93.1 256-208S397.4 32 256 32z"/></svg></a></div><script>window.config={comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"Comment ðŸ’¬",lightTheme:"github-light",repo:"yctseng1227/blog-comments"}}}</script><script src=/js/theme.min.js defer></script><script src=/js/utterances.min.js defer></script><script type=speculationrules>
  {
    "prerender": [
      {
        "where": { "href_matches": "/*" },
        "eagerness": "moderate"
      }
    ]
  }
</script></body></html>