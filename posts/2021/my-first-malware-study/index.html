<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>[Malware Analysis] 出現了！是野生的貓味 - Cyris&#39;s Blog</title><meta name="Description" content="This is Cyris&#39;s blog, recording life and sharing security learning."><meta property="og:url" content="https://blog.cyris.tw/posts/2021/my-first-malware-study/">
  <meta property="og:site_name" content="Cyris&#39;s Blog">
  <meta property="og:title" content="[Malware Analysis] 出現了！是野生的貓味">
  <meta property="og:description" content="第一次撿到野生的 Malware。
">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-07-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-07-21T00:00:00+00:00">
    <meta property="article:tag" content="Malware Analysis">
    <meta property="article:tag" content="Worm">
    <meta property="og:image" content="https://blog.cyris.tw/img/cyris.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.cyris.tw/img/cyris.png"><meta name="twitter:title" content="[Malware Analysis] 出現了！是野生的貓味">
<meta name="twitter:description" content="第一次撿到野生的 Malware。">
      <meta name="twitter:site" content="@yctseng1227">
<meta name="application-name" content="Cyris&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Cyris&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/img/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://blog.cyris.tw/posts/2021/my-first-malware-study/" /><link rel="prev" href="https://blog.cyris.tw/posts/2021/cicd-jenkins-with-github-note/" /><link rel="next" href="https://blog.cyris.tw/posts/2021/hitcon-education-defense-2021/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "[Malware Analysis] 出現了！是野生的貓味",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.cyris.tw\/posts\/2021\/my-first-malware-study\/"
        },"image": ["https:\/\/blog.cyris.tw\/img\/cyris.png"],"genre": "posts","keywords": "Malware Analysis, Worm","wordcount":  4618 ,
        "url": "https:\/\/blog.cyris.tw\/posts\/2021\/my-first-malware-study\/","datePublished": "2021-07-21T00:00:00+00:00","dateModified": "2021-07-21T00:00:00+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Cyris","logo": "https:\/\/blog.cyris.tw\/img\/cyris.png"},"author": {
                "@type": "Person",
                "name": "Cyris"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="auto" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Cyris&#39;s Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/favicon.ico"
        data-srcset="/img/favicon.ico, /img/favicon.ico 1.5x, /img/favicon.ico 2x"
        data-sizes="auto"
        alt="/img/favicon.ico"
        title="/img/favicon.ico" />Cyris&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><a href="#" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Cyris&#39;s Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/favicon.ico"
        data-srcset="/img/favicon.ico, /img/favicon.ico 1.5x, /img/favicon.ico 2x"
        data-sizes="auto"
        alt="/img/favicon.ico"
        title="/img/favicon.ico" />Cyris&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a href="#" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">[Malware Analysis] 出現了！是野生的貓味</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.cyris.tw" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Cyris</a></span>&nbsp;<span class="post-category">included in <a href="/categories/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8-cyber-security/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>資訊安全 Cyber Security</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2021-07-21">2021-07-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;4618 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;22 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#story-time">Story Time</a></li>
    <li><a href="#simple-analysis">Simple Analysis</a>
      <ul>
        <li><a href="#pestudio">PeStudio</a></li>
        <li><a href="#ida-pro">IDA Pro</a></li>
        <li><a href="#regshot">Regshot</a></li>
        <li><a href="#process-hacker">Process Hacker</a></li>
        <li><a href="#wireshark">Wireshark</a></li>
      </ul>
    </li>
    <li><a href="#in-the-end">In the End</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>第一次撿到野生的 Malware。</p>
<p>先講結論！由於時間有限以及本人的技術不到位，最後並沒有很理想的結果。<br>
希望之後在 Malware Analysis 這塊技能樹點起來再回來分析會有所成長 QQ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/c_scale,f_auto,q_auto,w_600/v1626878294/blog-posts/2021-07/21-cover.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/c_scale%2cf_auto%2cq_auto%2cw_600/v1626878294/blog-posts/2021-07/21-cover.webp, https://res.cloudinary.com/eevee-blog/image/upload/c_scale%2cf_auto%2cq_auto%2cw_600/v1626878294/blog-posts/2021-07/21-cover.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/c_scale%2cf_auto%2cq_auto%2cw_600/v1626878294/blog-posts/2021-07/21-cover.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/c_scale,f_auto,q_auto,w_600/v1626878294/blog-posts/2021-07/21-cover.webp"
        title=" " /></p>
<br>
<h2 id="story-time">Story Time</h2>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>前回提要<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">我校為了提升校園網路環境安全，在今年初針對外對內的 RDP、FTP、SSH、MS-SQL、TELNET 藉由 IPS 通通擋掉。而我們 Lab 主要運作的伺服器由於有連線的需求而向學校申請 IP 連線許可，在疫情被迫 Work From Home 的非常時期顯得相當重要。</div>
        </div>
    </div>
<p>而最近，我們 Lab 收到了校方的資安通報，而目標 IP 正是主要運作的伺服器，據說是中了蠕蟲。</p>
<p>雖然我認為做為資安相關研究應該要收個資安通報解解成就，但是這次實在是莫名的讓人措手不及，這幾天分別由 @stavhaygn 和 @hanhan3927 學長兩位網管(?)負責調查，從假日看到他們螢幕上滿滿的 log，真的很辛苦呢。</p>
<p>而在今天 @stavhaygn 在群組丟了兩隻 Malware 問我有沒有興趣分析，起初我只是抱著難得有機會加減摸一下（<del>順便把生灰塵的 Parallel Desktop 拿出來清</del>），結果拿去餵 <a href="https://www.virustotal.com/gui/" target="_blank" rel="noopener noreffer ">VirtualTotal</a> 發現是一種蠕蟲，很自然地就想到前陣子的資安通報。</p>
<p>很明顯事情並沒有照著劇本走，因為 Lab 主要運作的伺服器是 Linux，而撿到兩隻的 Malware 都是 <code>.exe</code> 完全不能執行（用<a href="https://en.wikipedia.org/wiki/Wine_%28software%29" target="_blank" rel="noopener noreffer ">紅酒</a>除外），第一時間還很不識相的在群組出聲，哭啊被嘲諷 QwQ</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626805012/blog-posts/2021-07/21-fbmessenger.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626805012/blog-posts/2021-07/21-fbmessenger.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626805012/blog-posts/2021-07/21-fbmessenger.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626805012/blog-posts/2021-07/21-fbmessenger.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626805012/blog-posts/2021-07/21-fbmessenger.webp"
        title=" " /></p>
<p>故事大概就這樣，<br>
下面會分享第一次分析 Malware 我做了哪些事，以及用到哪些工具（即便我都不熟==）。</p>
<br>
<h2 id="simple-analysis">Simple Analysis</h2>
<h3 id="pestudio">PeStudio</h3>
<p>附上兩隻 Malware 在 VirusTotal 的結果，這裡使用 <a href="https://www.winitor.com/" target="_blank" rel="noopener noreffer ">PeStudio</a> 做為分析 <code>.exe</code> 的起手式，可以看到兩者皆為 32-bits 以及右圖 Malware 有加殼(UPX) 等等檔案資訊。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626804804/blog-posts/2021-07/21-malwareA-pestudio.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626804804/blog-posts/2021-07/21-malwareA-pestudio.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626804804/blog-posts/2021-07/21-malwareA-pestudio.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626804804/blog-posts/2021-07/21-malwareA-pestudio.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626804804/blog-posts/2021-07/21-malwareA-pestudio.webp"
        title=" " /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626804775/blog-posts/2021-07/21-malwareB-pestudio.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626804775/blog-posts/2021-07/21-malwareB-pestudio.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626804775/blog-posts/2021-07/21-malwareB-pestudio.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626804775/blog-posts/2021-07/21-malwareB-pestudio.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626804775/blog-posts/2021-07/21-malwareB-pestudio.webp"
        title=" " /></p>
<p>從之後的研究可知兩者為前後關係，分別是由左圖的 malware-A 執行後產生副產物 malware-B。
VirusTotal 的結果分別為 malware-A (60/69)、malware-B (62/68)，而 malware-A 被大部分防毒軟體判讀出來的 Ramnit 是當前臺灣企業受駭最多的一種惡意攻擊手法（<a href="https://www.ithome.com.tw/news/104775" target="_blank" rel="noopener noreffer ">iThome 新聞</a>），網路上也不難找到相關的<a href="https://portal.cert.tanet.edu.tw/docs/pdf/2016111610113333307937208216268.pdf" target="_blank" rel="noopener noreffer ">分析報告</a>，接下來我想了解的就是這組 Malware 到底做了什麼。</p>
<h3 id="ida-pro">IDA Pro</h3>
<p>第一步，當然就是拿出逆向工程萬用寶具 <a href="https://hex-rays.com/ida-pro/" target="_blank" rel="noopener noreffer ">IDA Pro</a> 使用 F5 大法！</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626838944/blog-posts/2021-07/21-idapro-1.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626838944/blog-posts/2021-07/21-idapro-1.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626838944/blog-posts/2021-07/21-idapro-1.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626838944/blog-posts/2021-07/21-idapro-1.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626838944/blog-posts/2021-07/21-idapro-1.webp"
        title=" " />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626838944/blog-posts/2021-07/21-idapro-2.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626838944/blog-posts/2021-07/21-idapro-2.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626838944/blog-posts/2021-07/21-idapro-2.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626838944/blog-posts/2021-07/21-idapro-2.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626838944/blog-posts/2021-07/21-idapro-2.webp"
        title=" " /></p>
<p>大概追了一小段時間&hellip; 嗯 看不懂呢QQ<br>
該說組語的底子不夠嗎，雖然說很多 know-how / domain knowledge 需要 google （<del>但我覺得就是自己沒耐心</del>），本來還想用 <a href="https://x64dbg.com/" target="_blank" rel="noopener noreffer ">x64dbg</a> 下中斷點追一下細節，不過看起來是沒戲嗚嗚。</p>
<br>
<p>老實說，第一次這麼沒頭沒尾的就拿了檔案要分析，還真的不知道該做什麼w<br>
CTF 好歹都有給情境或是至少不會毫無方向，所以就上網找了一下這類 Malware 分析的操作。</p>
<h3 id="regshot">Regshot</h3>
<p>首先是 <a href="https://github.com/Seabreg/Regshot" target="_blank" rel="noopener noreffer ">Regshot</a>，考慮到惡意程式通常會修改 registry，因此找到這個可以 snapshot 並且進行比較的開源程式。原本我的 sandbox 環境是在 Windows10 進行實驗，但是當我把比較的結果分享給 @stavhaygn 時，被提議使用 Windows7，一測下去 registry 的修改數量增加許多，原來目標主機的環境是 Windows7 早說嘛（<del>雖然我自己也擅自預設環境為Win10</del>）。</p>
<p>要說有什麼發現嗎？
很多註冊表的關鍵字要大概都一知半解，但可以注意到新增大量 <code>ShellBags</code> 的 key 和 value 企圖將 Malware 自己藏起來，話說連 <code>{5C4F28B5-F869-4E84-8E60-F11DB97C5CC7}</code> 這串 ID 都有東西可以查 XD，還有 <code>FirewallPolicy</code> 看起來都有被動到，最後 <code>MuiCache</code> 可以自定義 <code>.exe</code> 名稱顯示，這裡 Malware 看起來是偽裝成 Internet Explorer。</p>
<div class="highlight" filename="~res_x64.txt"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Regshot 1.9.0 x64 Unicode
</span></span><span class="line"><span class="cl">Comments: 
</span></span><span class="line"><span class="cl">Datetime: -
</span></span><span class="line"><span class="cl">Computer: -
</span></span><span class="line"><span class="cl">Username: -
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">----------------------------------
</span></span><span class="line"><span class="cl">Keys added: 4
</span></span><span class="line"><span class="cl">----------------------------------
</span></span><span class="line"><span class="cl">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant\Monitored
</span></span><span class="line"><span class="cl">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant\Quarantined
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Cheat Engine
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Cheat Engine\Window Positions 96
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">----------------------------------
</span></span><span class="line"><span class="cl">Values added: 14
</span></span><span class="line"><span class="cl">----------------------------------
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\ControlSet001\services\SharedAccess\Parameters\FirewallPolicy\FirewallRules\TCP Query User{B722FD22-77FB-4A93-B73C-35A5003B8208}C:\program files (x86)\internet explorer\iexplore.exe: &#34;v2.10|Action=Allow|Active=TRUE|Dir=In|Protocol=6|Profile=Public|App=C:\program files (x86)\internet explorer\iexplore.exe|Name=Internet Explorer|Desc=Internet Explorer|Defer=User|&#34;
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\ControlSet001\services\SharedAccess\Parameters\FirewallPolicy\FirewallRules\UDP Query User{90FF74F6-3F69-4CB0-A8C9-B3478A25FFF5}C:\program files (x86)\internet explorer\iexplore.exe: &#34;v2.10|Action=Allow|Active=TRUE|Dir=In|Protocol=17|Profile=Public|App=C:\program files (x86)\internet explorer\iexplore.exe|Name=Internet Explorer|Desc=Internet Explorer|Defer=User|&#34;
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\FirewallRules\TCP Query User{B722FD22-77FB-4A93-B73C-35A5003B8208}C:\program files (x86)\internet explorer\iexplore.exe: &#34;v2.10|Action=Allow|Active=TRUE|Dir=In|Protocol=6|Profile=Public|App=C:\program files (x86)\internet explorer\iexplore.exe|Name=Internet Explorer|Desc=Internet Explorer|Defer=User|&#34;
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\FirewallRules\UDP Query User{90FF74F6-3F69-4CB0-A8C9-B3478A25FFF5}C:\program files (x86)\internet explorer\iexplore.exe: &#34;v2.10|Action=Allow|Active=TRUE|Dir=In|Protocol=17|Profile=Public|App=C:\program files (x86)\internet explorer\iexplore.exe|Name=Internet Explorer|Desc=Internet Explorer|Defer=User|&#34;
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\StartPage\StartMenu_Balloon_Time:  C0 E1 E5 57 14 7E D7 01
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\P:\Hfref\lpgfrat\Qbjaybnqf\0720 znyjner\znyjner\123.RKR:  00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF 10 BD 00 D6 13 7E D7 01 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\P:\Hfref\lpgfrat\NccQngn\Ybpny\Grzc\prgenvaref\PRG7P55.gzc\rkgenpgrq\123.RKR:  00 00 00 00 00 00 00 00 03 00 00 00 2A F2 00 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\{1NP14R77-02R7-4R5Q-O744-2RO1NR5198O7}\abgrcnq.rkr:  00 00 00 00 00 00 00 00 03 00 00 00 79 7D 01 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Classes\Local Settings\MuiCache\2\52C64B7E\@%SystemRoot%\System32\FirewallControlPanel.dll,-1: &#34;Windows Firewall&#34;
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\MuiCache\C:\program files (x86)\internet explorer\iexplore.exe: &#34;Internet Explorer&#34;
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Cheat Engine\Window Positions 96\AdvancedOptions Position:  C0 00 00 00 00 01 00 00 3B 02 00 00 2F 01 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Cheat Engine\Window Positions 96\frmAutoInject Position:  AE 01 00 00 E5 02 00 00 AF 01 00 00 4B 01 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000_Classes\Local Settings\MuiCache\2\52C64B7E\@%SystemRoot%\System32\FirewallControlPanel.dll,-1: &#34;Windows Firewall&#34;
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000_Classes\Local Settings\Software\Microsoft\Windows\Shell\MuiCache\C:\program files (x86)\internet explorer\iexplore.exe: &#34;Internet Explorer&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">----------------------------------
</span></span><span class="line"><span class="cl">Values modified: 12
</span></span><span class="line"><span class="cl">----------------------------------
</span></span><span class="line"><span class="cl">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\S-1-5-21-2683313141-1501627848-3399458464-1000\RefCount: 0x00000004
</span></span><span class="line"><span class="cl">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\S-1-5-21-2683313141-1501627848-3399458464-1000\RefCount: 0x00000005
</span></span><span class="line"><span class="cl">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\ProfileList\S-1-5-21-2683313141-1501627848-3399458464-1000\RefCount: 0x00000004
</span></span><span class="line"><span class="cl">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\ProfileList\S-1-5-21-2683313141-1501627848-3399458464-1000\RefCount: 0x00000005
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\ControlSet001\Control\Nsi\{eb004a03-9b1a-11d4-9123-0050047759bc}\24\ffffffffffffffffffffffffffffff01:  00 00 00 00 F2 00 00 00 02 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\ControlSet001\Control\Nsi\{eb004a03-9b1a-11d4-9123-0050047759bc}\24\ffffffffffffffffffffffffffffff01:  00 00 00 00 F4 00 00 00 02 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\ControlSet001\services\SharedAccess\Epoch\Epoch: 0x00000090
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\ControlSet001\services\SharedAccess\Epoch\Epoch: 0x00000098
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\CurrentControlSet\Control\Nsi\{eb004a03-9b1a-11d4-9123-0050047759bc}\24\ffffffffffffffffffffffffffffff01:  00 00 00 00 F2 00 00 00 02 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\CurrentControlSet\Control\Nsi\{eb004a03-9b1a-11d4-9123-0050047759bc}\24\ffffffffffffffffffffffffffffff01:  00 00 00 00 F4 00 00 00 02 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\CurrentControlSet\services\SharedAccess\Epoch\Epoch: 0x00000090
</span></span><span class="line"><span class="cl">HKLM\SYSTEM\CurrentControlSet\services\SharedAccess\Epoch\Epoch: 0x00000098
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\HRZR_PGYFRFFVBA:  00 00 00 00 64 00 00 00 8B 00 00 00 10 BF DA 00 0E 00 00 00 15 00 00 00 A0 68 06 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 2E 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 2E 00 47 00 65 00 74 00 74 00 69 00 6E 00 67 00 53 00 74 00 61 00 72 00 74 00 65 00 64 00 00 00 00 00 01 00 00 00 00 00 00 00 F4 78 CE FE FE 07 00 00 90 00 00 00 00 00 00 00 54 D1 46 03 00 00 00 00 01 00 00 00 00 00 00 00 52 31 CE FE FE 07 00 00 02 00 00 00 00 00 00 00 A0 D1 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 DC 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 D2 46 03 00 00 00 00 DC 03 00 00 00 00 00 00 C4 D2 46 03 00 00 00 00 00 00 00 00 00 00 00 00 98 BA BA FD FE 07 00 00 00 00 00 00 00 00 00 00 E0 A1 BA FD FE 07 00 00 00 00 00 00 00 00 00 00 80 D1 46 03 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl"> 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 05 39 00 00 00 00 00 7C 21 59 74 00 00 00 00 00 64 45 02 00 00 00 00 D0 CE 3A 00 00 00 00 00 00 00 00 00 00 00 00 00 F0 D3 46 03 00 00 00 00 50 E6 46 03 00 00 00 00 EC 3F 59 74 00 00 00 00 A0 79 33 00 00 00 00 00 30 D2 46 03 00 00 00 00 00 95 56 FD FE 07 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 98 77 A3 FE FE 07 00 00 00 00 00 00 00 00 00 00 74 D3 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 80 D3 46 03 00 00 00 00 80 D3 46 03 00 00 00 00 1D 47 10 77 00 00 00 00 2C 21 59 74 00 00 00 00 01 00 00 00 00 00 00 00 50 94 56 FD FE 07 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 0E 00 00 00 15 00 00 00 A0 68 06 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 2E 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 2E 00 47 00 65 00 74 00 74 00 69 00 6E 00 
</span></span><span class="line"><span class="cl">67 00 53 00 74 00 61 00 72 00 74 00 65 00 64 00 00 00 00 00 01 00 00 00 00 00 00 00 F4 78 CE FE FE 07 00 00 90 00 00 00 00 00 00 00 54 D1 46 03 00 00 00 00 01 00 00 00 00 00 00 00 52 31 CE FE FE 07 00 00 02 00 00 00 00 00 00 00 A0 D1 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 DC 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 D2 46 03 00 00 00 00 DC 03 00 00 00 00 00 00 C4 D2 46 03 00 00 00 00 00 00 00 00 00 00 00 00 98 BA BA FD FE 07 00 00 00 00 00 00 00 00 00 00 E0 A1 BA FD FE 07 00 00 00 00 00 00 00 00 00 00 80 D1 46 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 05 39 00 00 00 00 00 7C 21 59 74 00 00 00 00 00 64 45 02 00 00 00 00 D0 CE 3A 00 00 00 00 00 00 00 00 00 00 00 00 00 F0 D3 46 03 00 00 00 00 50 E6 46 03 00 00 00 00 EC 3F 59 74 00 00 00 00 A0 79 33 00 00 00 00 00 30 D2 46 03 00 00 00 00 00 95 56 FD FE 07 00 00 E4 D7 46 03 00 00 00 00 00 0
</span></span><span class="line"><span class="cl">0 00 00 00 00 00 00 98 77 A3 FE FE 07 00 00 00 00 00 00 00 00 00 00 74 D3 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 80 D3 46 03 00 00 00 00 80 D3 46 03 00 00 00 00 1D 47 10 77 00 00 00 00 2C 21 59 74 00 00 00 00 01 00 00 00 00 00 00 00 50 94 56 FD FE 07 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 01 00 00 00 04 00 00 00 02 31 A9 00 43 00 3A 00 5C 00 55 00 73 00 65 00 72 00 73 00 5C 00 79 00 63 00 74 00 73 00 65 00 6E 00 67 00 5C 00 44 00 6F 00 77 00 6E 00 6C 00 6F 00 61 00 64 00 73 00 5C 00 70 00 72 00 6F 00 63 00 65 00 73 00 73 00 68 00 61 00 63 00 6B 00 65 00 72 00 2D 00 32 00 2E 00 33 00 39 00 2D 00 62 00 69 00 6E 00 5C 00 78 00 36 00 34 00 5C 00 50 00 72 00 6F 00 63 00 65 00 73 00 73 00 48 00 61 00 63 00 6B 00 65 00 72 00 2E 00 65 00 78 00 65 00 00 00 61 F2 51 41 00 00 00 00 00 00 00 00 C4 60 44 FD FE 07 00 00 00 00 00 00 00 00 00 00 A8 B2 F2 04 00 00 00 00 0C 80 80
</span></span><span class="line"><span class="cl"> FD FE 07 00 00 A8 B2 F2 04 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 06 00 00 00 EC D4 0B 00 7B 00 46 00 33 00 38 00 42 00 46 00 34 00 30 00 34 00 2D 00 31 00 44 00 34 00 33 00 2D 00 34 00 32 00 46 00 32 00 2D 00 39 00 33 00 A2 68 E6 76 00 00 00 00 37 00 44 00 45 00 30 00 42 00 32 00 38 00 46 00 43 00 32 00 33 00 7D 00 5C 00 65 00 78 00 70 00 60 58 A1 02 00 00 00 00 F9 25 85 FB FE 07 00 00 FF FF FF FF FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 E0 D7 02 00 00 00 00 42 89 C6 FE FE 07 00 00 44 E5 D7 02 00 00 00 00 59 03 C3 FE FE 07 00 00 48 E3 D7 02 00 00 00 00 47 50 4F 53 00 00 00 00 03 00 00 00 00 00 00 00 F9 25 85 FB FE 07 00 00 82 00 01 00 00 00 00 00 B8 00 01 00 00 00 00 00 50 B4 18 09 00 00 00 00 D3 F4 E5 76 00 00 00 00 01 00 00 02 00 00 00 00 B8 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 80 7A 2C 00 00 00 00 00 D8 E0 D7 02 00 00 00 00 7C 7C 2C 00 00 00 00 00 40 41 2D 00 00 00 00 00 20 00 00 00 00 00 00 00 
</span></span><span class="line"><span class="cl">00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\HRZR_PGYFRFFVBA:  00 00 00 00 65 00 00 00 9B 00 00 00 19 CC DE 00 0E 00 00 00 15 00 00 00 A0 68 06 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 2E 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 2E 00 47 00 65 00 74 00 74 00 69 00 6E 00 67 00 53 00 74 00 61 00 72 00 74 00 65 00 64 00 00 00 00 00 01 00 00 00 00 00 00 00 F4 78 CE FE FE 07 00 00 90 00 00 00 00 00 00 00 54 D1 46 03 00 00 00 00 01 00 00 00 00 00 00 00 52 31 CE FE FE 07 00 00 02 00 00 00 00 00 00 00 A0 D1 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 DC 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 D2 46 03 00 00 00 00 DC 03 00 00 00 00 00 00 C4 D2 46 03 00 00 00 00 00 00 00 00 00 00 00 00 98 BA BA FD FE 07 00 00 00 00 00 00 00 00 00 00 E0 A1 BA FD FE 07 00 00 00 00 00 00 00 00 00 00 80 D1 46 03 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl"> 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 05 39 00 00 00 00 00 7C 21 59 74 00 00 00 00 00 64 45 02 00 00 00 00 D0 CE 3A 00 00 00 00 00 00 00 00 00 00 00 00 00 F0 D3 46 03 00 00 00 00 50 E6 46 03 00 00 00 00 EC 3F 59 74 00 00 00 00 A0 79 33 00 00 00 00 00 30 D2 46 03 00 00 00 00 00 95 56 FD FE 07 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 98 77 A3 FE FE 07 00 00 00 00 00 00 00 00 00 00 74 D3 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 80 D3 46 03 00 00 00 00 80 D3 46 03 00 00 00 00 1D 47 10 77 00 00 00 00 2C 21 59 74 00 00 00 00 01 00 00 00 00 00 00 00 50 94 56 FD FE 07 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 0E 00 00 00 15 00 00 00 A0 68 06 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 2E 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 2E 00 47 00 65 00 74 00 74 00 69 00 6E 00 
</span></span><span class="line"><span class="cl">67 00 53 00 74 00 61 00 72 00 74 00 65 00 64 00 00 00 00 00 01 00 00 00 00 00 00 00 F4 78 CE FE FE 07 00 00 90 00 00 00 00 00 00 00 54 D1 46 03 00 00 00 00 01 00 00 00 00 00 00 00 52 31 CE FE FE 07 00 00 02 00 00 00 00 00 00 00 A0 D1 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 DC 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 D2 46 03 00 00 00 00 DC 03 00 00 00 00 00 00 C4 D2 46 03 00 00 00 00 00 00 00 00 00 00 00 00 98 BA BA FD FE 07 00 00 00 00 00 00 00 00 00 00 E0 A1 BA FD FE 07 00 00 00 00 00 00 00 00 00 00 80 D1 46 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 05 39 00 00 00 00 00 7C 21 59 74 00 00 00 00 00 64 45 02 00 00 00 00 D0 CE 3A 00 00 00 00 00 00 00 00 00 00 00 00 00 F0 D3 46 03 00 00 00 00 50 E6 46 03 00 00 00 00 EC 3F 59 74 00 00 00 00 A0 79 33 00 00 00 00 00 30 D2 46 03 00 00 00 00 00 95 56 FD FE 07 00 00 E4 D7 46 03 00 00 00 00 00 0
</span></span><span class="line"><span class="cl">0 00 00 00 00 00 00 98 77 A3 FE FE 07 00 00 00 00 00 00 00 00 00 00 74 D3 46 03 00 00 00 00 E4 D7 46 03 00 00 00 00 00 00 00 00 00 00 00 00 80 D3 46 03 00 00 00 00 80 D3 46 03 00 00 00 00 1D 47 10 77 00 00 00 00 2C 21 59 74 00 00 00 00 01 00 00 00 00 00 00 00 50 94 56 FD FE 07 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 01 00 00 00 06 00 00 00 24 07 AA 00 43 00 3A 00 5C 00 55 00 73 00 65 00 72 00 73 00 5C 00 79 00 63 00 74 00 73 00 65 00 6E 00 67 00 5C 00 44 00 6F 00 77 00 6E 00 6C 00 6F 00 61 00 64 00 73 00 5C 00 70 00 72 00 6F 00 63 00 65 00 73 00 73 00 68 00 61 00 63 00 6B 00 65 00 72 00 2D 00 32 00 2E 00 33 00 39 00 2D 00 62 00 69 00 6E 00 5C 00 78 00 36 00 34 00 5C 00 50 00 72 00 6F 00 63 00 65 00 73 00 73 00 48 00 61 00 63 00 6B 00 65 00 72 00 2E 00 65 00 78 00 65 00 00 00 FE 07 00 00 00 00 00 00 00 00 00 00 80 7A 2C 00 00 00 00 00 50 BF 0F 04 00 00 00 00 A4 7C 2C 00 00 00 00 00 90 E8 2C
</span></span><span class="line"><span class="cl"> 00 00 00 00 00 00 00 00 00 00 00 00 00 A0 DB FB 03 00 00 00 00 00 00 00 00 00 00 00 00 00 01 09 08 00 00 00 00 00 00 00 00 00 00 00 00 10 54 18 77 00 00 00 00 00 00 00 00 00 00 00 00 E0 00 00 00 00 00 00 00 00 00 2C 00 00 00 00 00 00 44 FF 03 00 00 00 00 A2 68 E6 76 00 00 00 00 58 03 2C 00 00 00 00 00 B5 EE 16 4C 2E C8 16 0E 3D E8 F2 66 45 7D 00 00 26 08 43 FD FE 07 00 00 00 00 00 00 00 00 00 00 9E 02 00 00 FE 07 00 00 00 00 00 00 FF FF FF FF 00 00 00 00 00 00 00 00 06 00 00 00 00 00 00 00 A8 38 D6 FF 00 00 00 00 20 E0 D7 02 00 00 00 00 42 89 C6 FE FE 07 00 00 44 E5 D7 02 00 00 00 00 59 03 C3 FE FE 07 00 00 48 E3 D7 02 00 00 00 00 47 50 4F 53 00 00 00 00 03 00 00 00 00 00 00 00 F9 25 85 FB FE 07 00 00 82 00 01 00 00 00 00 00 B8 00 01 00 00 00 00 00 01 00 00 02 00 00 00 00 20 00 00 00 00 00 00 00 01 00 00 02 00 00 00 00 B8 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 0E 76 E6 76 00 00 00 00 D8 E0 D7 02 00 00 00 00 7C 7C 2C 00 00 00 00 00 B8 00 01 00 00 00 00 00 20 00 00 00 00 00 00 00 
</span></span><span class="line"><span class="cl">00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\rkcybere.rkr:  00 00 00 00 01 00 00 00 0A 00 00 00 E8 36 0C 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF C0 D0 80 42 46 7D D7 01 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\{S38OS404-1Q43-42S2-9305-67QR0O28SP23}\rkcybere.rkr:  00 00 00 00 01 00 00 00 0F 00 00 00 77 76 0C 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF C0 D0 80 42 46 7D D7 01 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\P:\Hfref\lpgfrat\Qbjaybnqf\cebprffunpxre-2.39-ova\k64\CebprffUnpxre.rkr:  00 00 00 00 01 00 00 00 04 00 00 00 02 31 A9 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF 90 C6 6B 48 99 7D D7 01 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\P:\Hfref\lpgfrat\Qbjaybnqf\cebprffunpxre-2.39-ova\k64\CebprffUnpxre.rkr:  00 00 00 00 01 00 00 00 06 00 00 00 24 07 AA 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF 90 C6 6B 48 99 7D D7 01 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\P:\Hfref\lpgfrat\Qbjaybnqf\Ertfubg-1.9.0\Ertfubg-k64-Havpbqr.rkr:  00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF 00 3C 16 C0 13 7E D7 01 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count\P:\Hfref\lpgfrat\Qbjaybnqf\Ertfubg-1.9.0\Ertfubg-k64-Havpbqr.rkr:  00 00 00 00 01 00 00 00 03 00 00 00 B5 87 00 00 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF 00 00 80 BF FF FF FF FF 00 3C 16 C0 13 7E D7 01 00 00 00 00
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\BagMRU\2\0\MRUListEx:  03 00 00 00 00 00 00 00 02 00 00 00 01 00 00 00 FF FF FF FF
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\BagMRU\2\0\MRUListEx:  00 00 00 00 03 00 00 00 02 00 00 00 01 00 00 00 FF FF FF FF
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000_Classes\Local Settings\Software\Microsoft\Windows\Shell\BagMRU\2\0\MRUListEx:  03 00 00 00 00 00 00 00 02 00 00 00 01 00 00 00 FF FF FF FF
</span></span><span class="line"><span class="cl">HKU\S-1-5-21-2683313141-1501627848-3399458464-1000_Classes\Local Settings\Software\Microsoft\Windows\Shell\BagMRU\2\0\MRUListEx:  00 00 00 00 03 00 00 00 02 00 00 00 01 00 00 00 FF FF FF FF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">----------------------------------
</span></span><span class="line"><span class="cl">Total changes: 30
</span></span><span class="line"><span class="cl">----------------------------------
</span></span></code></pre></td></tr></table>
</div>
</div><p>雖然沒有實際測過，但修改的 registry 我猜也包含重開機自動 RUN 起來吧，剩下的真要認真查可能要不少時間，所以我只有找了幾個有興趣的關鍵字稍微摸過。</p>
<h3 id="process-hacker">Process Hacker</h3>
<p><a href="https://processhacker.sourceforge.io/" target="_blank" rel="noopener noreffer ">Process Hacker</a> 簡單講就是工作管理員的進階版(Ｏ)，平常沒碰 Windows 的我也是問了才知道有這軟體可以進一步觀察 process 在後台執行的狀況。</p>
<p>將 Malware RUN 起來，出現模仿相當完美的 IE，只是出現位置不對（笑）</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626858237/blog-posts/2021-07/21-processhacker-1.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626858237/blog-posts/2021-07/21-processhacker-1.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626858237/blog-posts/2021-07/21-processhacker-1.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626858237/blog-posts/2021-07/21-processhacker-1.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626858237/blog-posts/2021-07/21-processhacker-1.webp"
        title=" " /></p>
<p>原本在斷網的 Sandbox 等不到 Malware 發 request，所以只好手機開分享看看他會怎麼運作，抓到程式連到 Amazon EC2 的行為（經驗判斷應該是連 <a href="https://en.wikipedia.org/wiki/Command_and_control" target="_blank" rel="noopener noreffer ">C2 Server</a>，是常見的 Botnet 手法）。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626859156/blog-posts/2021-07/21-processhacker-2.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626859156/blog-posts/2021-07/21-processhacker-2.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626859156/blog-posts/2021-07/21-processhacker-2.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626859156/blog-posts/2021-07/21-processhacker-2.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626859156/blog-posts/2021-07/21-processhacker-2.webp"
        title=" " /></p>
<p>順便宣導一下     <strong>!!!不要走學校網路，除非想收資安通報!!!</strong></p>
<p>不過後續不清楚 Malware 怎麼運作，就只是反覆一直連線，看到 Network 那一坨 domain 又不清掉實在讓人略不爽（？）</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626859451/blog-posts/2021-07/21-processhacker-3.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626859451/blog-posts/2021-07/21-processhacker-3.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626859451/blog-posts/2021-07/21-processhacker-3.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626859451/blog-posts/2021-07/21-processhacker-3.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626859451/blog-posts/2021-07/21-processhacker-3.webp"
        title=" " /></p>
<p>最後，發現在 kill 掉 Malware 後過沒多久會自己重啟（怕.jpg）</p>
<h3 id="wireshark">Wireshark</h3>
<p><a href="https://www.wireshark.org" target="_blank" rel="noopener noreffer ">Wireshark</a> 是用來分析網路封包的工具。<br>
原本在斷網環境錄製封包一直沒有看到預期的 request，猜想 Malware 是否有判斷網路環境，所以我用手機開網路分享（但不對外開行動網路），發現在 DNS 開始會有 google.com、yahoo.com、bing.com 的詢問，但還有一個 supnewdmn[.]com 的 DNS 詢問，從 VirusTotal 的回報比例有 12/87，沒意外是惡意網域，之後會有一些看起來是 <a href="https://en.wikipedia.org/wiki/Domain_generation_algorithm" target="_blank" rel="noopener noreffer ">DGA</a> 產生的 random domain name應該就是用來連上 Amazon EC2，也就是方才提到的 C2 Server。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626874280/blog-posts/2021-07/21-wireshark-1.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874280/blog-posts/2021-07/21-wireshark-1.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874280/blog-posts/2021-07/21-wireshark-1.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874280/blog-posts/2021-07/21-wireshark-1.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626874280/blog-posts/2021-07/21-wireshark-1.webp"
        title=" " />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626874280/blog-posts/2021-07/21-wireshark-2.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874280/blog-posts/2021-07/21-wireshark-2.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874280/blog-posts/2021-07/21-wireshark-2.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874280/blog-posts/2021-07/21-wireshark-2.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626874280/blog-posts/2021-07/21-wireshark-2.webp"
        title=" " /></p>
<p>直接對外連網後，DNS 查詢的 domain 就會限縮到 google.com 和 supnewdmn[.]com，以及 random domain name。從 Process Hacker 得知的連線 Port 447 來看，由於封包都是走 TCP，所以從 Wireshark 看不到什麼內容 QQ</p>
<h2 id="in-the-end">In the End</h2>
<p>從分析 Malware 的時候不難看出該程式的原型是 cheat engine，只是被加料了 (下圖借用 CAPE Sandbox Screenshot)。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626874564/blog-posts/2021-07/21-malware-capesandbox.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874564/blog-posts/2021-07/21-malware-capesandbox.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874564/blog-posts/2021-07/21-malware-capesandbox.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626874564/blog-posts/2021-07/21-malware-capesandbox.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626874564/blog-posts/2021-07/21-malware-capesandbox.webp"
        title=" CAPE Sandbox" /></p>
<p>而故事的後續，原來是 @stavhaygn 友人透過 VPN 走校園網路，結果下載的私服外掛被埋了蠕蟲，因此校方 IPS 在分析惡意流量追溯 IP 才會追到我們 Lab 的伺服器，這件事告訴我們 <del>慎選朋友</del> 使用學校網路請不要壞壞。</p>
<p>最後，簡單畫個這次分析的示意圖吧，只是 Malware 到底從 C2 server 那邊拿了什麼做了什麼，就不知道了 QwQ 但我想下一步從 reverse 著手應該會有進一步地發現。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626883372/blog-posts/2021-07/21-malware-analysis-diagram.webp"
        data-srcset="https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626883372/blog-posts/2021-07/21-malware-analysis-diagram.webp, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626883372/blog-posts/2021-07/21-malware-analysis-diagram.webp 1.5x, https://res.cloudinary.com/eevee-blog/image/upload/f_auto%2cq_auto/v1626883372/blog-posts/2021-07/21-malware-analysis-diagram.webp 2x"
        data-sizes="auto"
        alt="https://res.cloudinary.com/eevee-blog/image/upload/f_auto,q_auto/v1626883372/blog-posts/2021-07/21-malware-analysis-diagram.webp"
        title=" " /></p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-07-21</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/malware-analysis/">Malware Analysis</a>,&nbsp;<a href="/tags/worm/">Worm</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2021/cicd-jenkins-with-github-note/" class="prev" rel="prev" title="[Sharing] Jenkins 🛠 Github 當服務生遇到章魚貓"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>[Sharing] Jenkins 🛠 Github 當服務生遇到章魚貓</a>
            <a href="/posts/2021/hitcon-education-defense-2021/" class="next" rel="next" title="[Sharing] HITCON Education Defense 2021">[Sharing] HITCON Education Defense 2021<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="utterances" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">utterances</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.125.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.cyris.tw" target="_blank">Cyris Tseng</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":20},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"Comment 💬","lightTheme":"github-light","repo":"yctseng1227/blog-comments"}}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
